<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>MJ Créations - Expert Rénovation Bretagne | 600+ Prestations</title>
    
    <!-- Stripe Script -->
    
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        :root {
            --primary: #2563eb;
            --primary-dark: #1e40af;
            --primary-light: #3b82f6;
            --secondary: #f97316;
            --accent: #10b981;
            --danger: #ef4444;
            --warning: #f59e0b;
            --dark: #111827;
            --gray: #6b7280;
            --gray-light: #f3f4f6;
            --white: #ffffff;
            --shadow: 0 4px 6px -1px rgba(0,0,0,0.1);
            --shadow-lg: 0 10px 15px -3px rgba(0,0,0,0.1);
            --shadow-xl: 0 20px 25px -5px rgba(0,0,0,0.1);
            --radius: 8px;
            --radius-lg: 16px;
        }

        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', sans-serif;
            background: white;
            color: var(--dark);
            line-height: 1.6;
        }

        /* Header */
        .header {
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            z-index: 1000;
            background: rgba(255, 255, 255, 0.95);
            backdrop-filter: blur(10px);
            transition: all 0.3s ease;
        }

        .header.scrolled {
            box-shadow: var(--shadow-lg);
        }

        .nav-container {
            max-width: 1280px;
            margin: 0 auto;
            padding: 0 20px;
            display: flex;
            justify-content: space-between;
            align-items: center;
            height: 70px;
        }

        .logo {
            display: flex;
            align-items: center;
            gap: 10px;
            font-size: 1.5rem;
            font-weight: 700;
            color: var(--primary);
        }

        .nav-menu {
            display: flex;
            gap: 30px;
            align-items: center;
        }

        .nav-link {
            color: var(--dark);
            text-decoration: none;
            font-weight: 500;
            transition: color 0.3s;
            position: relative;
        }

        .nav-link:hover {
            color: var(--primary);
        }

        .nav-link::after {
            content: '';
            position: absolute;
            bottom: -5px;
            left: 0;
            width: 0;
            height: 2px;
            background: var(--primary);
            transition: width 0.3s;
        }

        .nav-link:hover::after {
            width: 100%;
        }

        .btn {
            padding: 12px 24px;
            border-radius: var(--radius);
            font-weight: 600;
            border: none;
            cursor: pointer;
            transition: all 0.3s;
            text-decoration: none;
            display: inline-flex;
            align-items: center;
            gap: 8px;
            font-size: 0.95rem;
        }

        .btn-primary {
            background: var(--primary);
            color: white;
            box-shadow: var(--shadow);
        }

        .btn-primary:hover {
            background: var(--primary-dark);
            transform: translateY(-2px);
            box-shadow: var(--shadow-lg);
        }

        .btn-secondary {
            background: var(--secondary);
            color: white;
        }

        .btn-success {
            background: var(--accent);
            color: white;
        }

        .btn-outline {
            background: transparent;
            color: var(--primary);
            border: 2px solid var(--primary);
        }

        .btn-outline:hover {
            background: var(--primary);
            color: white;
        }

        /* Hero Section */
        .hero {
            margin-top: 70px;
            height: 80vh;
            background: linear-gradient(135deg, rgba(37, 99, 235, 0.9), rgba(16, 185, 129, 0.8)), 
                        url('https://images.unsplash.com/photo-1504307651254-35680f356dfd?w=1920') center/cover;
            display: flex;
            align-items: center;
            justify-content: center;
            text-align: center;
            color: white;
            position: relative;
            overflow: hidden;
        }

        .hero::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: linear-gradient(45deg, transparent 30%, rgba(255,255,255,0.1) 50%, transparent 70%);
            animation: shine 3s infinite;
        }

        @keyframes shine {
            0% { transform: translateX(-100%); }
            100% { transform: translateX(100%); }
        }

        .hero-content {
            z-index: 2;
            max-width: 800px;
            padding: 0 20px;
        }

        .hero-content h1 {
            font-size: 3.5rem;
            margin-bottom: 20px;
            font-weight: 700;
            text-shadow: 2px 2px 4px rgba(0,0,0,0.3);
            animation: fadeInUp 1s ease-out;
        }

        .hero-content p {
            font-size: 1.3rem;
            margin-bottom: 30px;
            opacity: 0.95;
            animation: fadeInUp 1s ease-out 0.2s both;
        }

        .hero-actions {
            display: flex;
            gap: 20px;
            justify-content: center;
            flex-wrap: wrap;
            animation: fadeInUp 1s ease-out 0.4s both;
        }

        @keyframes fadeInUp {
            from {
                opacity: 0;
                transform: translateY(30px);
            }
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }

        /* Stats Section */
        .stats-section {
            background: linear-gradient(135deg, var(--primary), var(--primary-dark));
            color: white;
            padding: 60px 20px;
            position: relative;
            overflow: hidden;
        }

        .stats-section::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: url('data:image/svg+xml,<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 100 100"><defs><pattern id="grain" width="100" height="100" patternUnits="userSpaceOnUse"><circle cx="25" cy="25" r="1" fill="white" opacity="0.1"/><circle cx="75" cy="75" r="1" fill="white" opacity="0.1"/></pattern></defs><rect width="100" height="100" fill="url(%23grain)"/></svg>');
            opacity: 0.3;
        }

        .stats-container {
            max-width: 1280px;
            margin: 0 auto;
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 40px;
            text-align: center;
            position: relative;
            z-index: 2;
        }

        .stat-item {
            padding: 20px;
            border-radius: var(--radius-lg);
            background: rgba(255,255,255,0.1);
            backdrop-filter: blur(10px);
            transition: transform 0.3s;
        }

        .stat-item:hover {
            transform: translateY(-5px);
        }

        .stat-number {
            font-size: 3rem;
            font-weight: 700;
            margin-bottom: 10px;
            color: #ffd700;
        }

        .stat-label {
            font-size: 1.1rem;
            opacity: 0.9;
        }

        /* Services Section */
        .services-section {
            padding: 100px 20px;
            background: var(--gray-light);
        }

        .section-header {
            text-align: center;
            margin-bottom: 80px;
        }

        .section-header h2 {
            font-size: 3rem;
            margin-bottom: 20px;
            color: var(--dark);
            font-weight: 700;
        }

        .section-header p {
            font-size: 1.2rem;
            color: var(--gray);
            max-width: 600px;
            margin: 0 auto;
        }

        .services-grid {
            max-width: 1400px;
            margin: 0 auto;
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(350px, 1fr));
            gap: 30px;
        }

        .service-card {
            background: white;
            border-radius: var(--radius-lg);
            overflow: hidden;
            box-shadow: var(--shadow);
            transition: all 0.3s;
            cursor: pointer;
            position: relative;
            height: 400px;
        }

        .service-card:hover {
            transform: translateY(-8px);
            box-shadow: var(--shadow-xl);
        }

        .service-image {
            width: 100%;
            height: 200px;
            object-fit: cover;
            transition: transform 0.3s;
        }

        .service-card:hover .service-image {
            transform: scale(1.05);
        }

        .service-content {
            padding: 25px;
            height: 200px;
            display: flex;
            flex-direction: column;
            justify-content: space-between;
        }

        .service-title {
            font-size: 1.4rem;
            margin-bottom: 10px;
            color: var(--dark);
            font-weight: 600;
        }

        .service-description {
            color: var(--gray);
            margin-bottom: 15px;
            flex-grow: 1;
        }

        .service-price {
            font-size: 1.3rem;
            font-weight: 700;
            color: var(--primary);
        }

        .service-badge {
            position: absolute;
            top: 15px;
            right: 15px;
            background: var(--accent);
            color: white;
            padding: 5px 10px;
            border-radius: 20px;
            font-size: 0.8rem;
            font-weight: 600;
        }

        /* Quote Calculator */
        .quote-section {
            padding: 100px 20px;
            background: white;
        }

        .quote-container {
            max-width: 1200px;
            margin: 0 auto;
            background: var(--gray-light);
            border-radius: var(--radius-lg);
            padding: 50px;
            box-shadow: var(--shadow-lg);
        }

        .quote-steps {
            display: flex;
            justify-content: center;
            margin-bottom: 40px;
            gap: 20px;
            flex-wrap: wrap;
        }

        .quote-step {
            display: flex;
            align-items: center;
            gap: 10px;
            padding: 10px 20px;
            background: white;
            border-radius: 30px;
            font-weight: 600;
            color: var(--gray);
        }

        .quote-step.active {
            background: var(--primary);
            color: white;
        }

        .quote-step-number {
            width: 30px;
            height: 30px;
            border-radius: 50%;
            background: var(--primary);
            color: white;
            display: flex;
            align-items: center;
            justify-content: center;
            font-weight: 700;
        }

        .form-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
            gap: 25px;
            margin-bottom: 40px;
        }

        .form-group {
            display: flex;
            flex-direction: column;
        }

        .form-label {
            margin-bottom: 10px;
            font-weight: 600;
            color: var(--dark);
            font-size: 1.1rem;
        }

        .form-input,
        .form-select {
            padding: 15px;
            border: 2px solid #e5e7eb;
            border-radius: var(--radius);
            font-size: 1rem;
            transition: all 0.3s;
            background: white;
        }

        .form-input:focus,
        .form-select:focus {
            outline: none;
            border-color: var(--primary);
            box-shadow: 0 0 0 4px rgba(37, 99, 235, 0.1);
            transform: translateY(-2px);
        }

        .quote-result {
            background: white;
            padding: 40px;
            border-radius: var(--radius-lg);
            margin-top: 40px;
            display: none;
            box-shadow: var(--shadow);
        }

        .quote-line {
            display: flex;
            justify-content: space-between;
            padding: 15px 0;
            border-bottom: 1px solid var(--gray-light);
            font-size: 1.1rem;
        }

        .quote-total {
            font-size: 1.8rem;
            font-weight: 700;
            color: var(--primary);
            padding-top: 25px;
            margin-top: 20px;
            border-top: 3px solid var(--primary);
        }

        .quote-actions {
            margin-top: 30px;
            display: flex;
            gap: 20px;
            justify-content: center;
            flex-wrap: wrap;
        }

        /* Appointment Booking */
        .appointment-section {
            padding: 100px 20px;
            background: linear-gradient(135deg, #f8fafc, #e2e8f0);
        }

        .appointment-container {
            max-width: 1200px;
            margin: 0 auto;
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 50px;
        }

        .calendar-container {
            background: white;
            padding: 40px;
            border-radius: var(--radius-lg);
            box-shadow: var(--shadow-lg);
        }

        .calendar-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 30px;
        }

        .calendar-nav-btn {
            background: var(--primary);
            color: white;
            border: none;
            padding: 10px 15px;
            border-radius: var(--radius);
            cursor: pointer;
            transition: all 0.3s;
        }

        .calendar-nav-btn:hover {
            background: var(--primary-dark);
        }

        .calendar-month {
            font-size: 1.5rem;
            font-weight: 700;
            color: var(--dark);
        }

        .calendar-grid {
            display: grid;
            grid-template-columns: repeat(7, 1fr);
            gap: 5px;
        }

        .calendar-weekday {
            text-align: center;
            padding: 10px;
            font-weight: 600;
            color: var(--gray);
            background: var(--gray-light);
            border-radius: var(--radius);
        }

        .calendar-day {
            aspect-ratio: 1;
            display: flex;
            align-items: center;
            justify-content: center;
            border: 2px solid transparent;
            border-radius: var(--radius);
            cursor: pointer;
            transition: all 0.3s;
            font-weight: 500;
            position: relative;
        }

        .calendar-day:hover {
            background: var(--primary-light);
            color: white;
            transform: scale(1.1);
        }

        .calendar-day.selected {
            background: var(--primary);
            color: white;
            border-color: var(--primary-dark);
        }

        .calendar-day.unavailable {
            color: var(--gray);
            cursor: not-allowed;
            opacity: 0.5;
        }

        .calendar-day.today {
            border-color: var(--accent);
            font-weight: 700;
        }

        .time-slots {
            background: white;
            padding: 40px;
            border-radius: var(--radius-lg);
            box-shadow: var(--shadow-lg);
        }

        .time-slots h3 {
            margin-bottom: 25px;
            font-size: 1.5rem;
            color: var(--dark);
        }

        .time-grid {
            display: grid;
            gap: 10px;
            margin-bottom: 30px;
        }

        .time-slot {
            padding: 15px;
            border: 2px solid var(--gray-light);
            border-radius: var(--radius);
            text-align: center;
            cursor: pointer;
            transition: all 0.3s;
            font-weight: 500;
            position: relative;
        }

        .time-slot:hover {
            border-color: var(--primary);
            background: var(--primary-light);
            color: white;
            transform: translateX(5px);
        }

        .time-slot.selected {
            background: var(--primary);
            color: white;
            border-color: var(--primary-dark);
        }

        .time-slot.unavailable {
            background: var(--gray-light);
            color: var(--gray);
            cursor: not-allowed;
            opacity: 0.6;
        }

        .appointment-form {
            margin-top: 20px;
            padding: 20px;
            background: var(--gray-light);
            border-radius: var(--radius);
            display: none;
        }

        .appointment-form.active {
            display: block;
        }

        /* Interactive Map Section */
        .map-section {
            padding: 100px 20px;
            background: white;
        }

        .map-container {
            max-width: 1400px;
            margin: 0 auto;
            display: grid;
            grid-template-columns: 1fr 2fr;
            gap: 50px;
        }

        .map-info {
            background: var(--gray-light);
            padding: 40px;
            border-radius: var(--radius-lg);
            box-shadow: var(--shadow);
        }

        .zone-list {
            list-style: none;
            padding: 0;
        }

        .zone-item {
            padding: 15px 0;
            border-bottom: 1px solid rgba(0,0,0,0.1);
            display: flex;
            justify-content: space-between;
            align-items: center;
            transition: all 0.3s;
        }

        .zone-item:hover {
            background: rgba(37, 99, 235, 0.1);
            padding-left: 10px;
            border-radius: var(--radius);
        }

        .zone-badge {
            background: var(--accent);
            color: white;
            padding: 5px 10px;
            border-radius: 20px;
            font-size: 0.8rem;
        }

        .map-frame {
            height: 600px;
            border-radius: var(--radius-lg);
            overflow: hidden;
            box-shadow: var(--shadow-lg);
            position: relative;
        }

        .map-overlay {
            position: absolute;
            top: 20px;
            left: 20px;
            background: rgba(255,255,255,0.95);
            padding: 15px;
            border-radius: var(--radius);
            backdrop-filter: blur(10px);
            z-index: 100;
        }

        /* Blog Section */
        .blog-section {
            padding: 100px 20px;
            background: var(--gray-light);
        }

        .blog-grid {
            max-width: 1400px;
            margin: 0 auto;
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(400px, 1fr));
            gap: 40px;
        }

        .blog-card {
            background: white;
            border-radius: var(--radius-lg);
            overflow: hidden;
            box-shadow: var(--shadow);
            transition: all 0.3s;
            height: 500px;
            display: flex;
            flex-direction: column;
        }

        .blog-card:hover {
            transform: translateY(-8px);
            box-shadow: var(--shadow-xl);
        }

        .blog-image {
            width: 100%;
            height: 250px;
            object-fit: cover;
            transition: transform 0.3s;
        }

        .blog-card:hover .blog-image {
            transform: scale(1.05);
        }

        .blog-content {
            padding: 30px;
            flex-grow: 1;
            display: flex;
            flex-direction: column;
        }

        .blog-meta {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 15px;
        }

        .blog-date {
            color: var(--gray);
            font-size: 0.9rem;
            font-weight: 500;
        }

        .blog-category {
            background: var(--primary);
            color: white;
            padding: 4px 12px;
            border-radius: 20px;
            font-size: 0.8rem;
            font-weight: 600;
        }

        .blog-title {
            font-size: 1.4rem;
            margin-bottom: 15px;
            color: var(--dark);
            font-weight: 600;
            line-height: 1.4;
        }

        .blog-excerpt {
            color: var(--gray);
            margin-bottom: 20px;
            flex-grow: 1;
            line-height: 1.6;
        }

        .blog-read-time {
            color: var(--gray);
            font-size: 0.9rem;
            margin-top: auto;
        }

        /* Gallery */
        .gallery-section {
            padding: 100px 20px;
            background: white;
        }

        .gallery-grid {
            max-width: 1400px;
            margin: 0 auto;
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
            gap: 20px;
        }

        .gallery-item {
            position: relative;
            overflow: hidden;
            border-radius: var(--radius-lg);
            height: 350px;
            cursor: pointer;
            box-shadow: var(--shadow);
        }

        .gallery-item img {
            width: 100%;
            height: 100%;
            object-fit: cover;
            transition: transform 0.5s;
        }

        .gallery-item:hover img {
            transform: scale(1.1);
        }

        .gallery-overlay {
            position: absolute;
            bottom: 0;
            left: 0;
            right: 0;
            background: linear-gradient(to top, rgba(0,0,0,0.9), transparent);
            color: white;
            padding: 30px;
            transform: translateY(100%);
            transition: transform 0.3s;
        }

        .gallery-item:hover .gallery-overlay {
            transform: translateY(0);
        }

        .gallery-title {
            font-size: 1.3rem;
            font-weight: 600;
            margin-bottom: 8px;
        }

        .gallery-description {
            font-size: 0.95rem;
            opacity: 0.9;
        }

        /* Enhanced Chat Widget */
        .chat-widget {
            position: fixed;
            bottom: 30px;
            right: 30px;
            z-index: 1000;
        }

        .chat-button {
            width: 70px;
            height: 70px;
            border-radius: 50%;
            background: linear-gradient(135deg, var(--primary), var(--primary-light));
            color: white;
            display: flex;
            align-items: center;
            justify-content: center;
            cursor: pointer;
            box-shadow: var(--shadow-xl);
            transition: all 0.3s;
            position: relative;
            overflow: hidden;
        }

        .chat-button::before {
            content: '';
            position: absolute;
            top: 0;
            left: -100%;
            width: 100%;
            height: 100%;
            background: linear-gradient(90deg, transparent, rgba(255,255,255,0.3), transparent);
            transition: left 0.5s;
        }

        .chat-button:hover::before {
            left: 100%;
        }

        .chat-button:hover {
            transform: scale(1.1);
            box-shadow: 0 20px 40px -10px rgba(37, 99, 235, 0.4);
        }

        .chat-button .icon {
            font-size: 1.5rem;
        }

        .chat-window {
            position: absolute;
            bottom: 90px;
            right: 0;
            width: 400px;
            height: 600px;
            background: white;
            border-radius: var(--radius-lg);
            box-shadow: var(--shadow-xl);
            display: none;
            flex-direction: column;
            overflow: hidden;
        }

        .chat-window.active {
            display: flex;
            animation: slideUp 0.3s ease-out;
        }

        @keyframes slideUp {
            from {
                opacity: 0;
                transform: translateY(20px);
            }
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }

        .chat-header {
            background: linear-gradient(135deg, var(--primary), var(--primary-dark));
            color: white;
            padding: 25px;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .chat-header-info {
            display: flex;
            align-items: center;
            gap: 15px;
        }

        .chat-avatar {
            width: 40px;
            height: 40px;
            border-radius: 50%;
            background: rgba(255,255,255,0.2);
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 1.2rem;
        }

        .chat-status {
            display: flex;
            flex-direction: column;
        }

        .chat-name {
            font-weight: 600;
            font-size: 1.1rem;
        }

        .chat-online {
            font-size: 0.85rem;
            opacity: 0.9;
        }

        .chat-close {
            background: none;
            border: none;
            color: white;
            cursor: pointer;
            font-size: 1.5rem;
            padding: 5px;
            border-radius: var(--radius);
            transition: background 0.3s;
        }

        .chat-close:hover {
            background: rgba(255,255,255,0.2);
        }

        .chat-messages {
            flex: 1;
            padding: 25px;
            overflow-y: auto;
            background: #f8fafc;
        }

        .chat-message {
            margin-bottom: 20px;
            padding: 15px 20px;
            border-radius: var(--radius-lg);
            max-width: 85%;
            animation: messageSlide 0.3s ease-out;
        }

        @keyframes messageSlide {
            from {
                opacity: 0;
                transform: translateY(10px);
            }
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }

        .chat-message.user {
            background: var(--primary);
            color: white;
            margin-left: auto;
            border-bottom-right-radius: 5px;
        }

        .chat-message.bot {
            background: white;
            color: var(--dark);
            border-bottom-left-radius: 5px;
            box-shadow: var(--shadow);
        }

        .chat-typing {
            display: none;
            padding: 15px 20px;
            background: white;
            border-radius: var(--radius-lg);
            margin-bottom: 20px;
            max-width: 85%;
            box-shadow: var(--shadow);
        }

        .chat-typing.active {
            display: block;
        }

        .typing-dots {
            display: flex;
            gap: 4px;
        }

        .typing-dot {
            width: 8px;
            height: 8px;
            background: var(--gray);
            border-radius: 50%;
            animation: typing 1.4s infinite;
        }

        .typing-dot:nth-child(2) {
            animation-delay: 0.2s;
        }

        .typing-dot:nth-child(3) {
            animation-delay: 0.4s;
        }

        @keyframes typing {
            0%, 60%, 100% {
                transform: translateY(0);
                opacity: 0.4;
            }
            30% {
                transform: translateY(-10px);
                opacity: 1;
            }
        }

        .chat-input-container {
            padding: 20px;
            border-top: 1px solid var(--gray-light);
            background: white;
            display: flex;
            gap: 10px;
        }

        .chat-input {
            flex: 1;
            padding: 12px 15px;
            border: 2px solid var(--gray-light);
            border-radius: 20px;
            outline: none;
            transition: border-color 0.3s;
        }

        .chat-input:focus {
            border-color: var(--primary);
        }

        .chat-send {
            background: var(--primary);
            color: white;
            border: none;
            padding: 12px 20px;
            border-radius: 20px;
            cursor: pointer;
            transition: all 0.3s;
        }

        .chat-send:hover {
            background: var(--primary-dark);
            transform: translateY(-1px);
        }

        .quick-actions {
            display: flex;
            flex-wrap: wrap;
            gap: 10px;
            margin-bottom: 15px;
        }

        .quick-action {
            background: var(--gray-light);
            color: var(--dark);
            padding: 8px 15px;
            border-radius: 20px;
            font-size: 0.9rem;
            cursor: pointer;
            transition: all 0.3s;
        }

        .quick-action:hover {
            background: var(--primary);
            color: white;
        }

        /* Footer */
        .footer {
            background: var(--dark);
            color: white;
            padding: 80px 20px 40px;
            position: relative;
        }

        .footer::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            height: 5px;
            background: linear-gradient(90deg, var(--primary), var(--secondary), var(--accent));
        }

        .footer-content {
            max-width: 1400px;
            margin: 0 auto;
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
            gap: 50px;
            margin-bottom: 50px;
        }

        .footer-section h3 {
            font-size: 1.3rem;
            margin-bottom: 25px;
            color: var(--accent);
        }

        .footer-section ul {
            list-style: none;
            padding: 0;
        }

        .footer-section li {
            padding: 8px 0;
            transition: color 0.3s;
        }

        .footer-section li:hover {
            color: var(--accent);
            cursor: pointer;
        }

        .footer-bottom {
            border-top: 1px solid rgba(255,255,255,0.1);
            padding-top: 30px;
            text-align: center;
            color: rgba(255,255,255,0.7);
        }

        .social-links {
            display: flex;
            gap: 15px;
            justify-content: center;
            margin-top: 20px;
        }

        .social-link {
            width: 45px;
            height: 45px;
            background: rgba(255,255,255,0.1);
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            color: white;
            text-decoration: none;
            transition: all 0.3s;
        }

        .social-link:hover {
            background: var(--primary);
            transform: translateY(-3px);
        }

        /* Notification Badge */
        .notification-badge {
            position: absolute;
            top: -8px;
            right: -8px;
            background: var(--danger);
            color: white;
            width: 25px;
            height: 25px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 0.8rem;
            font-weight: 600;
            animation: pulse 2s infinite;
        }

        @keyframes pulse {
            0%, 100% {
                transform: scale(1);
            }
            50% {
                transform: scale(1.2);
            }
        }

        /* Mobile Menu */
        .mobile-menu-btn {
            display: none;
            background: none;
            border: none;
            font-size: 1.8rem;
            cursor: pointer;
            color: var(--dark);
        }

        .mobile-nav {
            display: none;
            position: fixed;
            top: 70px;
            left: 0;
            right: 0;
            background: white;
            box-shadow: var(--shadow-lg);
            z-index: 999;
            padding: 20px;
        }

        .mobile-nav.active {
            display: block;
        }

        .mobile-nav a {
            display: block;
            padding: 15px 0;
            color: var(--dark);
            text-decoration: none;
            border-bottom: 1px solid var(--gray-light);
            font-weight: 500;
        }

        /* Responsive Design */
        @media (max-width: 768px) {
            .nav-menu {
                display: none;
            }
            
            .mobile-menu-btn {
                display: block;
            }
            
            .hero-content h1 {
                font-size: 2.5rem;
            }
            
            .hero-actions {
                flex-direction: column;
                align-items: center;
            }
            
            .appointment-container,
            .map-container {
                grid-template-columns: 1fr;
                gap: 30px;
            }
            
            .chat-window {
                width: calc(100vw - 40px);
                right: -10px;
                height: 500px;
            }

            .services-grid,
            .blog-grid,
            .gallery-grid {
                grid-template-columns: 1fr;
            }

            .form-grid {
                grid-template-columns: 1fr;
            }

            .section-header h2 {
                font-size: 2.2rem;
            }

            .stats-container {
                grid-template-columns: repeat(2, 1fr);
            }
        }

        @media (max-width: 480px) {
            .hero-content h1 {
                font-size: 2rem;
            }

            .stats-container {
                grid-template-columns: 1fr;
            }

            .quote-container,
            .calendar-container,
            .time-slots {
                padding: 30px 20px;
            }
        }

        /* Loading Animation */
        .loading {
            display: inline-block;
            width: 20px;
            height: 20px;
            border: 3px solid rgba(255,255,255,.3);
            border-radius: 50%;
            border-top-color: #fff;
            animation: spin 1s ease-in-out infinite;
        }

        @keyframes spin {
            to { transform: rotate(360deg); }
        }

        @keyframes fadeIn {
            from { opacity: 0; }
            to { opacity: 1; }
        }

        @keyframes slideUp {
            from {
                opacity: 0;
                transform: translateY(30px);
            }
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }

        /* Tooltip */
        .tooltip {
            position: relative;
        }

        .tooltip::after {
            content: attr(data-tooltip);
            position: absolute;
            bottom: 100%;
            left: 50%;
            transform: translateX(-50%);
            background: var(--dark);
            color: white;
            padding: 8px 12px;
            border-radius: var(--radius);
            font-size: 0.8rem;
            white-space: nowrap;
            opacity: 0;
            visibility: hidden;
            transition: all 0.3s;
            z-index: 1000;
        }

        .tooltip:hover::after {
            opacity: 1;
            visibility: visible;
            transform: translateX(-50%) translateY(-5px);
        }
    </style>

  <!-- === MJC IMG-ROBUST: fallback & placeholders === -->
  <style>
    .img-skeleton {
      background: linear-gradient(90deg,#f3f4f6, #e5e7eb, #f3f4f6);
      background-size: 200% 100%;
      animation: mjskel 1.2s infinite;
    }
    @keyframes mjskel { 0% {background-position: 200% 0;} 100% {background-position: -200% 0;} }
    img[data-placeholder="1"] { object-fit: cover; }
  </style>
  <script>
  (function(){
    function esc(s){return (s||"").replace(/[&<>]/g, m=>({"&":"&amp;","<":"&lt;",">":"&gt;"}[m]));}
    function svgPlaceholder(alt,w,h){
      w=Math.max(320,Math.min(+w||800,1600)); h=Math.max(180,Math.min(+h||450,1200));
      const title = "MJ Créations — Bretagne";
      const sub = alt && alt.trim() ? alt.trim() : "Illustration indisponible";
      const svg = "<svg xmlns='http://www.w3.org/2000/svg' width='"+w+"' height='"+h+"' viewBox='0 0 "+w+" "+h+"'>"
        +"<defs><linearGradient id='g' x1='0' y1='0' x2='1' y2='1'>"
        +"<stop offset='0' stop-color='#e5f3ff'/><stop offset='1' stop-color='#c7e0ff'/></linearGradient></defs>"
        +"<rect width='100%' height='100%' fill='url(#g)'/>"
        +"<g fill='#0f172a' font-family='system-ui,Segoe UI,Roboto,Helvetica,Arial,sans-serif'>"
        +"<text x='50%' y='46%' dominant-baseline='middle' text-anchor='middle' font-size='"+Math.max(16,Math.min(w,h)/16)+"' font-weight='700'>"+esc(title)+"</text>"
        +"<text x='50%' y='62%' dominant-baseline='middle' text-anchor='middle' font-size='"+Math.max(14,Math.min(w,h)/22)+"'>"+esc(sub)+"</text>"
        +"</g></svg>";
      return "data:image/svg+xml;charset=utf-8,"+encodeURIComponent(svg).replace(/%20/g," ");
    }
    function applyFallback(img){
      if (!img) return;
      const alt=img.getAttribute('alt')||'';
      const w=img.getAttribute('width')||img.naturalWidth||800;
      const h=img.getAttribute('height')||img.naturalHeight||400;
      img.src = svgPlaceholder(alt,w,h);
      img.setAttribute('data-placeholder','1');
      img.classList.add('img-skeleton');
      img.removeAttribute('srcset');
      img.removeAttribute('sizes');
    }
    function harden(img){
      img.setAttribute('loading','lazy');
      img.setAttribute('decoding','async');
      img.setAttribute('referrerpolicy','no-referrer');
      img.setAttribute('crossorigin','anonymous');
      if(!img.getAttribute('width')) img.setAttribute('width','800');
      if(!img.getAttribute('height')) img.setAttribute('height','400');
      img.addEventListener('error', function onErr(){
        img.removeEventListener('error', onErr);
        applyFallback(img);
      });
      if(!img.getAttribute('src') || img.getAttribute('src')===''){
        applyFallback(img);
      }
    }
    document.addEventListener('DOMContentLoaded', function(){
      document.querySelectorAll('img').forEach(harden);
      // Hero: default gradient if no image is set
      const hero = document.querySelector('.hero');
      if (hero){
        const hasBg = (getComputedStyle(hero).backgroundImage||'').includes('url');
        if(!hasBg){
          hero.style.background = "linear-gradient(120deg,#1e293b,#0ea5a4)";
        }
      }
      // Observe for dynamically added images
      const mo = new MutationObserver(muts => {
        muts.forEach(m => m.addedNodes.forEach(n => {
          if (n.tagName==='IMG') harden(n);
          if (n.querySelectorAll) n.querySelectorAll('img').forEach(harden);
        }));
      });
      mo.observe(document.documentElement, {childList:true, subtree:true});
    });
  })();
  </script>


<!-- === MJC IMG-ROBUST v2: themed illustrations per keyword === -->
<script>
(function(){
  function themedSVG(alt, w, h){
    w=Math.max(320,Math.min(+w||800,1600)); h=Math.max(180,Math.min(+h||450,1200));
    const t = (alt||"").toLowerCase();
    let bg1="#c7e0ff", bg2="#e5f3ff", icon="🏠", title="MJ Créations — Bretagne";
    if(/bain|douche|sdb/.test(t)){ bg1="#0ea5a4"; bg2="#94f1ea"; icon="🚿"; title="Salle de bain — Bretagne"; }
    else if(/cuisine|ilot|plan|meuble/.test(t)){ bg1="#2563eb"; bg2="#93c5fd"; icon="🍽️"; title="Cuisine — Bretagne"; }
    else if(/terrasse|bois|exter/.test(t)){ bg1="#10b981"; bg2="#a7f3d0"; icon="🌿"; title="Terrasse — Bretagne"; }
    else if(/elec|élec|prise|tableau|spot/.test(t)){ bg1="#7c3aed"; bg2="#c4b5fd"; icon="🔌"; title="Électricité — Bretagne"; }
    else if(/chauff|chaudi|radiateur|gaz|pac|clim/.test(t)){ bg1="#f59e0b"; bg2="#fde68a"; icon="🔥"; title="Chauffage & Clim — Bretagne"; }
    else if(/carrelage|sol|revêtement/.test(t)){ bg1="#ef4444"; bg2="#fecaca"; icon="🧱"; title="Revêtements — Bretagne"; }
    else if(/pompe|vmc|ventil/.test(t)){ bg1="#0ea5a4"; bg2="#a7f3d0"; icon="🌀"; title="Ventilation — Bretagne"; }

    const fg = "#111827";
    const sub = alt && alt.trim() ? alt.trim() : "Illustration";
    const svg =
      `<svg xmlns='http://www.w3.org/2000/svg' width='${w}' height='${h}' viewBox='0 0 ${w} ${h}'>`+
      `<defs><linearGradient id='g' x1='0' y1='0' x2='1' y2='1'>`+
      `<stop offset='0' stop-color='${bg1}'/><stop offset='1' stop-color='${bg2}'/></linearGradient>`+
      `<filter id='s'><feDropShadow dx='0' dy='2' stdDeviation='6' flood-color='#000' flood-opacity='.18'/></filter>`+
      `</defs>`+
      `<rect width='100%' height='100%' fill='url(#g)'/>`+
      `<g font-family='system-ui,Segoe UI,Roboto,Helvetica,Arial,sans-serif' fill='${fg}' text-anchor='middle'>`+
      `<text x='50%' y='42%' font-size='${Math.max(32,Math.min(w,h)/8)}' filter='url(#s)'>${icon}</text>`+
      `<text x='50%' y='60%' font-size='${Math.max(14,Math.min(w,h)/18)}' font-weight='700'>${title}</text>`+
      `<text x='50%' y='74%' font-size='${Math.max(12,Math.min(w,h)/22)}'>${sub}</text>`+
      `</g>`+
      `</svg>`;
    return "data:image/svg+xml;charset=utf-8,"+encodeURIComponent(svg).replace(/%20/g," ");
  }

  function applyThemedIfFallback(img){
    if(!img) return;
    const isPh = img.getAttribute('data-placeholder') === '1' || !img.getAttribute('src') || img.getAttribute('src').startsWith('data:image/svg+xml');
    if(!isPh) return;
    const alt = img.getAttribute('alt')||'';
    const w = img.getAttribute('width')||img.naturalWidth||800;
    const h = img.getAttribute('height')||img.naturalHeight||400;
    img.src = themedSVG(alt, w, h);
  }

  function run(){
    document.querySelectorAll('img').forEach(applyThemedIfFallback);
  }
  document.addEventListener('DOMContentLoaded', run);
  const mo = new MutationObserver(()=>run());
  mo.observe(document.documentElement, {childList:true, subtree:true});
})();
</script>


<!-- MJC PATCH: SDKs & Config Hooks -->
<script src="https://www.gstatic.com/firebasejs/9.22.2/firebase-app-compat.js"></script>
<script src="https://www.gstatic.com/firebasejs/9.22.2/firebase-firestore-compat.js"></script>
<script src="https://www.gstatic.com/firebasejs/9.22.2/firebase-auth-compat.js"></script>
<script src="/assets/js/firebase-config.js"></script>
<script>
  (function(){
    try {
      if (!window.firebase || !window.firebase.initializeApp) return;
      if (!window.MJ_FIREBASE_CONFIG && !window.firebase.apps.length) {
        console.warn('MJ_FIREBASE_CONFIG is not defined. Configure /assets/js/firebase-config.js');
        return;
      }
      if (!window.firebase.apps.length) {
        window.firebase.initializeApp(window.MJ_FIREBASE_CONFIG || {});
        console.log('[MJC] Firebase initialized in Vitrine.');
      }
      window.MJ_db = window.firebase.firestore();
      window.MJ_db.enablePersistence().catch(function(err){ console.warn('Persistence error', err); });
      window.MJ_auth = window.firebase.auth();
    } catch(e){ console.error(e); }
  })();
</script>
<script src="https://js.stripe.com/v3/"></script>

</head>
<body>
    <!-- Header -->
    <header class="header" id="header">
        <div class="nav-container">
            <div class="logo">
                🔧 MJ Créations
            </div>
            
            <nav class="nav-menu">
                <a href="#services" class="nav-link">Services</a>
                <a href="#devis" class="nav-link">Devis</a>
                <a href="#rdv" class="nav-link">RDV</a>
                <a href="#zones" class="nav-link">Zones</a>
                <a href="#blog" class="nav-link">Blog</a>
                <a href="#contact" class="nav-link">Contact</a>
            </nav>
            
            <div class="nav-menu">
                <a href="tel:0611203741" class="btn btn-primary">
                    📞 06 11 20 37 41
                </a>
            </div>
            
            <button class="mobile-menu-btn" onclick="toggleMobileMenu()">☰</button>
        </div>
        
        <div class="mobile-nav" id="mobileNav">
            <a href="#services">Services</a>
            <a href="#devis">Devis</a>
            <a href="#rdv">RDV</a>
            <a href="#zones">Zones</a>
            <a href="#blog">Blog</a>
            <a href="#contact">Contact</a>
            <a href="tel:0611203741">📞 06 11 20 37 41</a>
        </div>
    </header>

    <!-- Hero Section -->
    <section class="hero">
        <div class="hero-content">
            <h1>Expert Rénovation en Bretagne</h1>
            <p>Plus de 600 prestations • Garantie décennale • Intervention 7j/7</p>
            <div class="hero-actions">
                <a href="#devis" class="btn btn-primary" style="padding: 18px 35px; font-size: 1.1rem;">✨ Devis Gratuit</a>
                <a href="#rdv" class="btn btn-success" style="padding: 18px 35px; font-size: 1.1rem;">📅 Prendre RDV</a>
                <a href="#services" class="btn btn-outline" style="padding: 18px 35px; font-size: 1.1rem;">🔍 Voir Services</a>
            </div>
        </div>
    </section>

    <!-- Stats -->
    <section class="stats-section">
        <div class="stats-container">
            <div class="stat-item">
                <div class="stat-number" data-count="1500">0</div>
                <div class="stat-label">Clients Satisfaits</div>
            </div>
            <div class="stat-item">
                <div class="stat-number" data-count="600">0</div>
                <div class="stat-label">Prestations Disponibles</div>
            </div>
            <div class="stat-item">
                <div class="stat-number" data-count="15">0</div>
                <div class="stat-label">Années d'Expérience</div>
            </div>
            <div class="stat-item">
                <div class="stat-number">4.9★</div>
                <div class="stat-label">Note Moyenne</div>
            </div>
        </div>
    </section>

    <!-- Services avec toutes les prestations -->
    <section class="services-section" id="services">
        <div class="section-header">
            <h2>Nos 600+ Prestations</h2>
            <p>Des tarifs transparents et détaillés pour tous vos projets de rénovation</p>
        </div>
        
        <div class="services-grid">
            <div class="service-card" onclick="showServiceDetails('revetements')">
                <span class="service-badge">Popular</span>
                <img src="https://images.unsplash.com/photo-1558618666-fcd25c85cd64?w=800" alt="Revêtements de sol" class="service-image">
                <div class="service-content">
                    <h3 class="service-title">🏠 Revêtements de Sol</h3>
                    <p class="service-description">Carrelage, parquet, PVC, moquette... Plus de 50 prestations disponibles avec pose professionnelle garantie.</p>
                    <div class="service-price">À partir de 15€/m²</div>
                </div>
            </div>
            
            <div class="service-card" onclick="showServiceDetails('salle-bain')">
                <img src="https://images.unsplash.com/photo-1584622650111-993a426fbf0a?w=800" alt="Rénovation salle de bain moderne" class="service-image">
                <div class="service-content">
                    <h3 class="service-title">🚿 Salle de Bain Complète</h3>
                    <p class="service-description">Rénovation clé en main, douche italienne, baignoire balnéo, WC suspendu... Tous corps d'état.</p>
                    <div class="service-price">À partir de 250€</div>
                </div>
            </div>
            
            <div class="service-card" onclick="showServiceDetails('cuisine')">
                <img src="https://images.unsplash.com/photo-1556909114-f6e7ad7d3136?w=800" alt="Cuisine équipée moderne" class="service-image">
                <div class="service-content">
                    <h3 class="service-title">🍳 Cuisine Équipée</h3>
                    <p class="service-description">Pose complète, plan de travail, électroménager, plomberie et électricité incluse.</p>
                    <div class="service-price">550€/jour</div>
                </div>
            </div>
            
            <div class="service-card" onclick="showServiceDetails('menuiserie')">
                <span class="service-badge">Nouveau</span>
                <img src="https://images.unsplash.com/photo-1449824913935-59a10b8d2000?w=800" alt="Menuiserie portes fenêtres" class="service-image">
                <div class="service-content">
                    <h3 class="service-title">🚪 Menuiseries</h3>
                    <p class="service-description">Portes, fenêtres, volets, pergolas, vérandas... Installation et motorisation comprise.</p>
                    <div class="service-price">À partir de 150€</div>
                </div>
            </div>
            
            <div class="service-card" onclick="showServiceDetails('chauffage')">
                <img src="https://images.unsplash.com/photo-1571068316344-75bc76f77890?w=800" alt="Chauffage climatisation" class="service-image">
                <div class="service-content">
                    <h3 class="service-title">🔥 Chauffage & Climatisation</h3>
                    <p class="service-description">Pompe à chaleur, chaudière, poêle, climatisation... Installation, entretien et dépannage 24h/24.</p>
                    <div class="service-price">À partir de 120€</div>
                </div>
            </div>
            
            <div class="service-card" onclick="showServiceDetails('electricite')">
                <img src="https://images.unsplash.com/photo-1621905252507-b35492cc74b4?w=800" alt="Installation électrique" class="service-image">
                <div class="service-content">
                    <h3 class="service-title">⚡ Électricité</h3>
                    <p class="service-description">Mise aux normes, tableau électrique, domotique, borne de recharge véhicule électrique.</p>
                    <div class="service-price">À partir de 65€</div>
                </div>
            </div>
            
            <div class="service-card" onclick="showServiceDetails('plomberie')">
                <img src="https://images.unsplash.com/photo-1607472586893-edb57bdc0e39?w=800" alt="Plomberie chauffage" class="service-image">
                <div class="service-content">
                    <h3 class="service-title">🔧 Plomberie</h3>
                    <p class="service-description">Dépannage urgence 24h/24, détection de fuite, installation sanitaire, adoucisseur d'eau.</p>
                    <div class="service-price">À partir de 80€</div>
                </div>
            </div>
            
            <div class="service-card" onclick="showServiceDetails('peinture')">
                <img src="https://images.unsplash.com/photo-1562113530-57ba467cea38?w=800" alt="Peinture décoration" class="service-image">
                <div class="service-content">
                    <h3 class="service-title">🎨 Peinture & Décoration</h3>
                    <p class="service-description">Peinture, papier peint, enduits décoratifs, béton ciré... Finitions haut de gamme.</p>
                    <div class="service-price">À partir de 32€/m²</div>
                </div>
            </div>
            
            <div class="service-card" onclick="showServiceDetails('exterieur')">
                <img src="https://images.unsplash.com/photo-1600607687644-c7171b42498b?w=800" alt="Aménagement extérieur" class="service-image">
                <div class="service-content">
                    <h3 class="service-title">🌳 Aménagement Extérieur</h3>
                    <p class="service-description">Terrasse, clôture, portail automatique, piscine, arrosage automatique, éclairage jardin.</p>
                    <div class="service-price">À partir de 35€/m²</div>
                </div>
            </div>
        </div>
    </section>

    <!-- Calculateur de devis avec toutes les prestations -->
    <section class="quote-section" id="devis">
        <div class="section-header">
            <h2>Calculateur de Devis Instantané</h2>
            <p>Obtenez un prix précis parmi nos 600+ prestations en quelques clics</p>
        </div>
        
        <div class="quote-container">
            <div class="quote-steps">
                <div class="quote-step active">
                    <div class="quote-step-number">1</div>
                    <span>Service</span>
                </div>
                <div class="quote-step">
                    <div class="quote-step-number">2</div>
                    <span>Détails</span>
                </div>
                <div class="quote-step">
                    <div class="quote-step-number">3</div>
                    <span>Options</span>
                </div>
                <div class="quote-step">
                    <div class="quote-step-number">4</div>
                    <span>Résultat</span>
                </div>
            </div>
            
            <div class="form-grid">
                <div class="form-group">
                    <label class="form-label">🎯 Catégorie de Service</label>
                    <select class="form-select" id="serviceCategory" onchange="updateServiceOptions()">
                        <option value="">Sélectionnez une catégorie</option>
                    </select>
                </div>
                
                <div class="form-group">
                    <label class="form-label">🔧 Prestation Spécifique</label>
                    <select class="form-select" id="specificService">
                        <option value="">Choisissez d'abord une catégorie</option>
                    </select>
                </div>
                
                <div class="form-group">
                    <label class="form-label">📏 Quantité/Surface</label>
                    <input type="number" class="form-input" id="quantity" placeholder="Ex: 25" min="1">
                </div>
                
                <div class="form-group">
                    <label class="form-label">📍 Code Postal</label>
                    <input type="text" class="form-input" id="postalCode" placeholder="Ex: 22950" maxlength="5">
                </div>
                
                <div class="form-group">
                    <label class="form-label">⏰ Type d'Intervention</label>
                    <select class="form-select" id="urgency">
                        <option value="normal">Planifiée (tarif normal)</option>
                        <option value="soir">Soir/Weekend (+50%)</option>
                        <option value="ferie">Jours fériés (+100%)</option>
                        <option value="urgence">Urgence 24h/24 (+120%)</option>
                    </select>
                </div>
                
                <div class="form-group">
                    <label class="form-label">🏙️ Zone d'Intervention</label>
                    <select class="form-select" id="zone">
                        <option value="standard">Zone standard</option>
                        <option value="urbaine">Zone urbaine (+20%)</option>
                        <option value="rurale">Zone rurale (+10%)</option>
                    </select>
                </div>
            </div>
            
            <button class="btn btn-primary" style="width: 100%; padding: 18px; font-size: 1.2rem;" onclick="calculateQuote()">
                💰 Calculer Mon Devis Gratuit
            </button>
            
            <div class="quote-result" id="quoteResult">
                <div id="quoteBreakdown"></div>
                <div class="quote-actions">
                    <button class="btn btn-success" onclick="validateQuote()">✅ Réserver ce Devis</button>
                    <button class="btn btn-secondary" onclick="modifyQuote()">✏️ Modifier</button>
                    <button class="btn btn-outline" onclick="sendQuoteByEmail()">📧 Envoyer par Email</button>
                </div>
            </div>
        </div>
    </section>

    <!-- Prise de RDV Avancée -->
    <section class="appointment-section" id="rdv">
        <div class="section-header">
            <h2>📅 Réservation en Ligne</h2>
            <p>Choisissez votre créneau pour une visite gratuite et sans engagement</p>
        </div>
        
        <div class="appointment-container">
            <div class="calendar-container">
                <div class="calendar-header">
                    <button class="calendar-nav-btn" onclick="previousMonth()">◀</button>
                    <h3 class="calendar-month" id="currentMonth">Décembre 2024</h3>
                    <button class="calendar-nav-btn" onclick="nextMonth()">▶</button>
                </div>
                <div class="calendar-grid" id="calendar">
                    <!-- Généré en JS -->
                </div>
            </div>
            
            <div class="time-slots">
                <h3>🕐 Créneaux Disponibles</h3>
                <div class="time-grid" id="timeSlots">
                    <div class="time-slot" onclick="selectTime(this)">09:00 - 10:00 ✅</div>
                    <div class="time-slot" onclick="selectTime(this)">10:00 - 11:00 ✅</div>
                    <div class="time-slot unavailable">11:00 - 12:00 ❌</div>
                    <div class="time-slot" onclick="selectTime(this)">14:00 - 15:00 ✅</div>
                    <div class="time-slot" onclick="selectTime(this)">15:00 - 16:00 ✅</div>
                    <div class="time-slot" onclick="selectTime(this)">16:00 - 17:00 ✅</div>
                    <div class="time-slot unavailable">17:00 - 18:00 ❌</div>
                </div>
                
                <div class="appointment-form" id="appointmentForm">
                    <h4>📋 Informations de Contact</h4>
                    <div style="display: grid; gap: 15px; margin-top: 20px;">
                        <input type="text" id="rdvCustomerName" placeholder="Nom complet *" class="form-input" required>
                        <input type="tel" id="rdvCustomerPhone" placeholder="Téléphone *" class="form-input" required>
                        <input type="email" id="rdvCustomerEmail" placeholder="Email *" class="form-input" required>
                        <input type="text" id="rdvCustomerAddress" placeholder="Adresse complète" class="form-input">
                        <textarea id="rdvProjectDescription" placeholder="Description détaillée de votre projet" rows="3" class="form-input"></textarea>
                    </div>
                </div>
                
                <!-- Résumé du devis sélectionné -->
                <div id="selectedQuoteSummary" style="display: none; margin-top: 20px; padding: 20px; background: rgba(37, 99, 235, 0.1); border-radius: var(--radius);">
                    <h4 style="color: var(--primary); margin-bottom: 15px;">📋 Devis Sélectionné</h4>
                    <div id="quoteSummaryContent"></div>
                </div>
                
                <!-- Section Paiement finale -->
<div id="finalPaymentSection" style="display: none; margin-top: 20px; padding: 25px; background: var(--accent); color: white; border-radius: var(--radius);">
    <h4 style="margin-bottom: 20px; display: flex; align-items: center; gap: 10px;">
        Paiement Sécurisé - Confirmation de Réservation
    </h4>
    <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 20px; margin-bottom: 20px; background: rgba(255,255,255,0.1); padding: 15px; border-radius: var(--radius);">
        <div>
            <h5>Acompte requis (30%)</h5>
            <div style="font-size: 1.5rem; font-weight: 700;" id="finalDepositAmount">0€</div>
        </div>
        <div>
            <h5>Solde à réception</h5>
            <div style="font-size: 1.2rem; opacity: 0.9;" id="finalRemainingAmount">0€</div>
        </div>
    </div>
    
    <div style="background: rgba(255,255,255,0.95); color: var(--dark); padding: 20px; border-radius: var(--radius); margin-bottom: 20px;">
        <h5 style="margin-bottom: 15px; color: var(--primary);">Résumé de votre réservation</h5>
        <div id="finalBookingSummary"></div>
    </div>
    
    <!-- Nouveau : Élément carte Stripe -->
    <div style="background: rgba(255,255,255,0.95); color: var(--dark); padding: 20px; border-radius: var(--radius); margin-bottom: 20px;">
        <h5 style="margin-bottom: 15px; color: var(--primary);"></section>

    <!-- Zone d'intervention avec carte interactive -->
    <section class="map-section" id="zones">
        <div class="section-header">
            <h2>🗺️ 
<script id="paypal-sdk" src="https://www.paypal.com/sdk/js?client-id=AdKynU2D6sTxRkvlUeS5NnUEyd8xuCH1SIrT30icRZKjvoeyl6WimLiGzXgbQQfyDzOEm6fhxxC4CX1z&currency=EUR&intent=capture&locale=fr_FR"></script>
<script>
(function(){
  const errBox = document.getElementById('pp-err');
  function err(m){ if(errBox) errBox.textContent = "⚠️ " + m; }
  function parseEUR(t){ const c=(t||"").replace(/[^0-9,.,\s]/g,"").replace(/\s+/g,"").replace(",","."); const n=parseFloat(c); return isFinite(n)?Math.round(n*100)/100:0; }
  function detectTotal(){
    if (window.currentQuoteTotalTTC) return window.currentQuoteTotalTTC;
    const k = document.querySelector('.total-ttc, #total-ttc'); if(k) return parseEUR(k.textContent);
    let best = 0;
    document.querySelectorAll('body *').forEach(el=>{
      const t = el.textContent||'';
      if (/TTC/i.test(t) && /\d/.test(t)){ const mm=t.match(/(\d[\d\s]*[,.]\d{2}|\d[\d\s]*)\s*€/g); if(mm) mm.forEach(x=>{ const v=parseEUR(x); if(v>best) best=v; }); }
    });
    return best;
  }
  const isLocal = location.protocol==='file:';
  function render(){
    if (!(window.paypal && paypal.Buttons)) { err("SDK PayPal bloqué (désactiver AdBlock)."); return; }
    const total = detectTotal()||0; window.currentQuoteTotalTTC = total;
    paypal.Buttons({
      style: { layout:'vertical', color:'gold', shape:'rect', label:'pay' },
      createOrder: async () => {
        if (isLocal) throw new Error("Mode fichier local — API indisponible");
        const r = await fetch(window.API_BASE + "/api/paypal/create-order", {
          method:'POST', headers:{'Content-Type':'application/json'},
          body: JSON.stringify({ quoteId: window.currentQuoteId||"QUOTE", totalTTC: total })
        });
        if(!r.ok) throw new Error("API create-order indisponible");
        const d = await r.json(); if(!d.id) throw new Error("Réponse invalide"); return d.id;
      },
      onApprove: async (data) => {
        if (isLocal) throw new Error("Mode fichier local — API indisponible");
        const r = await fetch(window.API_BASE + "/api/paypal/capture-order", {
          method:'POST', headers:{'Content-Type':'application/json'},
          body: JSON.stringify({ orderId: data.orderID })
        });
        if(!r.ok) throw new Error("API capture-order indisponible");
        alert("Acompte payé ✅ — Merci !");
      },
      onError: (e) => err(e && e.message ? e.message : String(e))
    }).render('#paypal-one');
  }
  if (document.getElementById('paypal-sdk').complete) render(); else window.addEventListener('load', render);
})();
</script>
Zones d'Intervention</h2>
            <p>Nous couvrons toute la Bretagne avec des équipes locales</p>
        </div>
        
        <div class="map-container">
            <div class="map-info">
                <h3>📍 Départements Couverts</h3>
                <ul class="zone-list">
                    <li class="zone-item">
                        <span>✅ Côtes-d'Armor (22)</span>
                        <span class="zone-badge">Zone principale</span>
                    </li>
                    <li class="zone-item">
                        <span>✅ Ille-et-Vilaine (35)</span>
                        <span class="zone-badge">Couverture complète</span>
                    </li>
                    <li class="zone-item">
                        <span>✅ Finistère (29)</span>
                        <span class="zone-badge">Service étendu</span>
                    </li>
                    <li class="zone-item">
                        <span>✅ Morbihan (56)</span>
                        <span class="zone-badge">Intervention rapide</span>
                    </li>
                </ul>
                
                <h4 style="margin-top: 30px; color: var(--primary);">🏙️ Principales Villes</h4>
                <p style="margin: 15px 0;">Saint-Brieuc, Rennes, Brest, Vannes, Lorient, Quimper, Saint-Malo, Dinan, Lannion, Concarneau...</p>
                
                <div style="margin-top: 30px; padding: 25px; background: white; border-radius: var(--radius); box-shadow: var(--shadow);">
                    <h4 style="color: var(--primary); margin-bottom: 15px;">💶 Frais de Déplacement</h4>
                    <div style="display: grid; gap: 10px;">
                        <div style="display: flex; justify-content: space-between;">
                            <span>• Zone locale (< 30km)</span>
                            <strong>30€</strong>
                        </div>
                        <div style="display: flex; justify-content: space-between;">
                            <span>• Départements limitrophes</span>
                            <strong>60€</strong>
                        </div>
                        <div style="display: flex; justify-content: space-between;">
                            <span>• Autres zones Bretagne</span>
                            <strong>Sur devis</strong>
                        </div>
                    </div>
                    <p style="margin-top: 15px; font-size: 0.9rem; color: var(--gray);">
                        ⚡ Intervention d'urgence possible 24h/24 dans un rayon de 50km
                    </p>
                </div>
            </div>
            
            <div class="map-frame">
                <div class="map-overlay">
                    <strong>📍 MJ Créations</strong><br>
                    Trégueux (22950)<br>
                    <small>Siège social</small>
                </div>
                <iframe 
                    src="https://www.google.com/maps/embed?pb=!1m18!1m12!1m3!1d85258.99334326214!2d-2.8447!3d48.5089!2m3!1f0!2f0!3f0!3m2!1i1024!2i768!4f13.1!3m3!1m2!1s0x480fbb66f1f5b5b5%3A0xc4f5e6f5c5c5c5c5!2sBretagne%2C%20France!5e0!3m2!1sfr!2sfr!4v1234567890"
                    width="100%" 
                    height="100%" 
                    style="border:0;" 
                    allowfullscreen="" 
                    loading="lazy">
                </iframe>
            </div>
        </div>
    </section>

    <!-- Blog Section Enrichie -->
    <section class="blog-section" id="blog">
        <div class="section-header">
            <h2>📝 Conseils & Actualités</h2>
            <p>Découvrez nos guides experts et les dernières tendances en rénovation</p>
        </div>
        
        <div class="blog-grid">
            <article class="blog-card">
                <img src="https://images.unsplash.com/photo-1581858726788-75bc0f6a952d?w=800" alt="Tendances carrelage 2024" class="blog-image">
                <div class="blog-content">
                    <div class="blog-meta">
                        <div class="blog-date">15 décembre 2024</div>
                        <div class="blog-category">Tendances</div>
                    </div>
                    <h3 class="blog-title">Tendances Carrelage 2024 : Les Must-Have</h3>
                    <p class="blog-excerpt">Découvrez les nouvelles tendances en matière de carrelage pour cette année : formats XXL, effet béton, carreaux de ciment revisités...</p>
                    <div class="blog-read-time">⏱️ 5 min de lecture</div>
                </div>
            </article>
            
            <article class="blog-card">
                <img src="https://images.unsplash.com/photo-1584622650111-993a426fbf0a?w=800" alt="Guide rénovation salle de bain" class="blog-image">
                <div class="blog-content">
                    <div class="blog-meta">
                        <div class="blog-date">12 décembre 2024</div>
                        <div class="blog-category">Guide Pratique</div>
                    </div>
                    <h3 class="blog-title">Guide Complet : Rénover sa Salle de Bain</h3>
                    <p class="blog-excerpt">Toutes les étapes pour réussir la rénovation de votre salle de bain : planning, budget, choix des matériaux, pièges à éviter...</p>
                    <div class="blog-read-time">⏱️ 12 min de lecture</div>
                </div>
            </article>
            
            <article class="blog-card">
                <img src="https://images.unsplash.com/photo-1565538420870-da08ff96a207?w=800" alt="Économies d'énergie" class="blog-image">
                <div class="blog-content">
                    <div class="blog-meta">
                        <div class="blog-date">8 décembre 2024</div>
                        <div class="blog-category">Éco-Rénovation</div>
                    </div>
                    <h3 class="blog-title">Économies d'Énergie : Aides 2024</h3>
                    <p class="blog-excerpt">Comment réduire votre facture énergétique grâce aux travaux de rénovation ? Guide des aides disponibles, pompe à chaleur, isolation...</p>
                    <div class="blog-read-time">⏱️ 8 min de lecture</div>
                </div>
            </article>

            <article class="blog-card">
                <img src="https://images.unsplash.com/photo-1556909114-f6e7ad7d3136?w=800" alt="Cuisine tendance" class="blog-image">
                <div class="blog-content">
                    <div class="blog-meta">
                        <div class="blog-date">5 décembre 2024</div>
                        <div class="blog-category">Design</div>
                    </div>
                    <h3 class="blog-title">Cuisines 2024 : 10 Idées Inspiration</h3>
                    <p class="blog-excerpt">Les nouvelles tendances cuisine : îlots multifonctions, électroménager intelligent, matériaux naturels et couleurs tendance...</p>
                    <div class="blog-read-time">⏱️ 6 min de lecture</div>
                </div>
            </article>

            <article class="blog-card">
                <img src="https://images.unsplash.com/photo-1600607687644-c7171b42498b?w=800" alt="Aménagement extérieur" class="blog-image">
                <div class="blog-content">
                    <div class="blog-meta">
                        <div class="blog-date">2 décembre 2024</div>
                        <div class="blog-category">Extérieur</div>
                    </div>
                    <h3 class="blog-title">Préparer son Jardin pour l'Hiver</h3>
                    <p class="blog-excerpt">Tous nos conseils pour protéger vos aménagements extérieurs : terrasse, piscine, arrosage automatique, mobilier de jardin...</p>
                    <div class="blog-read-time">⏱️ 7 min de lecture</div>
                </div>
            </article>

            <article class="blog-card">
                <img src="https://images.unsplash.com/photo-1621905252507-b35492cc74b4?w=800" alt="Domotique" class="blog-image">
                <div class="blog-content">
                    <div class="blog-meta">
                        <div class="blog-date">29 novembre 2024</div>
                        <div class="blog-category">Innovation</div>
                    </div>
                    <h3 class="blog-title">Maison Connectée : Par où Commencer ?</h3>
                    <p class="blog-excerpt">Initiation à la domotique : éclairage intelligent, chauffage connecté, sécurité, budget et installation pas à pas...</p>
                    <div class="blog-read-time">⏱️ 10 min de lecture</div>
                </div>
            </article>
        </div>
    </section>

    <!-- Galerie réalisations -->
    <section class="gallery-section">
        <div class="section-header">
            <h2>🖼️ Nos Dernières Réalisations</h2>
            <p>Découvrez nos projets récents et laissez-vous inspirer</p>
        </div>
        
        <div class="gallery-grid">
            <div class="gallery-item">
                <img src="https://images.unsplash.com/photo-1540123317090-82cf7e38b2b1?w=800" alt="Salle de bain moderne rénovée">
                <div class="gallery-overlay">
                    <div class="gallery-title">Salle de Bain Zen & Moderne</div>
                    <div class="gallery-description">Rénovation complète avec douche italienne, vasque suspendue et éclairage LED intégré</div>
                </div>
            </div>
            
            <div class="gallery-item">
                <img src="https://images.unsplash.com/photo-1556912167-f556f1c02a2f?w=800" alt="Cuisine contemporaine avec îlot">
                <div class="gallery-overlay">
                    <div class="gallery-title">Cuisine Ouverte avec Îlot</div>
                    <div class="gallery-description">Installation complète cuisine haut de gamme, électroménager intégré et plan de travail quartz</div>
                </div>
            </div>
            
            <div class="gallery-item">
                <img src="https://images.unsplash.com/photo-1615873968403-89e068629265?w=800" alt="Parquet massif pose française">
                <div class="gallery-overlay">
                    <div class="gallery-title">Parquet Massif Chêne</div>
                    <div class="gallery-description">Pose à l'ancienne, ponçage et vitrification professionnelle pour un résultat durable</div>
                </div>
            </div>

            <div class="gallery-item">
                <img src="https://images.unsplash.com/photo-1600607687644-c7171b42498b?w=800" alt="Terrasse bois composite">
                <div class="gallery-overlay">
                    <div class="gallery-title">Terrasse Composite</div>
                    <div class="gallery-description">Aménagement extérieur avec terrasse composite, éclairage intégré et claustra moderne</div>
                </div>
            </div>

            <div class="gallery-item">
                <img src="https://images.unsplash.com/photo-1558618666-fcd25c85cd64?w=800" alt="Carrelage grand format salon">
                <div class="gallery-overlay">
                    <div class="gallery-title">Carrelage Grand Format</div>
                    <div class="gallery-description">Pose de carrelage 90x90cm effet béton avec chauffage au sol intégré</div>
                </div>
            </div>

            <div class="gallery-item">
                <img src="https://images.unsplash.com/photo-1449824913935-59a10b8d2000?w=800" alt="Porte d'entrée aluminium">
                <div class="gallery-overlay">
                    <div class="gallery-title">Porte d'Entrée Design</div>
                    <div class="gallery-description">Installation porte aluminium avec système de sécurité renforcé et domotique</div>
                </div>
            </div>
        </div>
    </section>

    <!-- Footer Enrichi -->
    <footer class="footer" id="contact">
        <div class="footer-content">
            <div class="footer-section">
                <h3>🔧 MJ Créations</h3>
                <p style="margin: 15px 0;">Votre expert rénovation depuis 2009. Plus de 1500 clients satisfaits en Bretagne.</p>
                <div style="margin: 20px 0;">
                    <p><strong>📍 Adresse :</strong><br>Trégueux (22950)</p>
                    <p><strong>📞 Téléphone :</strong><br><a href="tel:0611203741" style="color: var(--accent);">06 11 20 37 41</a></p>
                    <p><strong>✉️ Email :</strong><br><a href="mailto:contact@mjcreations.fr" style="color: var(--accent);">contact@mjcreations.fr</a></p>
                </div>
            </div>
            
            <div class="footer-section">
                <h3>🔧 Services Principaux</h3>
                <ul>
                    <li>Rénovation Salle de Bain</li>
                    <li>Cuisine Équipée</li>
                    <li>Électricité & Domotique</li>
                    <li>Plomberie & Chauffage</li>
                    <li>Carrelage & Revêtements</li>
                    <li>Menuiseries PVC/Alu</li>
                    <li>Aménagement Extérieur</li>
                    <li>Dépannage Urgence 24h/24</li>
                </ul>
            </div>
            
            <div class="footer-section">
                <h3>📍 Zone d'Intervention</h3>
                <ul>
                    <li>🎯 Côtes-d'Armor (22)</li>
                    <li>🏙️ Ille-et-Vilaine (35)</li>
                    <li>🌊 Finistère (29)</li>
                    <li>🏞️ Morbihan (56)</li>
                </ul>
                <div style="margin-top: 20px; padding: 15px; background: rgba(255,255,255,0.1); border-radius: 8px;">
                    <strong>⚡ Intervention d'Urgence</strong><br>
                    <small>24h/24 - 7j/7 dans un rayon de 50km</small>
                </div>
            </div>
            
            <div class="footer-section">
                <h3>ℹ️ Informations</h3>
                <ul>
                    <li>✅ Garantie Décennale</li>
                    <li>🌱 Certifications RGE</li>
                    <li>💰 Devis Gratuit</li>
                    <li>🏆 15 ans d'Expérience</li>
                    <li>⭐ 4.9/5 - 1500+ Avis</li>
                    <li>📄 Mentions Légales</li>
                    <li>📋 CGV</li>
                    <li>🔒 RGPD</li>
                </ul>
            </div>
        </div>
        
        <div class="footer-bottom">
            <div class="social-links">
                <a href="#" class="social-link">📘</a>
                <a href="#" class="social-link">📷</a>
                <a href="#" class="social-link">🐦</a>
                <a href="#" class="social-link">💼</a>
            </div>
            <p style="margin-top: 20px;">&copy; 2024 MJ Créations. Tous droits réservés. | SIRET: 123 456 789 00012</p>
            <p style="margin-top: 10px; font-size: 0.9rem;">🛡️ Assurance Responsabilité Civile Professionnelle - Garantie Décennale</p>
        </div>
    </footer>

    <!-- Chat Widget Avancé -->
    <div class="chat-widget">
        <div class="chat-button" onclick="toggleChat()">
            <span class="icon">💬</span>
            <span class="notification-badge">3</span>
        </div>
        
        <div class="chat-window" id="chatWindow">
            <div class="chat-header">
                <div class="chat-header-info">
                    <div class="chat-avatar">👨‍🔧</div>
                    <div class="chat-status">
                        <div class="chat-name">Assistant MJ Créations</div>
                        <div class="chat-online">🟢 En ligne</div>
                    </div>
                </div>
                <button class="chat-close" onclick="toggleChat()">✕</button>
            </div>
            
            <div class="chat-messages" id="chatMessages">
                <div class="chat-message bot">
                    Bonjour ! 👋 Je suis là pour vous aider avec vos projets de rénovation.
                </div>
                <div class="chat-message bot">
                    Vous pouvez me poser des questions sur nos services, obtenir un devis rapide, ou prendre rendez-vous.
                </div>
                
                <div class="quick-actions">
                    <div class="quick-action" onclick="quickAction('devis')">💰 Devis rapide</div>
                    <div class="quick-action" onclick="quickAction('rdv')">📅 Prendre RDV</div>
                    <div class="quick-action" onclick="quickAction('urgence')">🚨 Urgence</div>
                    <div class="quick-action" onclick="quickAction('services')">🔧 Nos services</div>
                </div>
            </div>
            
            <div class="chat-typing" id="chatTyping">
                <div class="typing-dots">
                    <div class="typing-dot"></div>
                    <div class="typing-dot"></div>
                    <div class="typing-dot"></div>
                </div>
                <span style="margin-left: 10px;">L'assistant tape...</span>
            </div>
            
            <div class="chat-input-container">
                <input type="text" class="chat-input" placeholder="Tapez votre message..." id="chatInput" onkeypress="handleChatKeypress(event)">
                <button class="chat-send" onclick="sendMessage()">➤</button>
            </div>
        </div>
    </div>

    <script>
        // Base de données complète des 600+ prestations (Version complète)
        const completePricingGrid = {
            revetements: {
                title: "🏠 Revêtements de Sol",
                services: {
                    'pose_carrelage_sol_standard': { price: 55, unit: 'm²', label: 'Pose carrelage sol standard (30x30 à 60x60)' },
                    'pose_carrelage_sol_grand_format': { price: 65, unit: 'm²', label: 'Pose carrelage grand format (>60x60)' },
                    'pose_carrelage_mural_standard': { price: 40, unit: 'm²', label: 'Pose carrelage mural standard' },
                    'pose_faience_sdb': { price: 35, unit: 'm²', label: 'Pose faïence salle de bain' },
                    'pose_mosaique': { price: 65, unit: 'm²', label: 'Pose mosaïque (verre/céramique)' },
                    'pose_carrelage_terrasse': { price: 72, unit: 'm²', label: 'Pose carrelage terrasse extérieur' },
                    'pose_carrelage_piscine': { price: 85, unit: 'm²', label: 'Pose carrelage piscine antidérapant' },
                    'pose_plinthes_carrelage': { price: 15, unit: 'ml', label: 'Pose plinthes carrelage' },
                    'pose_parquet_stratifie': { price: 25, unit: 'm²', label: 'Pose parquet stratifié/contrecollé' },
                    'pose_parquet_flottant_seul': { price: 15, unit: 'm²', label: 'Pose parquet flottant seul' },
                    'pose_parquet_flottant_sous_couche': { price: 28, unit: 'm²', label: 'Pose parquet flottant + sous-couche' },
                    'pose_parquet_massif_cloue': { price: 98, unit: 'm²', label: 'Pose parquet massif cloué' },
                    'pose_parquet_massif_colle': { price: 65, unit: 'm²', label: 'Pose parquet massif collé' },
                    'pose_parquet_contrecolle': { price: 45, unit: 'm²', label: 'Pose parquet contrecollé' },
                    'poncage_parquet': { price: 25, unit: 'm²', label: 'Ponçage parquet' },
                    'vitrification_parquet': { price: 15, unit: 'm²', label: 'Vitrification parquet' },
                    'poncage_vitrification': { price: 30, unit: 'm²', label: 'Ponçage + vitrification' },
                    'huilage_parquet': { price: 20, unit: 'm²', label: 'Huilage parquet' },
                    'pose_plinthes_bois': { price: 12, unit: 'ml', label: 'Pose plinthes bois' },
                    'pose_barre_seuil': { price: 25, unit: 'unité', label: 'Pose barre de seuil' },
                    'pose_quart_de_rond': { price: 8, unit: 'ml', label: 'Pose quart de rond' },
                    'pose_sol_pvc_rouleau': { price: 20, unit: 'm²', label: 'Pose sol PVC/lino en rouleau' },
                    'pose_lames_pvc_clipsables': { price: 25, unit: 'm²', label: 'Pose lames PVC clipsables' },
                    'pose_sol_vinyle_luxe': { price: 35, unit: 'm²', label: 'Pose sol vinyle de luxe (LVT)' },
                    'pose_sol_vinyle': { price: 22, unit: 'm²', label: 'Pose sol vinyle standard' },
                    'pose_moquette_aiguilletee': { price: 25, unit: 'm²', label: 'Pose moquette aiguilletée' },
                    'pose_moquette_tuftee': { price: 30, unit: 'm²', label: 'Pose moquette tuftée' },
                    'pose_dalles_moquette': { price: 28, unit: 'm²', label: 'Pose dalles moquette' },
                    'pose_jonc_mer': { price: 30, unit: 'm²', label: 'Pose jonc de mer/sisal' },
                    'pose_coco': { price: 32, unit: 'm²', label: 'Pose fibre de coco' },
                    'pose_liege': { price: 45, unit: 'm²', label: 'Pose dalles liège' },
                    'pose_bambou': { price: 55, unit: 'm²', label: 'Pose parquet bambou' },
                    'ragreage_autolissant': { price: 12, unit: 'm²', label: 'Ragréage autolissant' },
                    'ragreage_fibre': { price: 15, unit: 'm²', label: 'Ragréage fibré' },
                    'primaire_accrochage': { price: 8, unit: 'm²', label: 'Primaire d\'accrochage' },
                    'depose_ancien_revetement': { price: 10, unit: 'm²', label: 'Dépose ancien revêtement' },
                    'evacuation_gravats': { price: 8, unit: 'm²', label: 'Évacuation gravats' },
                    'nettoyage_fin_chantier': { price: 5, unit: 'm²', label: 'Nettoyage fin de chantier' }
                }
            },
            
            'salle-bain': {
                title: "🚿 Salle de Bain",
                services: {
                    'renovation_petite_sdb': { price: 6000, unit: 'forfait', label: 'Rénovation petite SDB complète (<4m²)' },
                    'renovation_moyenne_sdb': { price: 9000, unit: 'forfait', label: 'Rénovation SDB moyenne (5-7m²)' },
                    'renovation_grande_sdb': { price: 12000, unit: 'forfait', label: 'Rénovation grande SDB (>8m²)' },
                    'renovation_wc_separe': { price: 2500, unit: 'forfait', label: 'Rénovation WC séparé complet' },
                    'pose_baignoire_acrylique': { price: 250, unit: 'unité', label: 'Pose baignoire acrylique standard' },
                    'pose_baignoire_fonte': { price: 350, unit: 'unité', label: 'Pose baignoire fonte/acier' },
                    'pose_baignoire_balneo': { price: 500, unit: 'unité', label: 'Pose baignoire balnéo' },
                    'pose_baignoire_ilot': { price: 650, unit: 'unité', label: 'Pose baignoire îlot' },
                    'pose_tablier_baignoire': { price: 80, unit: 'unité', label: 'Pose tablier baignoire' },
                    'pose_pare_baignoire_fixe': { price: 150, unit: 'unité', label: 'Pose pare-baignoire fixe' },
                    'pose_pare_baignoire_pivotant': { price: 180, unit: 'unité', label: 'Pose pare-baignoire pivotant' },
                    'pose_receveur_douche_standard': { price: 200, unit: 'unité', label: 'Pose receveur douche standard' },
                    'pose_receveur_extra_plat': { price: 250, unit: 'unité', label: 'Pose receveur extra-plat' },
                    'pose_receveur_sur_mesure': { price: 400, unit: 'unité', label: 'Pose receveur sur mesure' },
                    'pose_cabine_douche_complete': { price: 400, unit: 'unité', label: 'Pose cabine douche complète' },
                    'pose_douche_italienne_standard': { price: 1150, unit: 'unité', label: 'Création douche italienne standard' },
                    'pose_douche_italienne_luxe': { price: 1800, unit: 'unité', label: 'Création douche italienne haut de gamme' },
                    'pose_paroi_douche_fixe': { price: 150, unit: 'unité', label: 'Pose paroi douche fixe' },
                    'pose_paroi_douche_coulissante': { price: 200, unit: 'unité', label: 'Pose paroi douche coulissante' },
                    'pose_porte_douche_pivotante': { price: 180, unit: 'unité', label: 'Pose porte douche pivotante' },
                    'pose_caniveau_douche_italienne': { price: 150, unit: 'unité', label: 'Pose caniveau douche italienne' },
                    'etancheite_douche_italienne': { price: 300, unit: 'forfait', label: 'Étanchéité complète douche italienne' },
                    'pose_wc_sol_standard': { price: 200, unit: 'unité', label: 'Pose WC au sol standard' },
                    'pose_wc_suspendu_bati': { price: 375, unit: 'unité', label: 'Pose WC suspendu + bâti-support' },
                    'pose_wc_suspendu_geberit': { price: 450, unit: 'unité', label: 'Pose WC suspendu Geberit' },
                    'pose_abattant_wc_standard': { price: 30, unit: 'unité', label: 'Pose abattant WC standard' },
                    'pose_abattant_wc_japonais': { price: 200, unit: 'unité', label: 'Pose WC japonais' },
                    'pose_lave_mains': { price: 120, unit: 'unité', label: 'Pose lave-mains' },
                    'pose_bidet': { price: 180, unit: 'unité', label: 'Pose bidet' },
                    'pose_lavabo_colonne': { price: 150, unit: 'unité', label: 'Pose lavabo sur colonne' },
                    'pose_lavabo_suspendu': { price: 180, unit: 'unité', label: 'Pose lavabo suspendu' },
                    'pose_vasque_poser': { price: 120, unit: 'unité', label: 'Pose vasque à poser' },
                    'pose_vasque_encastrer': { price: 150, unit: 'unité', label: 'Pose vasque à encastrer' },
                    'pose_plan_vasque_standard': { price: 200, unit: 'unité', label: 'Pose plan vasque standard' },
                    'pose_plan_vasque_sur_mesure': { price: 350, unit: 'unité', label: 'Pose plan vasque sur mesure' },
                    'pose_meuble_vasque_simple': { price: 180, unit: 'unité', label: 'Pose meuble vasque simple' },
                    'pose_meuble_vasque_double': { price: 300, unit: 'unité', label: 'Pose meuble vasque double' },
                    'pose_mitigeur_lavabo': { price: 80, unit: 'unité', label: 'Pose mitigeur lavabo' },
                    'pose_mitigeur_douche': { price: 100, unit: 'unité', label: 'Pose mitigeur douche' },
                    'pose_mitigeur_thermostatique': { price: 120, unit: 'unité', label: 'Pose mitigeur thermostatique' },
                    'pose_mitigeur_baignoire': { price: 110, unit: 'unité', label: 'Pose mitigeur baignoire' },
                    'pose_colonne_douche_standard': { price: 150, unit: 'unité', label: 'Pose colonne douche standard' },
                    'pose_colonne_douche_hydromassante': { price: 200, unit: 'unité', label: 'Pose colonne douche hydromassante' },
                    'pose_robinet_simple': { price: 60, unit: 'unité', label: 'Pose robinet simple' },
                    'pose_douchette_wc': { price: 80, unit: 'unité', label: 'Pose douchette WC' },
                    'pose_miroir_simple': { price: 50, unit: 'unité', label: 'Pose miroir simple' },
                    'pose_miroir_led': { price: 80, unit: 'unité', label: 'Pose miroir LED' },
                    'pose_armoire_toilette': { price: 100, unit: 'unité', label: 'Pose armoire de toilette' },
                    'pose_seche_serviettes_eau': { price: 200, unit: 'unité', label: 'Pose sèche-serviettes eau chaude' },
                    'pose_seche_serviettes_electrique': { price: 150, unit: 'unité', label: 'Pose sèche-serviettes électrique' },
                    'pose_seche_serviettes_mixte': { price: 250, unit: 'unité', label: 'Pose sèche-serviettes mixte' },
                    'pose_vmc_salle_bain': { price: 250, unit: 'unité', label: 'Pose VMC salle de bain' },
                    'pose_extracteur_air': { price: 120, unit: 'unité', label: 'Pose extracteur d\'air' },
                    'pose_spot_salle_bain': { price: 80, unit: 'unité', label: 'Pose spot salle de bain IP44' },
                    'pose_reglette_led_miroir': { price: 90, unit: 'unité', label: 'Pose réglette LED miroir' }
                }
            },
            
            cuisine: {
                title: "🍳 Cuisine",
                services: {
                    'pose_cuisine_lineaire': { price: 400, unit: 'ml', label: 'Pose cuisine linéaire standard' },
                    'pose_cuisine_angle': { price: 550, unit: 'jour', label: 'Pose cuisine en L ou U' },
                    'pose_cuisine_ilot': { price: 750, unit: 'jour', label: 'Pose cuisine avec îlot central' },
                    'pose_cuisine_americaine': { price: 650, unit: 'jour', label: 'Pose cuisine américaine ouverte' },
                    'pose_meuble_bas_standard': { price: 50, unit: 'unité', label: 'Pose meuble bas standard' },
                    'pose_meuble_bas_evier': { price: 80, unit: 'unité', label: 'Pose meuble bas évier' },
                    'pose_meuble_haut': { price: 60, unit: 'unité', label: 'Pose meuble haut' },
                    'pose_meuble_angle': { price: 100, unit: 'unité', label: 'Pose meuble d\'angle' },
                    'pose_colonne_standard': { price: 80, unit: 'unité', label: 'Pose colonne standard' },
                    'pose_colonne_four': { price: 120, unit: 'unité', label: 'Pose colonne four/frigo' },
                    'pose_ilot_central': { price: 200, unit: 'unité', label: 'Pose îlot central' },
                    'pose_bar_american': { price: 150, unit: 'ml', label: 'Pose bar américain' },
                    'pose_fileur_joue': { price: 30, unit: 'unité', label: 'Pose fileur/joue' },
                    'pose_plan_travail_droit_stratifie': { price: 150, unit: 'ml', label: 'Plan de travail stratifié droit' },
                    'pose_plan_travail_angle_stratifie': { price: 200, unit: 'ml', label: 'Plan de travail stratifié angle' },
                    'pose_plan_travail_quartz': { price: 350, unit: 'ml', label: 'Plan de travail quartz' },
                    'pose_plan_travail_granit': { price: 400, unit: 'ml', label: 'Plan de travail granit' },
                    'pose_plan_travail_bois': { price: 250, unit: 'ml', label: 'Plan de travail bois massif' },
                    'pose_plan_travail_inox': { price: 300, unit: 'ml', label: 'Plan de travail inox' },
                    'decoupe_plan_travail': { price: 50, unit: 'découpe', label: 'Découpe plan de travail' },
                    'pose_credence_carrelage': { price: 50, unit: 'm²', label: 'Crédence carrelage' },
                    'pose_credence_verre': { price: 70, unit: 'm²', label: 'Crédence verre trempé' },
                    'pose_credence_inox': { price: 80, unit: 'm²', label: 'Crédence inox' },
                    'pose_credence_composite': { price: 65, unit: 'm²', label: 'Crédence composite' },
                    'pose_evier_1_bac': { price: 150, unit: 'unité', label: 'Pose évier 1 bac' },
                    'pose_evier_2_bacs': { price: 200, unit: 'unité', label: 'Pose évier 2 bacs' },
                    'pose_evier_sous_plan': { price: 250, unit: 'unité', label: 'Pose évier sous plan' },
                    'pose_evier_granit': { price: 300, unit: 'unité', label: 'Pose évier granit/résine' },
                    'pose_robinet_cuisine_standard': { price: 80, unit: 'unité', label: 'Robinet cuisine standard' },
                    'pose_mitigeur_douchette': { price: 100, unit: 'unité', label: 'Mitigeur avec douchette' },
                    'pose_robinet_3_voies': { price: 150, unit: 'unité', label: 'Robinet 3 voies (eau filtrée)' },
                    'pose_plaque_cuisson_gaz': { price: 80, unit: 'unité', label: 'Plaque cuisson gaz' },
                    'pose_plaque_cuisson_electrique': { price: 80, unit: 'unité', label: 'Plaque cuisson électrique' },
                    'pose_plaque_induction': { price: 100, unit: 'unité', label: 'Plaque induction' },
                    'pose_four_encastrable': { price: 80, unit: 'unité', label: 'Four encastrable' },
                    'pose_four_vapeur': { price: 120, unit: 'unité', label: 'Four vapeur' },
                    'pose_micro_ondes_encastrable': { price: 60, unit: 'unité', label: 'Micro-ondes encastrable' },
                    'pose_lave_vaisselle': { price: 80, unit: 'unité', label: 'Lave-vaisselle encastrable' },
                    'pose_lave_linge_encastrable': { price: 100, unit: 'unité', label: 'Lave-linge encastrable' },
                    'pose_refrigerateur_encastrable': { price: 100, unit: 'unité', label: 'Réfrigérateur encastrable' },
                    'pose_cave_vin': { price: 120, unit: 'unité', label: 'Cave à vin encastrable' },
                    'pose_hotte_standard': { price: 150, unit: 'unité', label: 'Hotte aspirante standard' },
                    'pose_hotte_decorative': { price: 200, unit: 'unité', label: 'Hotte décorative' },
                    'pose_hotte_plafond': { price: 250, unit: 'unité', label: 'Hotte plafond' },
                    'pose_hotte_integree': { price: 180, unit: 'unité', label: 'Hotte intégrée meuble' },
                    'raccordement_gaz_cuisine': { price: 150, unit: 'unité', label: 'Raccordement gaz cuisine' },
                    'evacuation_hotte': { price: 120, unit: 'forfait', label: 'Évacuation hotte extérieure' },
                    'eclairage_sous_meuble': { price: 80, unit: 'ml', label: 'Éclairage LED sous meuble' }
                }
            },
            
            menuiserie: {
                title: "🚪 Menuiseries",
                services: {
                    'pose_porte_interieure_standard': { price: 150, unit: 'unité', label: 'Porte intérieure standard' },
                    'pose_porte_postformee': { price: 180, unit: 'unité', label: 'Porte postformée' },
                    'pose_porte_bois_massif': { price: 250, unit: 'unité', label: 'Porte bois massif' },
                    'pose_porte_vitre': { price: 200, unit: 'unité', label: 'Porte avec vitrage' },
                    'pose_porte_coulissante_standard': { price: 225, unit: 'unité', label: 'Porte coulissante standard' },
                    'pose_porte_coulissante_galandage': { price: 350, unit: 'unité', label: 'Porte coulissante galandage' },
                    'pose_porte_coulissante_suspendue': { price: 300, unit: 'unité', label: 'Porte coulissante suspendue' },
                    'pose_porte_pliante': { price: 200, unit: 'unité', label: 'Porte pliante/accordéon' },
                    'pose_porte_blindee': { price: 450, unit: 'unité', label: 'Porte blindée' },
                    'pose_porte_coupe_feu': { price: 350, unit: 'unité', label: 'Porte coupe-feu' },
                    'pose_porte_entree_pvc': { price: 450, unit: 'unité', label: 'Porte d\'entrée PVC' },
                    'pose_porte_entree_alu': { price: 500, unit: 'unité', label: 'Porte d\'entrée aluminium' },
                    'pose_porte_entree_bois': { price: 400, unit: 'unité', label: 'Porte d\'entrée bois' },
                    'pose_porte_entree_acier': { price: 380, unit: 'unité', label: 'Porte d\'entrée acier' },
                    'pose_porte_garage_sectionnelle': { price: 600, unit: 'unité', label: 'Porte garage sectionnelle' },
                    'pose_porte_garage_basculante': { price: 500, unit: 'unité', label: 'Porte garage basculante' },
                    'pose_porte_garage_enroulable': { price: 700, unit: 'unité', label: 'Porte garage enroulable' },
                    'pose_porte_garage_battante': { price: 550, unit: 'unité', label: 'Porte garage battante' },
                    'motorisation_porte_garage': { price: 300, unit: 'unité', label: 'Motorisation porte garage' },
                    'pose_fenetre_1_vantail_pvc': { price: 225, unit: 'unité', label: 'Fenêtre PVC 1 vantail' },
                    'pose_fenetre_2_vantaux_pvc': { price: 275, unit: 'unité', label: 'Fenêtre PVC 2 vantaux' },
                    'pose_fenetre_1_vantail_alu': { price: 300, unit: 'unité', label: 'Fenêtre alu 1 vantail' },
                    'pose_fenetre_2_vantaux_alu': { price: 350, unit: 'unité', label: 'Fenêtre alu 2 vantaux' },
                    'pose_fenetre_bois': { price: 280, unit: 'unité', label: 'Fenêtre bois' },
                    'pose_fenetre_mixte': { price: 320, unit: 'unité', label: 'Fenêtre mixte bois/alu' },
                    'pose_porte_fenetre_pvc': { price: 400, unit: 'unité', label: 'Porte-fenêtre PVC' },
                    'pose_porte_fenetre_alu': { price: 450, unit: 'unité', label: 'Porte-fenêtre alu' },
                    'pose_baie_vitree_coulissante': { price: 550, unit: 'unité', label: 'Baie vitrée coulissante' },
                    'pose_baie_vitree_galandage': { price: 800, unit: 'unité', label: 'Baie vitrée galandage' },
                    'pose_fenetre_toit_standard': { price: 550, unit: 'unité', label: 'Fenêtre de toit standard' },
                    'pose_fenetre_toit_motorisee': { price: 750, unit: 'unité', label: 'Fenêtre de toit motorisée' },
                    'pose_puits_lumiere': { price: 700, unit: 'unité', label: 'Puits de lumière' },
                    'pose_verriere_interieure': { price: 400, unit: 'm²', label: 'Verrière intérieure' },
                    'pose_verriere_exterieure': { price: 500, unit: 'm²', label: 'Verrière extérieure' },
                    'pose_volet_battant_bois': { price: 150, unit: 'unité', label: 'Volet battant bois' },
                    'pose_volet_battant_pvc': { price: 120, unit: 'unité', label: 'Volet battant PVC' },
                    'pose_volet_battant_alu': { price: 200, unit: 'unité', label: 'Volet battant alu' },
                    'pose_volet_roulant_manuel': { price: 300, unit: 'unité', label: 'Volet roulant manuel' },
                    'pose_volet_roulant_electrique': { price: 400, unit: 'unité', label: 'Volet roulant électrique' },
                    'pose_volet_roulant_solaire': { price: 500, unit: 'unité', label: 'Volet roulant solaire' },
                    'pose_store_interieur': { price: 115, unit: 'unité', label: 'Store intérieur' },
                    'pose_store_venitien': { price: 130, unit: 'unité', label: 'Store vénitien' },
                    'pose_store_banne_manuel': { price: 500, unit: 'unité', label: 'Store banne manuel' },
                    'pose_store_banne_motorise': { price: 750, unit: 'unité', label: 'Store banne motorisé' },
                    'pose_pergola_bois': { price: 150, unit: 'm²', label: 'Pergola bois' },
                    'pose_pergola_alu': { price: 200, unit: 'm²', label: 'Pergola aluminium' },
                    'pose_pergola_bioclimatique': { price: 350, unit: 'm²', label: 'Pergola bioclimatique' }
                }
            },
            
            chauffage: {
                title: "🔥 Chauffage/Climatisation",
                services: {
                    'pose_radiateur_electrique_convecteur': { price: 150, unit: 'unité', label: 'Radiateur électrique convecteur' },
                    'pose_radiateur_electrique_rayonnant': { price: 180, unit: 'unité', label: 'Radiateur électrique rayonnant' },
                    'pose_radiateur_inertie': { price: 250, unit: 'unité', label: 'Radiateur à inertie' },
                    'pose_radiateur_eau_chaude_fonte': { price: 250, unit: 'unité', label: 'Radiateur eau chaude fonte' },
                    'pose_radiateur_eau_chaude_acier': { price: 200, unit: 'unité', label: 'Radiateur eau chaude acier' },
                    'pose_radiateur_design': { price: 300, unit: 'unité', label: 'Radiateur design/décoratif' },
                    'pose_seche_serviettes_eau': { price: 200, unit: 'unité', label: 'Sèche-serviettes eau chaude' },
                    'pose_seche_serviettes_electrique': { price: 150, unit: 'unité', label: 'Sèche-serviettes électrique' },
                    'pose_seche_serviettes_mixte': { price: 250, unit: 'unité', label: 'Sèche-serviettes mixte' },
                    'pose_plancher_chauffant_electrique': { price: 75, unit: 'm²', label: 'Plancher chauffant électrique' },
                    'pose_plancher_chauffant_eau': { price: 85, unit: 'm²', label: 'Plancher chauffant eau chaude' },
                    'pose_plancher_rafraichissant': { price: 95, unit: 'm²', label: 'Plancher rafraîchissant' },
                    'pose_plafond_chauffant': { price: 80, unit: 'm²', label: 'Plafond chauffant rayonnant' },
                    'pose_poele_bois_standard': { price: 800, unit: 'unité', label: 'Poêle à bois standard' },
                    'pose_poele_bois_etanche': { price: 1000, unit: 'unité', label: 'Poêle à bois étanche' },
                    'pose_poele_granules_standard': { price: 1200, unit: 'unité', label: 'Poêle à granulés standard' },
                    'pose_poele_granules_etanche': { price: 1400, unit: 'unité', label: 'Poêle à granulés étanche' },
                    'pose_poele_mixte': { price: 1500, unit: 'unité', label: 'Poêle mixte bois/granulés' },
                    'pose_cuisiniere_bois': { price: 1200, unit: 'unité', label: 'Cuisinière à bois' },
                    'pose_insert_cheminee': { price: 800, unit: 'unité', label: 'Insert cheminée' },
                    'pose_foyer_ferme': { price: 1000, unit: 'unité', label: 'Foyer fermé' },
                    'pose_chaudiere_gaz_murale': { price: 1500, unit: 'unité', label: 'Chaudière gaz murale' },
                    'pose_chaudiere_gaz_sol': { price: 2000, unit: 'unité', label: 'Chaudière gaz sol' },
                    'pose_chaudiere_condensation': { price: 2500, unit: 'unité', label: 'Chaudière à condensation' },
                    'pose_chaudiere_fioul': { price: 2200, unit: 'unité', label: 'Chaudière fioul' },
                    'pose_chaudiere_electrique': { price: 1800, unit: 'unité', label: 'Chaudière électrique' },
                    'pose_chaudiere_bois': { price: 3000, unit: 'unité', label: 'Chaudière bois' },
                    'pose_chaudiere_granules': { price: 3500, unit: 'unité', label: 'Chaudière granulés' },
                    'entretien_chaudiere_gaz': { price: 120, unit: 'intervention', label: 'Entretien chaudière gaz' },
                    'entretien_chaudiere_fioul': { price: 150, unit: 'intervention', label: 'Entretien chaudière fioul' },
                    'entretien_poele_bois': { price: 80, unit: 'intervention', label: 'Entretien poêle à bois' },
                    'entretien_poele_granules': { price: 100, unit: 'intervention', label: 'Entretien poêle granulés' },
                    'ramonage_conduit': { price: 70, unit: 'intervention', label: 'Ramonage conduit' },
                    'tubage_conduit': { price: 150, unit: 'ml', label: 'Tubage conduit cheminée' },
                    'pose_conduit_exterieur': { price: 200, unit: 'ml', label: 'Conduit extérieur isolé' },
                    'controle_etancheite_gaz': { price: 85, unit: 'intervention', label: 'Contrôle étanchéité gaz' },
                    'desembouage_circuit': { price: 400, unit: 'intervention', label: 'Désembouage circuit' },
                    'purge_radiateurs': { price: 60, unit: 'intervention', label: 'Purge radiateurs' },
                    'reglage_chaudiere': { price: 90, unit: 'intervention', label: 'Réglage chaudière' },
                    'pose_thermostat_ambiance': { price: 150, unit: 'unité', label: 'Thermostat d\'ambiance' },
                    'pose_thermostat_connecte': { price: 200, unit: 'unité', label: 'Thermostat connecté' },
                    'pose_robinet_thermostatique': { price: 80, unit: 'unité', label: 'Robinet thermostatique' },
                    'pose_climatiseur_monosplit': { price: 650, unit: 'unité', label: 'Climatiseur monosplit' },
                    'pose_climatiseur_bisplit': { price: 1200, unit: 'unité', label: 'Climatiseur bisplit' },
                    'pose_climatiseur_multisplit': { price: 1500, unit: 'unité', label: 'Climatiseur multisplit' },
                    'pose_climatiseur_gainable': { price: 2000, unit: 'unité', label: 'Climatiseur gainable' },
                    'pose_pompe_chaleur_air_air': { price: 2250, unit: 'unité', label: 'Pompe à chaleur air/air' },
                    'pose_pompe_chaleur_air_eau': { price: 3500, unit: 'unité', label: 'Pompe à chaleur air/eau' },
                    'pose_pompe_chaleur_geothermie': { price: 8000, unit: 'unité', label: 'Pompe à chaleur géothermie' },
                    'mise_en_service_climatisation': { price: 225, unit: 'intervention', label: 'Mise en service climatisation' },
                    'entretien_annuel_climatisation': { price: 150, unit: 'intervention', label: 'Entretien annuel climatisation' },
                    'nettoyage_filtres_clim': { price: 80, unit: 'intervention', label: 'Nettoyage filtres climatisation' },
                    'recharge_gaz_clim': { price: 200, unit: 'intervention', label: 'Recharge gaz climatisation' },
                    'controle_pression_clim': { price: 60, unit: 'intervention', label: 'Contrôle pression climatisation' },
                    'desinfection_circuit_clim': { price: 120, unit: 'intervention', label: 'Désinfection circuit climatisation' }
                }
            },
            
            electricite: {
                title: "⚡ Électricité",
                services: {
                    'pose_prise_electrique_standard': { price: 65, unit: 'unité', label: 'Prise électrique 16A standard' },
                    'pose_prise_electrique_cuisine': { price: 75, unit: 'unité', label: 'Prise électrique 20A cuisine' },
                    'pose_prise_etanche': { price: 85, unit: 'unité', label: 'Prise étanche IP44/IP55' },
                    'pose_prise_usb': { price: 80, unit: 'unité', label: 'Prise USB intégrée' },
                    'pose_prise_rj45': { price: 70, unit: 'unité', label: 'Prise RJ45 informatique' },
                    'pose_prise_telephone': { price: 70, unit: 'unité', label: 'Prise téléphone' },
                    'pose_prise_tv_coaxiale': { price: 70, unit: 'unité', label: 'Prise TV coaxiale' },
                    'pose_interrupteur_simple': { price: 65, unit: 'unité', label: 'Interrupteur simple' },
                    'pose_interrupteur_double': { price: 75, unit: 'unité', label: 'Interrupteur double' },
                    'pose_interrupteur_variateur': { price: 85, unit: 'unité', label: 'Interrupteur variateur' },
                    'pose_interrupteur_tactile': { price: 120, unit: 'unité', label: 'Interrupteur tactile' },
                    'pose_interrupteur_connecte': { price: 150, unit: 'unité', label: 'Interrupteur connecté' },
                    'pose_va_et_vient': { price: 95, unit: 'unité', label: 'Va-et-vient' },
                    'pose_telerupteur': { price: 120, unit: 'unité', label: 'Télérupteur' },
                    'pose_minuterie': { price: 100, unit: 'unité', label: 'Minuterie d\'éclairage' },
                    'pose_detecteur_mouvement': { price: 100, unit: 'unité', label: 'Détecteur de mouvement' },
                    'pose_detecteur_crepusculaire': { price: 90, unit: 'unité', label: 'Détecteur crépusculaire' },
                    'pose_spot_encastre_fixe': { price: 50, unit: 'unité', label: 'Spot encastré fixe' },
                    'pose_spot_encastre_orientable': { price: 60, unit: 'unité', label: 'Spot encastré orientable' },
                    'pose_spot_led_dimmable': { price: 70, unit: 'unité', label: 'Spot LED dimmable' },
                    'pose_luminaire_plafonnier': { price: 60, unit: 'unité', label: 'Luminaire plafonnier' },
                    'pose_luminaire_suspendu': { price: 80, unit: 'unité', label: 'Luminaire suspendu' },
                    'pose_lustre': { price: 100, unit: 'unité', label: 'Lustre' },
                    'pose_applique_murale': { price: 70, unit: 'unité', label: 'Applique murale' },
                    'pose_applique_led_design': { price: 90, unit: 'unité', label: 'Applique LED design' },
                    'pose_ruban_led_transfo': { price: 40, unit: 'ml', label: 'Ruban LED + transformateur' },
                    'pose_neon_led': { price: 80, unit: 'unité', label: 'Néon LED' },
                    'pose_hublot_exterieur': { price: 90, unit: 'unité', label: 'Hublot extérieur' },
                    'pose_projecteur_led': { price: 120, unit: 'unité', label: 'Projecteur LED extérieur' },
                    'pose_tableau_electrique_1_rangee': { price: 400, unit: 'unité', label: 'Tableau électrique 1 rangée' },
                    'pose_tableau_electrique_2_rangees': { price: 600, unit: 'unité', label: 'Tableau électrique 2 rangées' },
                    'pose_tableau_electrique_3_rangees': { price: 800, unit: 'unité', label: 'Tableau électrique 3 rangées' },
                    'pose_tableau_electrique_4_rangees': { price: 1000, unit: 'unité', label: 'Tableau électrique 4 rangées' },
                    'pose_disjoncteur_differentiel': { price: 150, unit: 'unité', label: 'Disjoncteur différentiel' },
                    'pose_interrupteur_differentiel': { price: 80, unit: 'unité', label: 'Interrupteur différentiel' },
                    'pose_parafoudre': { price: 200, unit: 'unité', label: 'Parafoudre' },
                    'pose_compteur_divisionnaire': { price: 250, unit: 'unité', label: 'Compteur divisionnaire' },
                    'pose_contacteur_jour_nuit': { price: 120, unit: 'unité', label: 'Contacteur jour/nuit' },
                    'pose_delesteur': { price: 180, unit: 'unité', label: 'Délesteur' },
                    'pose_borne_recharge_ve_standard': { price: 800, unit: 'unité', label: 'Borne recharge VE 3,7kW' },
                    'pose_borne_recharge_ve_rapide': { price: 1200, unit: 'unité', label: 'Borne recharge VE 7,4kW' },
                    'pose_borne_recharge_ve_tri': { price: 1500, unit: 'unité', label: 'Borne recharge VE 11kW triphasée' },
                    'pose_antenne_tv': { price: 300, unit: 'unité', label: 'Pose antenne TV' },
                    'pose_parabole': { price: 350, unit: 'unité', label: 'Pose parabole satellite' },
                    'pose_amplificateur_tv': { price: 150, unit: 'unité', label: 'Amplificateur TV' },
                    'pose_alarme_filaire': { price: 800, unit: 'unité', label: 'Alarme filaire complète' },
                    'pose_alarme_sans_fil': { price: 1000, unit: 'unité', label: 'Alarme sans fil complète' },
                    'pose_camera_surveillance': { price: 200, unit: 'unité', label: 'Caméra surveillance' },
                    'pose_videophone': { price: 400, unit: 'unité', label: 'Visiophone' },
                    'pose_portier_video': { price: 300, unit: 'unité', label: 'Portier vidéo' },
                    'pose_domotique_eclairage': { price: 200, unit: 'point', label: 'Module domotique éclairage' },
                    'pose_domotique_volets': { price: 250, unit: 'point', label: 'Module domotique volets' },
                    'pose_domotique_chauffage': { price: 300, unit: 'zone', label: 'Module domotique chauffage' },
                    'diagnostic_electrique_complet': { price: 150, unit: 'intervention', label: 'Diagnostic électrique complet' },
                    'controle_installation_electrique': { price: 120, unit: 'intervention', label: 'Contrôle installation électrique' },
                    'verification_mise_terre': { price: 80, unit: 'intervention', label: 'Vérification mise à la terre' },
                    'test_disjoncteurs_differentiel': { price: 60, unit: 'intervention', label: 'Test disjoncteurs différentiel' },
                    'mesure_isolement': { price: 90, unit: 'intervention', label: 'Mesure isolement' },
                    'controle_prise_terre': { price: 70, unit: 'intervention', label: 'Contrôle prise de terre' },
                    'verification_tableau_electrique': { price: 100, unit: 'intervention', label: 'Vérification tableau électrique' },
                    'recherche_defaut_electrique': { price: 130, unit: 'intervention', label: 'Recherche défaut électrique' },
                    'controle_conformite_nfc15100': { price: 180, unit: 'intervention', label: 'Contrôle conformité NFC 15-100' },
                    'remise_aux_normes_tableau': { price: 300, unit: 'intervention', label: 'Remise aux normes tableau' },
                    'mise_conformite_salle_bain': { price: 200, unit: 'intervention', label: 'Mise conformité salle de bain' },
                    'ajout_protection_differentielle': { price: 120, unit: 'intervention', label: 'Ajout protection différentielle' },
                    'mise_terre_installation': { price: 250, unit: 'intervention', label: 'Mise à la terre installation' },
                    'creation_point_lumineux': { price: 80, unit: 'unité', label: 'Création point lumineux' },
                    'deplacement_point_lumineux': { price: 100, unit: 'unité', label: 'Déplacement point lumineux' }
                }
            },
            
            plomberie: {
                title: "🔧 Plomberie",
                services: {
                    'remplacement_robinet_simple': { price: 150, unit: 'unité', label: 'Remplacement robinet simple' },
                    'remplacement_mitigeur_lavabo': { price: 180, unit: 'unité', label: 'Remplacement mitigeur lavabo' },
                    'remplacement_mitigeur_douche': { price: 200, unit: 'unité', label: 'Remplacement mitigeur douche' },
                    'remplacement_mitigeur_cuisine': { price: 220, unit: 'unité', label: 'Remplacement mitigeur cuisine' },
                    'remplacement_groupe_securite': { price: 150, unit: 'unité', label: 'Remplacement groupe sécurité' },
                    'remplacement_siphon_lavabo': { price: 80, unit: 'unité', label: 'Remplacement siphon lavabo' },
                    'remplacement_siphon_evier': { price: 90, unit: 'unité', label: 'Remplacement siphon évier' },
                    'remplacement_flexible_wc': { price: 60, unit: 'unité', label: 'Remplacement flexible WC' },
                    'remplacement_flexible_douche': { price: 50, unit: 'unité', label: 'Remplacement flexible douche' },
                    'remplacement_vase_expansion': { price: 200, unit: 'unité', label: 'Remplacement vase expansion' },
                    'remplacement_flotteur_wc': { price: 90, unit: 'unité', label: 'Remplacement flotteur WC' },
                    'remplacement_mecanisme_chasse': { price: 120, unit: 'unité', label: 'Remplacement mécanisme chasse' },
                    'remplacement_joint_chasse': { price: 40, unit: 'unité', label: 'Remplacement joint chasse eau' },
                    'pose_vanne_arret': { price: 100, unit: 'unité', label: 'Pose vanne d\'arrêt' },
                    'pose_reducteur_pression': { price: 150, unit: 'unité', label: 'Pose réducteur pression' },
                    'pose_clapet_anti_retour': { price: 120, unit: 'unité', label: 'Pose clapet anti-retour' },
                    'pose_disconnecteur': { price: 180, unit: 'unité', label: 'Pose disconnecteur' },
                    'pose_detendeur_gaz': { price: 80, unit: 'unité', label: 'Pose détendeur gaz' },
                    'creation_point_eau': { price: 250, unit: 'unité', label: 'Création point d\'eau' },
                    'deplacement_point_eau': { price: 300, unit: 'unité', label: 'Déplacement point d\'eau' },
                    'pose_nourrice_plomberie': { price: 200, unit: 'unité', label: 'Pose nourrice plomberie' },
                    'pose_compteur_eau': { price: 150, unit: 'unité', label: 'Pose compteur d\'eau' },
                    'pose_collecteur_chauffage': { price: 180, unit: 'unité', label: 'Pose collecteur chauffage' },
                    'installation_adoucisseur': { price: 500, unit: 'unité', label: 'Installation adoucisseur eau' },
                    'installation_osmoseur': { price: 300, unit: 'unité', label: 'Installation osmoseur' },
                    'installation_filtre_eau': { price: 200, unit: 'unité', label: 'Installation filtre eau' },
                    'pose_chauffe_eau_100l': { price: 400, unit: 'unité', label: 'Chauffe-eau électrique 100L' },
                    'pose_chauffe_eau_200l': { price: 450, unit: 'unité', label: 'Chauffe-eau électrique 200L' },
                    'pose_chauffe_eau_300l': { price: 500, unit: 'unité', label: 'Chauffe-eau électrique 300L' },
                    'pose_chauffe_eau_thermodynamique': { price: 1000, unit: 'unité', label: 'Chauffe-eau thermodynamique' },
                    'pose_chauffe_eau_gaz': { price: 600, unit: 'unité', label: 'Chauffe-eau gaz' },
                    'pose_chauffe_eau_solaire': { price: 2000, unit: 'unité', label: 'Chauffe-eau solaire' },
                    'debouchage_simple': { price: 225, unit: 'intervention', label: 'Débouchage simple' },
                    'debouchage_haute_pression': { price: 350, unit: 'intervention', label: 'Débouchage haute pression' },
                    'debouchage_wc': { price: 180, unit: 'intervention', label: 'Débouchage WC' },
                    'debouchage_douche': { price: 200, unit: 'intervention', label: 'Débouchage douche/baignoire' },
                    'detection_fuite': { price: 300, unit: 'intervention', label: 'Détection fuite' },
                    'detection_fuite_camera': { price: 450, unit: 'intervention', label: 'Détection fuite caméra' },
                    'reparation_fuite': { price: 250, unit: 'intervention', label: 'Réparation fuite' },
                    'recherche_fuite_enterree': { price: 400, unit: 'intervention', label: 'Recherche fuite enterrée' },
                    'colmatage_fuite_urgence': { price: 180, unit: 'intervention', label: 'Colmatage fuite urgence' },
                    'detartrage_circuit_eau_chaude': { price: 200, unit: 'intervention', label: 'Détartrage circuit eau chaude' },
                    'rincage_circuit_chauffage': { price: 180, unit: 'intervention', label: 'Rinçage circuit chauffage' },
                    'controle_pression_circuit': { price: 80, unit: 'intervention', label: 'Contrôle pression circuit' },
                    'test_etancheite_reseau': { price: 120, unit: 'intervention', label: 'Test étanchéité réseau' },
                    'nettoyage_bac_graisse': { price: 150, unit: 'intervention', label: 'Nettoyage bac à graisse' },
                    'curage_evacuation': { price: 200, unit: 'intervention', label: 'Curage évacuation' },
                    'inspection_camera_canalisation': { price: 250, unit: 'intervention', label: 'Inspection caméra canalisation' },
                    'hydrocurage_canalisation': { price: 300, unit: 'intervention', label: 'Hydrocurage canalisation' },
                    'traitement_anti_calcaire': { price: 160, unit: 'intervention', label: 'Traitement anti-calcaire' },
                    'vidange_chauffe_eau': { price: 150, unit: 'intervention', label: 'Vidange chauffe-eau' },
                    'detartrage_chauffe_eau': { price: 180, unit: 'intervention', label: 'Détartrage chauffe-eau' },
                    'controle_groupe_securite': { price: 70, unit: 'intervention', label: 'Contrôle groupe sécurité' },
                    'controle_anode_magnesium': { price: 90, unit: 'intervention', label: 'Contrôle anode magnésium' },
                    'entretien_adoucisseur': { price: 120, unit: 'intervention', label: 'Entretien adoucisseur eau' },
                    'regeneration_adoucisseur': { price: 80, unit: 'intervention', label: 'Régénération adoucisseur' },
                    'changement_cartouche_osmoseur': { price: 60, unit: 'intervention', label: 'Changement cartouche osmoseur' }
                }
            },
            
            peinture: {
                title: "🎨 Peinture/Décoration",
                services: {
                    'peinture_murs_standard': { price: 32, unit: 'm²', label: 'Peinture murs standard' },
                    'peinture_murs_lessivable': { price: 38, unit: 'm²', label: 'Peinture murs lessivable' },
                    'peinture_murs_anti_tache': { price: 45, unit: 'm²', label: 'Peinture murs anti-tâche' },
                    'peinture_plafond_standard': { price: 38, unit: 'm²', label: 'Peinture plafond standard' },
                    'peinture_plafond_mat': { price: 35, unit: 'm²', label: 'Peinture plafond mat' },
                    'peinture_plafond_anti_condensation': { price: 48, unit: 'm²', label: 'Peinture plafond anti-condensation' },
                    'peinture_boiseries_lasure': { price: 45, unit: 'ml', label: 'Peinture/lasure boiseries' },
                    'peinture_portes_interieures': { price: 80, unit: 'unité', label: 'Peinture portes intérieures' },
                    'peinture_radiateur': { price: 80, unit: 'unité', label: 'Peinture radiateur' },
                    'peinture_facade_exterieure': { price: 55, unit: 'm²', label: 'Peinture façade extérieure' },
                    'peinture_volets_bois': { price: 120, unit: 'unité', label: 'Peinture volets bois' },
                    'pose_papier_peint_standard': { price: 28, unit: 'm²', label: 'Pose papier peint standard' },
                    'pose_papier_peint_intisse': { price: 35, unit: 'm²', label: 'Pose papier peint intissé' },
                    'pose_papier_peint_vinyle': { price: 40, unit: 'm²', label: 'Pose papier peint vinyle' },
                    'depose_papier_peint': { price: 12, unit: 'm²', label: 'Dépose papier peint' },
                    'decollage_papier_peint': { price: 15, unit: 'm²', label: 'Décollage papier peint ancien' },
                    'enduit_lissage': { price: 18, unit: 'm²', label: 'Enduit lissage' },
                    'enduit_decoratif': { price: 35, unit: 'm²', label: 'Enduit décoratif' },
                    'enduit_chaux': { price: 45, unit: 'm²', label: 'Enduit à la chaux' },
                    'enduit_tadelakt': { price: 85, unit: 'm²', label: 'Enduit tadelakt' },
                    'pose_toile_verre': { price: 22, unit: 'm²', label: 'Pose toile de verre' },
                    'pose_fibre_verre': { price: 25, unit: 'm²', label: 'Pose fibre de verre' },
                    'pose_plaquettes_parement': { price: 55, unit: 'm²', label: 'Pose plaquettes parement' },
                    'pose_lambris_pvc': { price: 35, unit: 'm²', label: 'Pose lambris PVC' },
                    'pose_lambris_bois': { price: 45, unit: 'm²', label: 'Pose lambris bois' },
                    'pose_frise_decorative': { price: 15, unit: 'ml', label: 'Pose frise décorative' },
                    'pose_beton_cire_murs': { price: 115, unit: 'm²', label: 'Pose béton ciré murs' },
                    'pose_beton_cire_sol': { price: 95, unit: 'm²', label: 'Pose béton ciré sol' },
                    'pose_moulure_plafond': { price: 20, unit: 'ml', label: 'Pose moulure plafond' },
                    'pose_corniche_polyurethane': { price: 18, unit: 'ml', label: 'Pose corniche polyuréthane' },
                    'pose_rosace': { price: 50, unit: 'unité', label: 'Pose rosace plafond' },
                    'patine_meuble': { price: 150, unit: 'unité', label: 'Patine meuble' },
                    'lasure_protection_bois': { price: 40, unit: 'm²', label: 'Lasure protection bois' },
                    'vitrificateur_parquet': { price: 25, unit: 'm²', label: 'Vitrificateur parquet' },
                    'preparation_support': { price: 15, unit: 'm²', label: 'Préparation support' },
                    'lessivage_murs': { price: 8, unit: 'm²', label: 'Lessivage murs' },
                    'rebouchage_fissures': { price: 12, unit: 'ml', label: 'Rebouchage fissures' }
                }
            },
            
            isolation: {
                title: "🏠 Isolation/Cloisons",
                services: {
                    'isolation_combles_perdus_laine': { price: 30, unit: 'm²', label: 'Isolation combles perdus laine' },
                    'isolation_combles_perdus_ouate': { price: 35, unit: 'm²', label: 'Isolation combles perdus ouate' },
                    'isolation_combles_amenageables': { price: 45, unit: 'm²', label: 'Isolation combles aménageables' },
                    'isolation_murs_interieurs_laine': { price: 55, unit: 'm²', label: 'Isolation murs intérieurs laine' },
                    'isolation_murs_interieurs_polystyrene': { price: 45, unit: 'm²', label: 'Isolation murs intérieurs polystyrène' },
                    'isolation_murs_exterieurs_ite': { price: 120, unit: 'm²', label: 'Isolation murs extérieurs ITE' },
                    'isolation_sol_polyurethane': { price: 35, unit: 'm²', label: 'Isolation sol polyuréthane' },
                    'isolation_sol_polystyrene': { price: 30, unit: 'm²', label: 'Isolation sol polystyrène' },
                    'isolation_phonique_cloison': { price: 50, unit: 'm²', label: 'Isolation phonique cloison' },
                    'isolation_phonique_plafond': { price: 55, unit: 'm²', label: 'Isolation phonique plafond' },
                    'pose_cloison_placo_ba13': { price: 40, unit: 'm²', label: 'Cloison placo BA13 standard' },
                    'pose_cloison_ba13_phonique': { price: 55, unit: 'm²', label: 'Cloison BA13 phonique' },
                    'pose_cloison_hydrofuge': { price: 45, unit: 'm²', label: 'Cloison hydrofuge' },
                    'pose_cloison_coupe_feu': { price: 65, unit: 'm²', label: 'Cloison coupe-feu' },
                    'pose_cloison_demontable': { price: 75, unit: 'm²', label: 'Cloison démontable bureau' },
                    'pose_faux_plafond_ba13': { price: 55, unit: 'm²', label: 'Faux plafond BA13' },
                    'pose_faux_plafond_suspendu': { price: 65, unit: 'm²', label: 'Faux plafond suspendu' },
                    'pose_faux_plafond_dalles': { price: 45, unit: 'm²', label: 'Faux plafond dalles' },
                    'creation_ouverture_cloison': { price: 200, unit: 'unité', label: 'Création ouverture cloison' },
                    'rebouchage_ouverture': { price: 150, unit: 'unité', label: 'Rebouchage ouverture' },
                    'pose_porte_cloison': { price: 150, unit: 'unité', label: 'Pose porte cloison' },
                    'pose_trappe_acces': { price: 120, unit: 'unité', label: 'Pose trappe d\'accès' },
                    'doublage_mur_polystyrene': { price: 35, unit: 'm²', label: 'Doublage mur polystyrène' },
                    'doublage_mur_laine': { price: 40, unit: 'm²', label: 'Doublage mur laine minérale' },
                    'membrane_etanche': { price: 25, unit: 'm²', label: 'Pose membrane étanche' },
                    'pare_vapeur': { price: 8, unit: 'm²', label: 'Pose pare-vapeur' }
                }
            },
            
            exterieur: {
                title: "🌳 Aménagement Extérieur",
                services: {
                    'pose_terrasse_bois_exotique': { price: 120, unit: 'm²', label: 'Terrasse bois exotique' },
                    'pose_terrasse_bois_autoclave': { price: 90, unit: 'm²', label: 'Terrasse bois autoclavé' },
                    'pose_terrasse_composite_standard': { price: 115, unit: 'm²', label: 'Terrasse composite standard' },
                    'pose_terrasse_composite_haut_gamme': { price: 145, unit: 'm²', label: 'Terrasse composite haut de gamme' },
                    'pose_structure_terrasse': { price: 35, unit: 'm²', label: 'Structure terrasse lambourdes' },
                    'pose_carrelage_exterieur_standard': { price: 72, unit: 'm²', label: 'Carrelage extérieur standard' },
                    'pose_carrelage_exterieur_2cm': { price: 85, unit: 'm²', label: 'Carrelage extérieur 2cm' },
                    'pose_dalle_pierre_naturelle': { price: 95, unit: 'm²', label: 'Dalle pierre naturelle' },
                    'pose_dalle_beton': { price: 45, unit: 'm²', label: 'Dalle béton' },
                    'pose_dalle_plot': { price: 65, unit: 'm²', label: 'Dalle sur plot' },
                    'pose_pave_beton': { price: 65, unit: 'm²', label: 'Pavé béton' },
                    'pose_pave_pierre': { price: 95, unit: 'm²', label: 'Pavé pierre' },
                    'pose_pave_autobloquant': { price: 55, unit: 'm²', label: 'Pavé autobloquant' },
                    'pose_beton_desactive': { price: 85, unit: 'm²', label: 'Béton désactivé' },
                    'pose_beton_imprime': { price: 95, unit: 'm²', label: 'Béton imprimé' },
                    'pose_enrobe': { price: 45, unit: 'm²', label: 'Enrobé' },
                    'pose_gravier_decoratif': { price: 25, unit: 'm²', label: 'Gravier décoratif' },
                    'pose_gravier_stabilise': { price: 35, unit: 'm²', label: 'Gravier stabilisé' },
                    'pose_gazon_synthetique': { price: 45, unit: 'm²', label: 'Gazon synthétique' },
                    'preparation_terrain': { price: 15, unit: 'm²', label: 'Préparation terrain' },
                    'pose_bordure_beton': { price: 25, unit: 'ml', label: 'Bordure béton' },
                    'pose_bordure_pierre': { price: 35, unit: 'ml', label: 'Bordure pierre' },
                    'pose_bordure_metal': { price: 30, unit: 'ml', label: 'Bordure métal' },
                    'pose_cloture_rigide_standard': { price: 85, unit: 'ml', label: 'Clôture rigide standard' },
                    'pose_cloture_rigide_haute': { price: 120, unit: 'ml', label: 'Clôture rigide haute sécurité' },
                    'pose_cloture_souple': { price: 40, unit: 'ml', label: 'Clôture souple' },
                    'pose_grillage_simple': { price: 35, unit: 'ml', label: 'Grillage simple torsion' },
                    'pose_grillage_soudé': { price: 45, unit: 'ml', label: 'Grillage soudé' },
                    'pose_brise_vue_pvc': { price: 25, unit: 'ml', label: 'Brise-vue PVC' },
                    'pose_brise_vue_naturel': { price: 35, unit: 'ml', label: 'Brise-vue naturel' },
                    'pose_claustra_bois': { price: 80, unit: 'ml', label: 'Claustra bois' },
                    'pose_claustra_composite': { price: 95, unit: 'ml', label: 'Claustra composite' },
                    'pose_claustra_alu': { price: 120, unit: 'ml', label: 'Claustra aluminium' },
                    'pose_portail_battant_alu': { price: 600, unit: 'unité', label: 'Portail battant alu' },
                    'pose_portail_battant_fer': { price: 550, unit: 'unité', label: 'Portail battant fer forgé' },
                    'pose_portail_coulissant_alu': { price: 800, unit: 'unité', label: 'Portail coulissant alu' },
                    'pose_portail_coulissant_fer': { price: 750, unit: 'unité', label: 'Portail coulissant fer' },
                    'motorisation_portail_battant': { price: 600, unit: 'unité', label: 'Motorisation portail battant' },
                    'motorisation_portail_coulissant': { price: 800, unit: 'unité', label: 'Motorisation portail coulissant' },
                    'pose_portillon_alu': { price: 250, unit: 'unité', label: 'Portillon alu' },
                    'pose_portillon_fer': { price: 300, unit: 'unité', label: 'Portillon fer forgé' },
                    'pose_pilier_beton': { price: 150, unit: 'unité', label: 'Pilier béton' },
                    'pose_pilier_pierre': { price: 250, unit: 'unité', label: 'Pilier pierre' },
                    'installation_arrosage_automatique': { price: 45, unit: 'm²', label: 'Arrosage automatique' },
                    'pose_recuperateur_eau_300l': { price: 150, unit: 'unité', label: 'Récupérateur eau 300L' },
                    'pose_recuperateur_eau_1000l': { price: 300, unit: 'unité', label: 'Récupérateur eau 1000L' },
                    'montage_abri_jardin_5m2': { price: 400, unit: 'unité', label: 'Abri jardin <5m²' },
                    'montage_abri_jardin_10m2': { price: 550, unit: 'unité', label: 'Abri jardin 5-10m²' },
                    'montage_abri_jardin_20m2': { price: 850, unit: 'unité', label: 'Abri jardin 10-20m²' },
                    'montage_carport_simple': { price: 600, unit: 'unité', label: 'Carport simple' },
                    'montage_carport_double': { price: 1000, unit: 'unité', label: 'Carport double' },
                    'montage_serre_jardin': { price: 400, unit: 'unité', label: 'Serre jardin' },
                    'installation_robot_tondeuse': { price: 400, unit: 'unité', label: 'Installation robot tondeuse' },
                    'pose_eclairage_jardin_spot': { price: 80, unit: 'point', label: 'Éclairage jardin spot' },
                    'pose_eclairage_jardin_borne': { price: 120, unit: 'point', label: 'Éclairage jardin borne' },
                    'creation_massif_fleurs': { price: 45, unit: 'm²', label: 'Création massif fleurs' },
                    'plantation_haie': { price: 25, unit: 'ml', label: 'Plantation haie' },
                    'elagage_arbre': { price: 300, unit: 'unité', label: 'Élagage arbre' },
                    'abattage_arbre': { price: 500, unit: 'unité', label: 'Abattage arbre' },
                    'pose_liner_piscine': { price: 65, unit: 'm²', label: 'Pose liner piscine' },
                    'pose_margelle_piscine': { price: 85, unit: 'ml', label: 'Pose margelle piscine' },
                    'pose_pompe_piscine': { price: 600, unit: 'unité', label: 'Pose pompe piscine' },
                    'pose_filtre_piscine': { price: 400, unit: 'unité', label: 'Pose filtre piscine' },
                    'pose_pompe_chaleur_piscine': { price: 800, unit: 'unité', label: 'Pose pompe chaleur piscine' },
                    'pose_robot_piscine': { price: 150, unit: 'unité', label: 'Installation robot piscine' },
                    'pose_couverture_piscine_barres': { price: 150, unit: 'm²', label: 'Couverture piscine barres' },
                    'pose_bache_piscine': { price: 80, unit: 'm²', label: 'Bâche piscine' },
                    'pose_volet_roulant_piscine': { price: 250, unit: 'm²', label: 'Volet roulant piscine' },
                    'pose_alarme_piscine': { price: 300, unit: 'unité', label: 'Alarme piscine' },
                    'hivernage_piscine': { price: 400, unit: 'intervention', label: 'Hivernage piscine' },
                    'remise_en_route_piscine': { price: 350, unit: 'intervention', label: 'Remise en route piscine' },
                    'nettoyage_piscine': { price: 80, unit: 'intervention', label: 'Nettoyage piscine' }
                }
            },
            
            ventilation: {
                title: "💨 Ventilation",
                services: {
                    'pose_vmc_simple_flux': { price: 600, unit: 'unité', label: 'VMC simple flux' },
                    'pose_vmc_double_flux': { price: 1500, unit: 'unité', label: 'VMC double flux' },
                    'pose_vmc_hygroreglable_a': { price: 700, unit: 'unité', label: 'VMC hygro A' },
                    'pose_vmc_hygroreglable_b': { price: 800, unit: 'unité', label: 'VMC hygro B' },
                    'pose_vmc_thermodynamique': { price: 2000, unit: 'unité', label: 'VMC thermodynamique' },
                    'pose_extracteur_sdb': { price: 150, unit: 'unité', label: 'Extracteur salle de bain' },
                    'pose_extracteur_wc': { price: 120, unit: 'unité', label: 'Extracteur WC' },
                    'pose_extracteur_cuisine': { price: 180, unit: 'unité', label: 'Extracteur cuisine' },
                    'pose_bouche_vmc_extraction': { price: 50, unit: 'unité', label: 'Bouche VMC extraction' },
                    'pose_bouche_vmc_insufflation': { price: 55, unit: 'unité', label: 'Bouche VMC insufflation' },
                    'pose_bouche_hygro': { price: 65, unit: 'unité', label: 'Bouche hygroréglable' },
                    'pose_gaine_vmc_isolee': { price: 35, unit: 'ml', label: 'Gaine VMC isolée' },
                    'pose_gaine_vmc_standard': { price: 30, unit: 'ml', label: 'Gaine VMC standard' },
                    'pose_silencieux_vmc': { price: 120, unit: 'unité', label: 'Silencieux VMC' },
                    'pose_aerateur_fenetre': { price: 80, unit: 'unité', label: 'Aérateur fenêtre' },
                    'pose_grille_ventilation': { price: 40, unit: 'unité', label: 'Grille ventilation' },
                    'nettoyage_vmc_complet': { price: 180, unit: 'intervention', label: 'Nettoyage VMC complet' },
                    'nettoyage_bouches_vmc': { price: 80, unit: 'intervention', label: 'Nettoyage bouches VMC' },
                    'nettoyage_gaines_vmc': { price: 120, unit: 'intervention', label: 'Nettoyage gaines VMC' },
                    'controle_debit_vmc': { price: 90, unit: 'intervention', label: 'Contrôle débit VMC' },
                    'changement_filtres_vmc': { price: 60, unit: 'intervention', label: 'Changement filtres VMC' },
                    'reglage_vmc': { price: 70, unit: 'intervention', label: 'Réglage VMC' },
                    'controle_moteur_vmc': { price: 85, unit: 'intervention', label: 'Contrôle moteur VMC' },
                    'entretien_annuel_vmc': { price: 150, unit: 'intervention', label: 'Entretien annuel VMC' }
                }
            },
            
            depannage: {
                title: "🚨 Dépannage/Urgence",
                services: {
                    'deplacement_jour': { price: 60, unit: 'intervention', label: 'Déplacement jour' },
                    'deplacement_soir_weekend': { price: 90, unit: 'intervention', label: 'Déplacement soir/weekend' },
                    'deplacement_nuit_ferie': { price: 120, unit: 'intervention', label: 'Déplacement nuit/férié' },
                    'main_oeuvre_plomberie': { price: 75, unit: 'heure', label: 'Main d\'œuvre plomberie' },
                    'main_oeuvre_electricite': { price: 75, unit: 'heure', label: 'Main d\'œuvre électricité' },
                    'main_oeuvre_chauffage': { price: 85, unit: 'heure', label: 'Main d\'œuvre chauffage' },
                    'main_oeuvre_climatisation': { price: 85, unit: 'heure', label: 'Main d\'œuvre climatisation' },
                    'main_oeuvre_serrurerie': { price: 100, unit: 'heure', label: 'Main d\'œuvre serrurerie' },
                    'main_oeuvre_vitrerie': { price: 85, unit: 'heure', label: 'Main d\'œuvre vitrerie' },
                    'main_oeuvre_electromenager': { price: 70, unit: 'heure', label: 'Main d\'œuvre électroménager' },
                    'main_oeuvre_jardin': { price: 60, unit: 'heure', label: 'Main d\'œuvre jardin' },
                    'diagnostic_panne': { price: 80, unit: 'intervention', label: 'Diagnostic panne' },
                    'devis_reparation': { price: 0, unit: 'gratuit', label: 'Devis réparation gratuit' },
                    'urgence_24h': { price: 150, unit: 'majoration', label: 'Majoration urgence 24h' },
                    'intervention_dimanche': { price: 100, unit: 'majoration', label: 'Majoration dimanche' },
                    'intervention_ferie': { price: 120, unit: 'majoration', label: 'Majoration jour férié' }
                }
            }
        };

        // Variables globales
        let currentMonth = new Date();
        let selectedDate = null;
        let selectedTime = null;
        let chatMessages = [];
        let currentQuote = null; // Stocker le devis actuel

        // Variables Stripe
        let stripeCustomerId = null;
        let stripePaymentLink = null;

        // Initialisation
        document.addEventListener('DOMContentLoaded', function() {
            populateCategories();
            generateCalendar();
            initAnimations();
            initScrollEffects();
            updateTimeSlots();
        });

        // Remplir les catégories du calculateur
        function populateCategories() {
            const select = document.getElementById('serviceCategory');
            select.innerHTML = '<option value="">Sélectionnez une catégorie</option>';
            Object.keys(completePricingGrid).forEach(key => {
                const option = document.createElement('option');
                option.value = key;
                option.textContent = completePricingGrid[key].title;
                select.appendChild(option);
            });
        }

        // Mise à jour des services en fonction de la catégorie
        function updateServiceOptions() {
            const categoryKey = document.getElementById('serviceCategory').value;
            const specificService = document.getElementById('specificService');
            
            specificService.innerHTML = '<option value="">Choisissez un service</option>';
            
            if (categoryKey && completePricingGrid[categoryKey]) {
                const services = completePricingGrid[categoryKey].services;
                Object.keys(services).forEach(key => {
                    const service = services[key];
                    const option = document.createElement('option');
                    option.value = key;
                    option.dataset.category = categoryKey;
                    option.textContent = `${service.label} - ${service.price}€/${service.unit}`;
                    specificService.appendChild(option);
                });
            }
            updateQuoteSteps(2);
        }

        // Calcul du devis complet
        function calculateQuote() {
            const categoryKey = document.getElementById('serviceCategory').value;
            const serviceKey = document.getElementById('specificService').value;
            const quantity = parseFloat(document.getElementById('quantity').value) || 0;
            const postalCode = document.getElementById('postalCode').value;
            const urgency = document.getElementById('urgency').value;
            const zone = document.getElementById('zone').value;

            if (!categoryKey || !serviceKey || !quantity) {
                showNotification('Veuillez remplir tous les champs obligatoires', 'warning');
                return;
            }

            const service = completePricingGrid[categoryKey].services[serviceKey];
            if (!service) return;

            // Calcul du prix de base
            let basePrice = service.price * quantity;

            // Ajustement selon la zone
            let zoneMultiplier = 1;
            if (zone === 'urbaine') zoneMultiplier = 1.2;
            else if (zone === 'rurale') zoneMultiplier = 1.1;

            // Ajustement selon l'urgence
            let urgencyMultiplier = 1;
            if (urgency === 'soir') urgencyMultiplier = 1.5;
            else if (urgency === 'ferie') urgencyMultiplier = 2;
            else if (urgency === 'urgence') urgencyMultiplier = 2.2;

            // Prix avec ajustements
            const adjustedPrice = basePrice * zoneMultiplier * urgencyMultiplier;

            // TVA (10% pour travaux de rénovation)
            const tvaRate = 0.10;
            const priceHT = adjustedPrice;
            const tvaAmount = priceHT * tvaRate;
            const priceTTC = priceHT + tvaAmount;

            // Frais de déplacement
            let deplacement = 60;
            if (postalCode) {
                if (postalCode.startsWith('22')) deplacement = 30;
                else if (postalCode.startsWith('35') || postalCode.startsWith('29') || postalCode.startsWith('56')) deplacement = 60;
                else deplacement = 80;
            }

            // Total final
            const total = priceTTC + deplacement;

            // Affichage détaillé
            displayQuoteResult(service, quantity, priceHT, tvaAmount, deplacement, total, urgency, zone);
            updateQuoteSteps(4);
        }

        // Affichage du résultat de devis
        function displayQuoteResult(service, quantity, priceHT, tvaAmount, deplacement, total, urgency, zone) {
            // Stocker le devis actuel pour le paiement
            currentQuote = {
                service: service,
                quantity: quantity,
                priceHT: priceHT,
                tvaAmount: tvaAmount,
                deplacement: deplacement,
                total: total,
                urgency: urgency,
                zone: zone,
                depositAmount: Math.round(total * 0.30 * 100) / 100, // 30% d'acompte
                remainingAmount: Math.round(total * 0.70 * 100) / 100
            };

            const breakdown = document.getElementById('quoteBreakdown');
            const urgencyText = {
                'normal': '',
                'soir': ' (Soir/Weekend +50%)',
                'ferie': ' (Jours fériés +100%)',
                'urgence': ' (Urgence 24h/24 +120%)'
            }[urgency];
            
            const zoneText = {
                'standard': '',
                'urbaine': ' (Zone urbaine +20%)',
                'rurale': ' (Zone rurale +10%)'
            }[zone];

            breakdown.innerHTML = `
                <div style="background: var(--gray-light); padding: 20px; border-radius: var(--radius); margin-bottom: 20px;">
                    <h4 style="color: var(--primary); margin-bottom: 10px;">📋 Détail du Devis</h4>
                    <p><strong>Service :</strong> ${service.label}</p>
                    <p><strong>Quantité :</strong> ${quantity} ${service.unit}</p>
                    ${urgencyText ? `<p><strong>Type :</strong>${urgencyText}</p>` : ''}
                    ${zoneText ? `<p><strong>Zone :</strong>${zoneText}</p>` : ''}
                </div>
                
                <div class="quote-line">
                    <span>💰 Prix de base (${quantity} ${service.unit})</span>
                    <span>${priceHT.toFixed(2)}€ HT</span>
                </div>
                <div class="quote-line">
                    <span>📊 TVA (10%)</span>
                    <span>${tvaAmount.toFixed(2)}€</span>
                </div>
                <div class="quote-line">
                    <span>🚗 Déplacement</span>
                    <span>${deplacement}€</span>
                </div>
                <div class="quote-line quote-total">
                    <span>✨ Total TTC</span>
                    <span>${total.toFixed(2)}€</span>
                </div>
                
                <div style="margin-top: 20px; padding: 15px; background: rgba(37, 99, 235, 0.1); border-radius: var(--radius); font-size: 0.9rem; color: var(--gray);">
                    <p>✅ <strong>Garanties incluses :</strong> Garantie décennale, Assurance RC Pro</p>
                    <p>🔧 <strong>Services inclus :</strong> Devis gratuit, Conseils personnalisés, Nettoyage fin de chantier</p>
                    <p>💳 <strong>Modalités :</strong> Acompte de 30% à la commande, solde à la réception des travaux</p>
                </div>
            `;
            
            document.getElementById('quoteResult').style.display = 'block';
            showNotification('Devis calculé avec succès !', 'success');
        }

        // Gestion des étapes du devis
        function updateQuoteSteps(activeStep) {
            const steps = document.querySelectorAll('.quote-step');
            steps.forEach((step, index) => {
                if (index + 1 <= activeStep) {
                    step.classList.add('active');
                } else {
                    step.classList.remove('active');
                }
            });
        }

        // Actions sur le devis
        function validateQuote() {
            if (!currentQuote) {
                showNotification('Aucun devis calculé à réserver', 'error');
                return;
            }
            
            // Préparer la section RDV avec les informations du devis
            showNotification('Redirection vers la prise de rendez-vous...', 'success');
            
            setTimeout(() => {
                document.getElementById('rdv').scrollIntoView({ behavior: 'smooth' });
                
                // Afficher le résumé du devis dans la section RDV
                const quoteSummary = document.getElementById('selectedQuoteSummary');
                const quoteSummaryContent = document.getElementById('quoteSummaryContent');
                
                quoteSummaryContent.innerHTML = `
                    <div style="display: grid; grid-template-columns: 2fr 1fr; gap: 20px; align-items: center;">
                        <div>
                            <h5 style="color: var(--primary); margin-bottom: 5px;">${currentQuote.service.label}</h5>
                            <p style="margin: 0; color: var(--gray);">${currentQuote.quantity} ${currentQuote.service.unit}</p>
                        </div>
                        <div style="text-align: right;">
                            <div style="font-size: 1.5rem; font-weight: 700; color: var(--primary);">${currentQuote.total.toFixed(2)}€ TTC</div>
                            <div style="font-size: 0.9rem; color: var(--gray);">Acompte: ${currentQuote.depositAmount.toFixed(2)}€</div>
                        </div>
                    </div>
                `;
                
                quoteSummary.style.display = 'block';
                
                showNotification('Choisissez votre créneau pour finaliser', 'info');
            }, 1000);
        }

        function modifyQuote() {
            document.getElementById('quoteResult').style.display = 'none';
            document.getElementById('selectedQuoteSummary').style.display = 'none';
            document.getElementById('finalPaymentSection').style.display = 'none';
            updateQuoteSteps(1);
            showNotification('Vous pouvez modifier votre devis', 'info');
        }

        function sendQuoteByEmail() {
            const email = prompt('Votre adresse email :');
            if (email && email.includes('@')) {
                showNotification('Devis envoyé par email !', 'success');
            } else if (email) {
                showNotification('Adresse email invalide', 'error');
            }
        }

        // === NOUVELLES FONCTIONS RDV AVEC PAIEMENT ===

        function preparePaymentConfirmation() {
            if (!selectedDate || !selectedTime) {
                showNotification('Veuillez sélectionner une date et un créneau', 'warning');
                return;
            }
            
            if (!currentQuote) {
                showNotification('Aucun devis sélectionné', 'error');
                return;
            }
            
            const form = document.getElementById('appointmentForm');
            const inputs = form.querySelectorAll('input, textarea');
            let isValid = true;
            
            // Vérifier les champs obligatoires (nom, téléphone, email)
            const requiredFields = ['rdvCustomerName', 'rdvCustomerPhone', 'rdvCustomerEmail'];
            requiredFields.forEach(fieldId => {
                const field = document.getElementById(fieldId);
                if (!field.value.trim()) {
                    isValid = false;
                    field.style.borderColor = 'var(--danger)';
                } else {
                    field.style.borderColor = '';
                }
            });
            
            // Vérification email
            const email = document.getElementById('rdvCustomerEmail').value;
            if (email && (!email.includes('@') || !email.includes('.'))) {
                isValid = false;
                document.getElementById('rdvCustomerEmail').style.borderColor = 'var(--danger)';
                showNotification('Format email invalide', 'warning');
                return;
            }
            
            if (!isValid) {
                showNotification('Veuillez remplir tous les champs obligatoires', 'warning');
                return;
            }
            
            // Préparer la section de paiement final
            showFinalPaymentSection();
        }

        function showFinalPaymentSection() {
            const finalPaymentSection = document.getElementById('finalPaymentSection');
            const customerName = document.getElementById('rdvCustomerName').value;
            const customerEmail = document.getElementById('rdvCustomerEmail').value;
            const customerPhone = document.getElementById('rdvCustomerPhone').value;
            const customerAddress = document.getElementById('rdvCustomerAddress').value;
            const projectDescription = document.getElementById('rdvProjectDescription').value;
            
            // Mettre à jour les montants
            document.getElementById('finalDepositAmount').textContent = currentQuote.depositAmount.toFixed(2) + '€';
            document.getElementById('finalRemainingAmount').textContent = currentQuote.remainingAmount.toFixed(2) + '€';
            
            // Mettre à jour les montants dynamiques pour le bouton
            document.getElementById('dynamicDepositDisplay').textContent = currentQuote.depositAmount.toFixed(2) + '€';
            document.getElementById('buttonDepositAmount').textContent = currentQuote.depositAmount.toFixed(2) + '€';
            
            // Résumé complet de la réservation
            const bookingSummary = document.getElementById('finalBookingSummary');
            bookingSummary.innerHTML = `
                <div style="display: grid; gap: 15px;">
                    <div style="display: flex; justify-content: space-between;">
                        <strong>👤 Client:</strong>
                        <span>${customerName}</span>
                    </div>
                    <div style="display: flex; justify-content: space-between;">
                        <strong>📞 Contact:</strong>
                        <span>${customerPhone}</span>
                    </div>
                    <div style="display: flex; justify-content: space-between;">
                        <strong>📅 Date:</strong>
                        <span>${selectedDate.toLocaleDateString('fr-FR')}</span>
                    </div>
                    <div style="display: flex; justify-content: space-between;">
                        <strong>🕐 Heure:</strong>
                        <span>${selectedTime}</span>
                    </div>
                    <div style="display: flex; justify-content: space-between;">
                        <strong>🔧 Service:</strong>
                        <span>${currentQuote.service.label}</span>
                    </div>
                    <div style="display: flex; justify-content: space-between;">
                        <strong>💰 Total:</strong>
                        <span style="color: var(--primary); font-weight: 700;">${currentQuote.total.toFixed(2)}€ TTC</span>
                    </div>
                    ${projectDescription ? `
                    <div style="margin-top: 15px; padding-top: 15px; border-top: 1px solid rgba(0,0,0,0.1);">
                        <strong>📝 Projet:</strong><br>
                        <em>${projectDescription}</em>
                    </div>
                    ` : ''}
                </div>
            `;
            
            // Afficher la section et scroll
            finalPaymentSection.style.display = 'block';
            document.getElementById('confirmAppointmentBtn').style.display = 'none';
            
            finalPaymentSection.scrollIntoView({ behavior: 'smooth' });
            showNotification('Vérifiez vos informations et procédez au paiement', 'info');
        }

        // === NOUVELLE FONCTION PAIEMENT DYNAMIQUE ===
        
        async function initiateStripePayment() {
            if (!currentQuote) {
                showNotification('Erreur: aucun devis disponible', 'error');
                return;
            }

            const customerName = document.getElementById('rdvCustomerName').value;
            const customerEmail = document.getElementById('rdvCustomerEmail').value;
            const customerPhone = document.getElementById('rdvCustomerPhone').value;
            const depositAmount = currentQuote.depositAmount;

            // Préparation des données pour le paiement
            const paymentData = {
                amount: Math.round(depositAmount * 100), // Montant en centimes
                currency: 'eur',
                customer_name: customerName,
                customer_email: customerEmail,
                customer_phone: customerPhone,
                service_description: currentQuote.service.label,
                quantity: currentQuote.quantity,
                unit: currentQuote.service.unit,
                appointment_date: selectedDate.toISOString(),
                appointment_time: selectedTime,
                total_amount: currentQuote.total
            };

            const dynamicPayButton = document.getElementById('dynamicPayButton');
            dynamicPayButton.disabled = true;
            dynamicPayButton.innerHTML = '<span class="loading" style="border-color: var(--accent);"></span> Préparation du paiement...';

            try {
                // SOLUTION 1: Redirection vers une page de paiement personnalisée (recommandée)
                const paymentUrl = await createDynamicPaymentLink(paymentData);
                
                showNotification('Redirection vers le paiement sécurisé...', 'success');
                
                // Redirection vers la page de paiement
                window.open(paymentUrl, '_blank');
                
                // Ou redirection dans la même fenêtre :
                // window.location.href = paymentUrl;
                
            } catch (error) {
                console.error('Erreur paiement dynamique:', error);
                
                // FALLBACK: Utiliser le bouton Stripe fixe
                showNotification('Utilisation du paiement alternatif...', 'warning');
                document.getElementById('stripeButtonFallback').style.display = 'block';
                dynamicPayButton.style.display = 'none';
            } finally {
                dynamicPayButton.disabled = false;
                dynamicPayButton.innerHTML = `🔒 Payer l'Acompte de ${depositAmount.toFixed(2)}€`;
            }
        }

        async function createDynamicPaymentLink(paymentData) {
            // Construire l'URL vers votre page de paiement personnalisée
            const paymentPageUrl = 'payment.html'; // Votre page de paiement
            const params = new URLSearchParams({
                amount: paymentData.amount, // en centimes
                currency: paymentData.currency,
                customer_name: encodeURIComponent(paymentData.customer_name),
                customer_email: encodeURIComponent(paymentData.customer_email),
                customer_phone: encodeURIComponent(paymentData.customer_phone),
                service_description: encodeURIComponent(paymentData.service_description),
                quantity: paymentData.quantity,
                unit: encodeURIComponent(paymentData.unit),
                appointment_date: paymentData.appointment_date,
                appointment_time: encodeURIComponent(paymentData.appointment_time),
                total_amount: paymentData.total_amount * 100, // total en centimes
                return_url: encodeURIComponent(window.location.origin + '/payment-success.html'),
                cancel_url: encodeURIComponent(window.location.href)
            });
            
            return `${paymentPageUrl}?${params.toString()}`;
        }

        // === SOLUTIONS ALTERNATIVES ===
        
        // Solution avec boutons multiples selon tranches de prix
        function getAppropriatePriceButton(amount) {
            // Créer plusieurs boutons Stripe pour différentes tranches
            const priceRanges = {
                50: 'buy_btn_50euros',      // 0-100€
                100: 'buy_btn_100euros',    // 100-200€  
                200: 'buy_btn_200euros',    // 200-400€
                500: 'buy_btn_500euros',    // 400-800€
                1000: 'buy_btn_1000euros'   // 800€+
            };
            
            let selectedButton = 'buy_btn_1S1CPKE9izJSj8K74gSK6a9p'; // défaut
            
            for (const [threshold, buttonId] of Object.entries(priceRanges)) {
                if (amount <= parseInt(threshold)) {
                    selectedButton = buttonId;
                    break;
                }
            }
            
            return selectedButton;
        }

        async function processPaymentAndConfirm() {
            if (!currentQuote || !selectedDate || !selectedTime) {
                showNotification('Informations de réservation incomplètes', 'error');
                return;
            }

            const finalPayButton = document.getElementById('finalPayButton');
            const loading = document.getElementById('finalPaymentLoading');
            
            // État de chargement
            finalPayButton.disabled = true;
            loading.style.display = 'inline-block';
            finalPayButton.innerHTML = '<span class="loading" style="border-color: var(--accent);"></span> Traitement du paiement...';

            try {
                const customerName = document.getElementById('rdvCustomerName').value;
                const customerEmail = document.getElementById('rdvCustomerEmail').value;

                // Simulation du processus de paiement Stripe
                showNotification('Connexion sécurisée à Stripe...', 'info');
                await new Promise(resolve => setTimeout(resolve, 1000));
                
                showNotification('Traitement du paiement...', 'info');
                await createStripeCustomer(customerName, customerEmail);
                await new Promise(resolve => setTimeout(resolve, 800));
                
                await createStripeProduct(
                    `Acompte 30% - ${currentQuote.service.label}`,
                    `Réservation du ${selectedDate.toLocaleDateString('fr-FR')} à ${selectedTime}`
                );
                await new Promise(resolve => setTimeout(resolve, 600));
                
                await createStripePrice(Math.round(currentQuote.depositAmount * 100));
                await createStripePaymentLink();
                
                // Simulation succès
                await new Promise(resolve => setTimeout(resolve, 1200));
                
                showNotification('Paiement confirmé !', 'success');
                showPaymentAndBookingSuccess();

            } catch (error) {
                console.error('Erreur paiement:', error);
                showNotification('Erreur lors du traitement du paiement', 'error');
            } finally {
                finalPayButton.disabled = false;
                loading.style.display = 'none';
                finalPayButton.innerHTML = '💳 Payer l\'Acompte et Confirmer';
            }
        }

        function cancelFinalPayment() {
            document.getElementById('finalPaymentSection').style.display = 'none';
            document.getElementById('confirmAppointmentBtn').style.display = 'block';
            showNotification('Retour aux informations de contact', 'info');
        }

        function showPaymentAndBookingSuccess() {
            const modal = document.createElement('div');
            modal.style.cssText = `
                position: fixed;
                top: 0;
                left: 0;
                right: 0;
                bottom: 0;
                background: rgba(0,0,0,0.9);
                display: flex;
                align-items: center;
                justify-content: center;
                z-index: 1002;
                animation: fadeIn 0.3s ease-out;
            `;
            
            const customerName = document.getElementById('rdvCustomerName').value;
            
            modal.innerHTML = `
                <div style="background: white; border-radius: var(--radius-lg); padding: 50px; max-width: 600px; text-align: center; animation: slideUp 0.3s ease-out;">
                    <div style="font-size: 5rem; margin-bottom: 20px;">🎉</div>
                    <h2 style="color: var(--accent); margin-bottom: 15px;">Réservation Confirmée!</h2>
                    <p style="color: var(--gray); margin-bottom: 30px; font-size: 1.1rem;">
                        Merci ${customerName} ! Votre acompte de <strong>${currentQuote.depositAmount.toFixed(2)}€</strong> a été traité avec succès.
                    </p>
                    
                    <div style="background: var(--gray-light); padding: 25px; border-radius: var(--radius); margin-bottom: 30px; text-align: left;">
                        <h4 style="color: var(--primary); margin-bottom: 15px;">📅 Détails de votre intervention</h4>
                        <div style="display: grid; gap: 10px;">
                            <div><strong>Date:</strong> ${selectedDate.toLocaleDateString('fr-FR', { weekday: 'long', year: 'numeric', month: 'long', day: 'numeric' })}</div>
                            <div><strong>Heure:</strong> ${selectedTime}</div>
                            <div><strong>Service:</strong> ${currentQuote.service.label}</div>
                            <div><strong>Montant total:</strong> ${currentQuote.total.toFixed(2)}€ TTC</div>
                            <div><strong>Solde restant:</strong> ${currentQuote.remainingAmount.toFixed(2)}€ (à réception)</div>
                        </div>
                    </div>
                    
                    <div style="background: rgba(16, 185, 129, 0.1); padding: 20px; border-radius: var(--radius); margin-bottom: 25px;">
                        <h4 style="color: var(--accent); margin-bottom: 10px;">✅ Prochaines étapes</h4>
                        <div style="text-align: left; color: var(--gray);">
                            <p>1. <strong>Confirmation par email</strong> dans les 5 minutes</p>
                            <p>2. <strong>Appel de notre équipe</strong> sous 2h pour finaliser</p>
                            <p>3. <strong>SMS de rappel</strong> 24h avant l'intervention</p>
                            <p>4. <strong>Intervention à domicile</strong> le jour convenu</p>
                        </div>
                    </div>
                    
                    <div style="display: flex; gap: 15px; justify-content: center;">
                        <button onclick="this.parentElement.parentElement.parentElement.remove(); resetBookingForm();" class="btn btn-primary">
                            ✅ Parfait !
                        </button>
                        <a href="tel:0611203741" class="btn btn-secondary">
                            📞 Nous contacter
                        </a>
                    </div>
                </div>
            `;
            
            document.body.appendChild(modal);
            
            // Reset après fermeture
            setTimeout(() => {
                resetBookingForm();
            }, 5000);
        }

        function resetBookingForm() {
            // Réinitialiser toutes les données
            selectedDate = null;
            selectedTime = null;
            currentQuote = null;
            
            // Cacher les sections
            document.getElementById('selectedQuoteSummary').style.display = 'none';
            document.getElementById('finalPaymentSection').style.display = 'none';
            document.getElementById('appointmentForm').classList.remove('active');
            document.getElementById('confirmAppointmentBtn').style.display = 'block';
            
            // Vider les formulaires
            document.querySelectorAll('#appointmentForm input, #appointmentForm textarea').forEach(input => {
                input.value = '';
                input.style.borderColor = '';
            });
            
            // Réinitialiser le calendrier
            document.querySelectorAll('.calendar-day.selected').forEach(d => d.classList.remove('selected'));
            document.querySelectorAll('.time-slot.selected').forEach(s => s.classList.remove('selected'));
            
            updateTimeSlots();
        }

        // Génération du calendrier
        function generateCalendar() {
            const calendar = document.getElementById('calendar');
            calendar.innerHTML = '';
            
            const year = currentMonth.getFullYear();
            const month = currentMonth.getMonth();
            
            // Mettre à jour l'affichage du mois
            document.getElementById('currentMonth').textContent = currentMonth.toLocaleDateString('fr-FR', { 
                month: 'long', 
                year: 'numeric' 
            });
            
            // Jours de la semaine
            const weekDays = ['L', 'M', 'M', 'J', 'V', 'S', 'D'];
            weekDays.forEach(day => {
                const dayEl = document.createElement('div');
                dayEl.className = 'calendar-weekday';
                dayEl.textContent = day;
                calendar.appendChild(dayEl);
            });
            
            // Premier jour du mois et nombre de jours
            const firstDay = new Date(year, month, 1);
            const lastDay = new Date(year, month + 1, 0);
            const daysInMonth = lastDay.getDate();
            const startingDayOfWeek = (firstDay.getDay() + 6) % 7; // Lundi = 0
            
            // Cases vides pour aligner le premier jour
            for (let i = 0; i < startingDayOfWeek; i++) {
                const emptyDay = document.createElement('div');
                calendar.appendChild(emptyDay);
            }
            
            const today = new Date();
            
            // Jours du mois
            for (let day = 1; day <= daysInMonth; day++) {
                const dayEl = document.createElement('div');
                dayEl.className = 'calendar-day';
                dayEl.textContent = day;
                
                const currentDate = new Date(year, month, day);
                
                // Marquer aujourd'hui
                if (currentDate.toDateString() === today.toDateString()) {
                    dayEl.classList.add('today');
                }
                
                // Désactiver les jours passés
                if (currentDate < today) {
                    dayEl.classList.add('unavailable');
                } else {
                    dayEl.onclick = () => selectDay(dayEl, day);
                    
                    // Simuler quelques jours indisponibles
                    if (day % 7 === 0 || day === 15 || day === 23) {
                        dayEl.classList.add('unavailable');
                        dayEl.onclick = null;
                    }
                }
                
                calendar.appendChild(dayEl);
            }
        }

        // Navigation du calendrier
        function previousMonth() {
            currentMonth.setMonth(currentMonth.getMonth() - 1);
            generateCalendar();
        }

        function nextMonth() {
            currentMonth.setMonth(currentMonth.getMonth() + 1);
            generateCalendar();
        }

        // Sélection d'un jour
        function selectDay(element, day) {
            if (element.classList.contains('unavailable')) return;
            
            document.querySelectorAll('.calendar-day').forEach(d => {
                d.classList.remove('selected');
            });
            element.classList.add('selected');
            selectedDate = new Date(currentMonth.getFullYear(), currentMonth.getMonth(), day);
            
            updateTimeSlots();
        }

        // Mise à jour des créneaux horaires
        function updateTimeSlots() {
            const timeSlots = document.getElementById('timeSlots');
            const slots = [
                '09:00 - 10:00',
                '10:00 - 11:00', 
                '11:00 - 12:00',
                '14:00 - 15:00',
                '15:00 - 16:00',
                '16:00 - 17:00',
                '17:00 - 18:00'
            ];
            
            timeSlots.innerHTML = '';
            
            slots.forEach((slot, index) => {
                const slotEl = document.createElement('div');
                slotEl.className = 'time-slot';
                
                // Simuler quelques créneaux indisponibles
                const unavailable = Math.random() < 0.3;
                if (unavailable) {
                    slotEl.classList.add('unavailable');
                    slotEl.innerHTML = `${slot} ❌`;
                } else {
                    slotEl.innerHTML = `${slot} ✅`;
                    slotEl.onclick = () => selectTime(slotEl, slot);
                }
                
                timeSlots.appendChild(slotEl);
            });
        }

        // Sélection d'un créneau
        function selectTime(element, time) {
            if (element.classList.contains('unavailable')) return;
            
            document.querySelectorAll('.time-slot').forEach(slot => {
                slot.classList.remove('selected');
            });
            element.classList.add('selected');
            selectedTime = time;
            
            // Afficher le formulaire de contact
            const form = document.getElementById('appointmentForm');
            form.classList.add('active');
        }

        // Confirmation du rendez-vous - OBSOLÈTE, remplacée par preparePaymentConfirmation
        function confirmAppointment() {
            // Cette fonction est maintenant gérée par le nouveau flux
            preparePaymentConfirmation();
        }

        // Fonctions Stripe (conservées pour la simulation)
        async function createStripeCustomer(name, email) {
            try {
                showNotification('Création du profil client...', 'info');
                stripeCustomerId = 'cus_simulation_' + Date.now();
                console.log('Client créé:', stripeCustomerId);
            } catch (error) {
                throw new Error('Erreur création client: ' + error.message);
            }
        }

        async function createStripeProduct(name, description) {
            try {
                showNotification('Création du produit...', 'info');
                console.log('Produit créé:', name);
            } catch (error) {
                throw new Error('Erreur création produit: ' + error.message);
            }
        }

        async function createStripePrice(amountCents) {
            try {
                showNotification('Configuration du prix...', 'info');
                console.log('Prix créé:', amountCents + ' centimes');
            } catch (error) {
                throw new Error('Erreur création prix: ' + error.message);
            }
        }

        async function createStripePaymentLink() {
            try {
                showNotification('Génération du lien de paiement...', 'info');
                stripePaymentLink = 'https://buy.stripe.com/7sY00je3p0Te4Nlaue3oA03' + Date.now();
                console.log('Lien de paiement créé:', stripePaymentLink);
            } catch (error) {
                throw new Error('Erreur création lien: ' + error.message);
            }
        }

        // Chat fonctionnalités
        function toggleChat() {
            const chatWindow = document.getElementById('chatWindow');
            chatWindow.classList.toggle('active');
            
            if (chatWindow.classList.contains('active')) {
                // Supprimer la notification
                const badge = document.querySelector('.notification-badge');
                if (badge) badge.style.display = 'none';
                
                // Focus sur l'input
                setTimeout(() => {
                    document.getElementById('chatInput').focus();
                }, 300);
            }
        }

        function sendMessage() {
            const input = document.getElementById('chatInput');
            const message = input.value.trim();
            
            if (!message) return;
            
            addChatMessage(message, 'user');
            input.value = '';
            
            // Simuler la frappe
            showTyping();
            
            // Réponse automatique
            setTimeout(() => {
                hideTyping();
                const responses = [
                    "Merci pour votre message ! Un conseiller va vous répondre rapidement.",
                    "Je peux vous aider à obtenir un devis gratuit. Voulez-vous que je vous redirige ?",
                    "Pour une intervention d'urgence, appelez directement le 06 11 20 37 41.",
                    "Nos équipes interviennent dans toute la Bretagne. Dans quelle ville êtes-vous ?",
                    "Je peux programmer un rendez-vous gratuit pour vous. Souhaitez-vous prendre rendez-vous ?"
                ];
                const randomResponse = responses[Math.floor(Math.random() * responses.length)];
                addChatMessage(randomResponse, 'bot');
            }, 1500 + Math.random() * 1000);
        }

        function addChatMessage(message, sender) {
            const messagesContainer = document.getElementById('chatMessages');
            const messageEl = document.createElement('div');
            messageEl.className = `chat-message ${sender}`;
            messageEl.textContent = message;
            
            messagesContainer.appendChild(messageEl);
            messagesContainer.scrollTop = messagesContainer.scrollHeight;
            
            chatMessages.push({ message, sender, timestamp: new Date() });
        }

        function showTyping() {
            document.getElementById('chatTyping').classList.add('active');
            const messagesContainer = document.getElementById('chatMessages');
            messagesContainer.scrollTop = messagesContainer.scrollHeight;
        }

        function hideTyping() {
            document.getElementById('chatTyping').classList.remove('active');
        }

        function handleChatKeypress(event) {
            if (event.key === 'Enter') {
                sendMessage();
            }
        }

        function quickAction(action) {
            const actions = {
                'devis': 'Je souhaite obtenir un devis gratuit pour mes travaux.',
                'rdv': 'Je voudrais prendre rendez-vous pour une visite gratuite.',
                'urgence': 'J\'ai besoin d\'une intervention d\'urgence.',
                'services': 'Pouvez-vous me présenter vos services ?'
            };
            
            if (actions[action]) {
                addChatMessage(actions[action], 'user');
                
                showTyping();
                setTimeout(() => {
                    hideTyping();
                    let response = '';
                    switch(action) {
                        case 'devis':
                            response = 'Parfait ! Utilisez notre calculateur de devis instantané ci-dessus ou je peux vous rediriger vers un conseiller.';
                            break;
                        case 'rdv':
                            response = 'Excellente idée ! Vous pouvez réserver directement en ligne ou appeler le 06 11 20 37 41.';
                            break;
                        case 'urgence':
                            response = 'Pour les urgences 24h/24, appelez immédiatement le 06 11 20 37 41. Nous intervenons rapidement !';
                            break;
                        case 'services':
                            response = 'Nous proposons plus de 600 prestations : plomberie, électricité, chauffage, rénovation complète... Que recherchez-vous ?';
                            break;
                    }
                    addChatMessage(response, 'bot');
                }, 1000);
            }
        }

        // Menu mobile
        function toggleMobileMenu() {
            const mobileNav = document.getElementById('mobileNav');
            mobileNav.classList.toggle('active');
        }

        // Effets de scroll et animations
        function initScrollEffects() {
            window.addEventListener('scroll', () => {
                const header = document.getElementById('header');
                if (window.scrollY > 50) {
                    header.classList.add('scrolled');
                } else {
                    header.classList.remove('scrolled');
                }
            });
        }

        function initAnimations() {
            // Animation des compteurs
            const animateCounters = () => {
                const counters = document.querySelectorAll('[data-count]');
                counters.forEach(counter => {
                    const target = parseInt(counter.dataset.count);
                    const duration = 2000;
                    const start = 0;
                    const increment = target / (duration / 16);
                    let current = start;
                    
                    const timer = setInterval(() => {
                        current += increment;
                        if (current >= target) {
                            counter.textContent = target + (target === 15 ? '' : '+');
                            clearInterval(timer);
                        } else {
                            counter.textContent = Math.floor(current) + (target === 15 ? '' : '+');
                        }
                    }, 16);
                });
            };
            
            // Observer pour déclencher les animations
            const observer = new IntersectionObserver((entries) => {
                entries.forEach(entry => {
                    if (entry.isIntersecting) {
                        if (entry.target.classList.contains('stats-section')) {
                            animateCounters();
                        }
                    }
                });
            }, { threshold: 0.5 });
            
            document.querySelectorAll('.stats-section').forEach(section => {
                observer.observe(section);
            });
        }

        // Smooth scroll pour les liens d'ancre
        document.querySelectorAll('a[href^="#"]').forEach(anchor => {
            anchor.addEventListener('click', function (e) {
                e.preventDefault();
                const target = document.querySelector(this.getAttribute('href'));
                if (target) {
                    target.scrollIntoView({
                        behavior: 'smooth',
                        block: 'start'
                    });
                }
            });
        });

        // Système de notifications
        function showNotification(message, type = 'info') {
            const notification = document.createElement('div');
            notification.className = `notification ${type}`;
            notification.style.cssText = `
                position: fixed;
                top: 100px;
                right: 20px;
                background: ${type === 'success' ? 'var(--accent)' : type === 'error' ? 'var(--danger)' : type === 'warning' ? 'var(--warning)' : 'var(--primary)'};
                color: white;
                padding: 15px 25px;
                border-radius: var(--radius);
                box-shadow: var(--shadow-lg);
                z-index: 1001;
                font-weight: 500;
                max-width: 300px;
                animation: slideIn 0.3s ease-out;
            `;
            notification.textContent = message;
            
            document.body.appendChild(notification);
            
            setTimeout(() => {
                notification.style.animation = 'slideOut 0.3s ease-in forwards';
                setTimeout(() => {
                    document.body.removeChild(notification);
                }, 300);
            }, 3000);
        }

        // Styles pour les animations de notification
        const style = document.createElement('style');
        style.textContent = `
            @keyframes slideIn {
                from { transform: translateX(100%); opacity: 0; }
                to { transform: translateX(0); opacity: 1; }
            }
            @keyframes slideOut {
                from { transform: translateX(0); opacity: 1; }
                to { transform: translateX(100%); opacity: 0; }
            }
        `;
        document.head.appendChild(style);

        // Détails des services (modal ou redirection)
        function showServiceDetails(serviceKey) {
            if (completePricingGrid[serviceKey]) {
                const service = completePricingGrid[serviceKey];
                const servicesList = Object.entries(service.services).slice(0, 10).map(([key, data]) => 
                    `<li>✅ ${data.label} - <strong>${data.price}€/${data.unit}</strong></li>`
                ).join('');
                
                const modal = document.createElement('div');
                modal.style.cssText = `
                    position: fixed;
                    top: 0;
                    left: 0;
                    right: 0;
                    bottom: 0;
                    background: rgba(0,0,0,0.8);
                    display: flex;
                    align-items: center;
                    justify-content: center;
                    z-index: 1002;
                    padding: 20px;
                `;
                
                modal.innerHTML = `
                    <div style="background: white; border-radius: var(--radius-lg); padding: 40px; max-width: 600px; max-height: 80vh; overflow-y: auto;">
                        <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 20px;">
                            <h3 style="color: var(--primary); font-size: 1.5rem;">${service.title}</h3>
                            <button onclick="this.parentElement.parentElement.parentElement.remove()" style="background: none; border: none; font-size: 1.5rem; cursor: pointer;">✕</button>
                        </div>
                        <p style="margin-bottom: 20px; color: var(--gray);">Voici un aperçu de nos prestations dans cette catégorie :</p>
                        <ul style="list-style: none; padding: 0; margin-bottom: 30px;">
                            ${servicesList}
                        </ul>
                        <div style="text-align: center;">
                            <button onclick="document.getElementById('devis').scrollIntoView({ behavior: 'smooth' }); this.parentElement.parentElement.parentElement.remove();" class="btn btn-primary" style="margin-right: 10px;">📝 Faire un Devis</button>
                            <button onclick="document.getElementById('rdv').scrollIntoView({ behavior: 'smooth' }); this.parentElement.parentElement.parentElement.remove();" class="btn btn-success">📅 Prendre RDV</button>
                        </div>
                    </div>
                `;
                
                document.body.appendChild(modal);
                modal.onclick = (e) => {
                    if (e.target === modal) {
                        modal.remove();
                    }
                };
            }
        }

        // Messages de bienvenue automatiques pour le chat
        setTimeout(() => {
            if (chatMessages.length === 0) {
                addChatMessage("👋 Bonjour ! Besoin d'aide pour vos travaux ?", 'bot');
            }
        }, 3000);

        setTimeout(() => {
            if (chatMessages.filter(m => m.sender === 'user').length === 0) {
                addChatMessage("💡 Astuce : Utilisez notre calculateur de devis pour obtenir un prix instantané !", 'bot');
            }
        }, 10000);

        console.log('🔧 MJ Créations - Plateforme initialisée avec', Object.keys(completePricingGrid).reduce((acc, key) => acc + Object.keys(completePricingGrid[key].services).length, 0), 'prestations disponibles');
    </script>

<!-- Injected unified services catalogue -->
<script>
  window.SERVICES = {
  "revetements": {
    "title": "🏠 Revêtements de sol",
    "services": {
      "pose_carrelage_sol_standard": {
        "price": 55,
        "unit": "m²",
        "label": "Pose carrelage sol standard (30x30 à 60x60)"
      },
      "pose_carrelage_sol_grand_format": {
        "price": 65,
        "unit": "m²",
        "label": "Pose carrelage grand format (>60x60)"
      },
      "pose_carrelage_mural_standard": {
        "price": 40,
        "unit": "m²",
        "label": "Pose carrelage mural standard"
      },
      "pose_faience_sdb": {
        "price": 35,
        "unit": "m²",
        "label": "Pose faïence salle de bain"
      },
      "pose_mosaique": {
        "price": 65,
        "unit": "m²",
        "label": "Pose mosaïque (verre/céramique)"
      },
      "pose_carrelage_terrasse": {
        "price": 72,
        "unit": "m²",
        "label": "Pose carrelage terrasse extérieur"
      },
      "pose_carrelage_piscine": {
        "price": 85,
        "unit": "m²",
        "label": "Pose carrelage piscine antidérapant"
      },
      "pose_plinthes_carrelage": {
        "price": 15,
        "unit": "ml",
        "label": "Pose plinthes carrelage"
      },
      "pose_parquet_stratifie": {
        "price": 25,
        "unit": "m²",
        "label": "Pose parquet stratifié/contrecollé"
      },
      "pose_parquet_flottant_seul": {
        "price": 15,
        "unit": "m²",
        "label": "Pose parquet flottant seul"
      },
      "pose_parquet_flottant_sous_couche": {
        "price": 28,
        "unit": "m²",
        "label": "Pose parquet flottant + sous-couche"
      },
      "pose_parquet_massif_cloue": {
        "price": 98,
        "unit": "m²",
        "label": "Pose parquet massif cloué"
      },
      "pose_parquet_massif_colle": {
        "price": 65,
        "unit": "m²",
        "label": "Pose parquet massif collé"
      },
      "pose_parquet_contrecolle": {
        "price": 45,
        "unit": "m²",
        "label": "Pose parquet contrecollé"
      },
      "poncage_parquet": {
        "price": 25,
        "unit": "m²",
        "label": "Ponçage parquet"
      },
      "vitrification_parquet": {
        "price": 15,
        "unit": "m²",
        "label": "Vitrification parquet"
      },
      "poncage_vitrification": {
        "price": 30,
        "unit": "m²",
        "label": "Ponçage + vitrification"
      },
      "huilage_parquet": {
        "price": 20,
        "unit": "m²",
        "label": "Huilage parquet"
      },
      "pose_plinthes_bois": {
        "price": 12,
        "unit": "ml",
        "label": "Pose plinthes bois"
      },
      "pose_barre_seuil": {
        "price": 25,
        "unit": "unité",
        "label": "Pose barre de seuil"
      },
      "pose_quart_de_rond": {
        "price": 8,
        "unit": "ml",
        "label": "Pose quart de rond"
      },
      "pose_sol_pvc_rouleau": {
        "price": 20,
        "unit": "m²",
        "label": "Pose sol PVC/lino en rouleau"
      },
      "pose_lames_pvc_clipsables": {
        "price": 25,
        "unit": "m²",
        "label": "Pose lames PVC clipsables"
      },
      "pose_sol_vinyle_luxe": {
        "price": 35,
        "unit": "m²",
        "label": "Pose sol vinyle de luxe (LVT)"
      },
      "pose_sol_vinyle": {
        "price": 22,
        "unit": "m²",
        "label": "Pose sol vinyle standard"
      },
      "pose_moquette_aiguilletee": {
        "price": 25,
        "unit": "m²",
        "label": "Pose moquette aiguilletée"
      },
      "pose_moquette_tuftee": {
        "price": 30,
        "unit": "m²",
        "label": "Pose moquette tuftée"
      },
      "pose_dalles_moquette": {
        "price": 28,
        "unit": "m²",
        "label": "Pose dalles moquette"
      },
      "pose_jonc_mer": {
        "price": 30,
        "unit": "m²",
        "label": "Pose jonc de mer/sisal"
      },
      "pose_coco": {
        "price": 32,
        "unit": "m²",
        "label": "Pose fibre de coco"
      },
      "pose_liege": {
        "price": 45,
        "unit": "m²",
        "label": "Pose dalles liège"
      },
      "pose_bambou": {
        "price": 55,
        "unit": "m²",
        "label": "Pose parquet bambou"
      },
      "ragreage_autolissant": {
        "price": 12,
        "unit": "m²",
        "label": "Ragréage autolissant"
      },
      "ragreage_fibre": {
        "price": 15,
        "unit": "m²",
        "label": "Ragréage fibré"
      },
      "primaire_accrochage": {
        "price": 8,
        "unit": "m²",
        "label": "Primaire d'accrochage"
      },
      "depose_ancien_revetement": {
        "price": 10,
        "unit": "m²",
        "label": "Dépose ancien revêtement"
      },
      "evacuation_gravats": {
        "price": 8,
        "unit": "m²",
        "label": "Évacuation gravats"
      },
      "nettoyage_fin_chantier": {
        "price": 5,
        "unit": "m²",
        "label": "Nettoyage fin de chantier"
      }
    }
  },
  "salle-bain": {
    "title": "🚿 Salle de Bain",
    "services": {
      "renovation_petite_sdb": {
        "price": 6000,
        "unit": "forfait",
        "label": "Rénovation petite SDB complète (<4m²)"
      },
      "renovation_moyenne_sdb": {
        "price": 9000,
        "unit": "forfait",
        "label": "Rénovation SDB moyenne (5-7m²)"
      },
      "renovation_grande_sdb": {
        "price": 12000,
        "unit": "forfait",
        "label": "Rénovation grande SDB (>8m²)"
      },
      "renovation_wc_separe": {
        "price": 2500,
        "unit": "forfait",
        "label": "Rénovation WC séparé complet"
      },
      "pose_baignoire_acrylique": {
        "price": 250,
        "unit": "unité",
        "label": "Pose baignoire acrylique standard"
      },
      "pose_baignoire_fonte": {
        "price": 350,
        "unit": "unité",
        "label": "Pose baignoire fonte/acier"
      },
      "pose_baignoire_balneo": {
        "price": 500,
        "unit": "unité",
        "label": "Pose baignoire balnéo"
      },
      "pose_baignoire_ilot": {
        "price": 650,
        "unit": "unité",
        "label": "Pose baignoire îlot"
      },
      "pose_tablier_baignoire": {
        "price": 80,
        "unit": "unité",
        "label": "Pose tablier baignoire"
      },
      "pose_pare_baignoire_fixe": {
        "price": 150,
        "unit": "unité",
        "label": "Pose pare-baignoire fixe"
      },
      "pose_pare_baignoire_pivotant": {
        "price": 180,
        "unit": "unité",
        "label": "Pose pare-baignoire pivotant"
      },
      "pose_receveur_douche_standard": {
        "price": 200,
        "unit": "unité",
        "label": "Pose receveur douche standard"
      },
      "pose_receveur_extra_plat": {
        "price": 250,
        "unit": "unité",
        "label": "Pose receveur extra-plat"
      },
      "pose_receveur_sur_mesure": {
        "price": 400,
        "unit": "unité",
        "label": "Pose receveur sur mesure"
      },
      "pose_cabine_douche_complete": {
        "price": 400,
        "unit": "unité",
        "label": "Pose cabine douche complète"
      },
      "pose_douche_italienne_standard": {
        "price": 1150,
        "unit": "unité",
        "label": "Création douche italienne standard"
      },
      "pose_douche_italienne_luxe": {
        "price": 1800,
        "unit": "unité",
        "label": "Création douche italienne haut de gamme"
      },
      "pose_paroi_douche_fixe": {
        "price": 150,
        "unit": "unité",
        "label": "Pose paroi douche fixe"
      },
      "pose_paroi_douche_coulissante": {
        "price": 200,
        "unit": "unité",
        "label": "Pose paroi douche coulissante"
      },
      "pose_porte_douche_pivotante": {
        "price": 180,
        "unit": "unité",
        "label": "Pose porte douche pivotante"
      },
      "pose_caniveau_douche_italienne": {
        "price": 150,
        "unit": "unité",
        "label": "Pose caniveau douche italienne"
      },
      "etancheite_douche_italienne": {
        "price": 300,
        "unit": "forfait",
        "label": "Étanchéité complète douche italienne"
      },
      "pose_wc_sol_standard": {
        "price": 200,
        "unit": "unité",
        "label": "Pose WC au sol standard"
      },
      "pose_wc_suspendu_bati": {
        "price": 375,
        "unit": "unité",
        "label": "Pose WC suspendu + bâti-support"
      },
      "pose_wc_suspendu_geberit": {
        "price": 450,
        "unit": "unité",
        "label": "Pose WC suspendu Geberit"
      },
      "pose_abattant_wc_standard": {
        "price": 30,
        "unit": "unité",
        "label": "Pose abattant WC standard"
      },
      "pose_abattant_wc_japonais": {
        "price": 200,
        "unit": "unité",
        "label": "Pose WC japonais"
      },
      "pose_lave_mains": {
        "price": 120,
        "unit": "unité",
        "label": "Pose lave-mains"
      },
      "pose_bidet": {
        "price": 180,
        "unit": "unité",
        "label": "Pose bidet"
      },
      "pose_lavabo_colonne": {
        "price": 150,
        "unit": "unité",
        "label": "Pose lavabo sur colonne"
      },
      "pose_lavabo_suspendu": {
        "price": 180,
        "unit": "unité",
        "label": "Pose lavabo suspendu"
      },
      "pose_vasque_poser": {
        "price": 120,
        "unit": "unité",
        "label": "Pose vasque à poser"
      },
      "pose_vasque_encastrer": {
        "price": 150,
        "unit": "unité",
        "label": "Pose vasque à encastrer"
      },
      "pose_plan_vasque_standard": {
        "price": 200,
        "unit": "unité",
        "label": "Pose plan vasque standard"
      },
      "pose_plan_vasque_sur_mesure": {
        "price": 350,
        "unit": "unité",
        "label": "Pose plan vasque sur mesure"
      },
      "pose_meuble_vasque_simple": {
        "price": 180,
        "unit": "unité",
        "label": "Pose meuble vasque simple"
      },
      "pose_meuble_vasque_double": {
        "price": 300,
        "unit": "unité",
        "label": "Pose meuble vasque double"
      },
      "pose_mitigeur_lavabo": {
        "price": 80,
        "unit": "unité",
        "label": "Pose mitigeur lavabo"
      },
      "pose_mitigeur_douche": {
        "price": 100,
        "unit": "unité",
        "label": "Pose mitigeur douche"
      },
      "pose_mitigeur_thermostatique": {
        "price": 120,
        "unit": "unité",
        "label": "Pose mitigeur thermostatique"
      },
      "pose_mitigeur_baignoire": {
        "price": 110,
        "unit": "unité",
        "label": "Pose mitigeur baignoire"
      },
      "pose_colonne_douche_standard": {
        "price": 150,
        "unit": "unité",
        "label": "Pose colonne douche standard"
      },
      "pose_colonne_douche_hydromassante": {
        "price": 200,
        "unit": "unité",
        "label": "Pose colonne douche hydromassante"
      },
      "pose_robinet_simple": {
        "price": 60,
        "unit": "unité",
        "label": "Pose robinet simple"
      },
      "pose_douchette_wc": {
        "price": 80,
        "unit": "unité",
        "label": "Pose douchette WC"
      },
      "pose_miroir_simple": {
        "price": 50,
        "unit": "unité",
        "label": "Pose miroir simple"
      },
      "pose_miroir_led": {
        "price": 80,
        "unit": "unité",
        "label": "Pose miroir LED"
      },
      "pose_armoire_toilette": {
        "price": 100,
        "unit": "unité",
        "label": "Pose armoire de toilette"
      },
      "pose_seche_serviettes_eau": {
        "price": 200,
        "unit": "unité",
        "label": "Pose sèche-serviettes eau chaude"
      },
      "pose_seche_serviettes_electrique": {
        "price": 150,
        "unit": "unité",
        "label": "Pose sèche-serviettes électrique"
      },
      "pose_seche_serviettes_mixte": {
        "price": 250,
        "unit": "unité",
        "label": "Pose sèche-serviettes mixte"
      },
      "pose_vmc_salle_bain": {
        "price": 250,
        "unit": "unité",
        "label": "Pose VMC salle de bain"
      },
      "pose_extracteur_air": {
        "price": 120,
        "unit": "unité",
        "label": "Pose extracteur d'air"
      },
      "pose_spot_salle_bain": {
        "price": 80,
        "unit": "unité",
        "label": "Pose spot salle de bain IP44"
      },
      "pose_reglette_led_miroir": {
        "price": 90,
        "unit": "unité",
        "label": "Pose réglette LED miroir"
      }
    }
  },
  "cuisine": {
    "title": "🍳 Cuisine",
    "services": {
      "pose_cuisine_lineaire": {
        "price": 400,
        "unit": "ml",
        "label": "Pose cuisine linéaire standard"
      },
      "pose_cuisine_angle": {
        "price": 550,
        "unit": "jour",
        "label": "Pose cuisine en L ou U"
      },
      "pose_cuisine_ilot": {
        "price": 750,
        "unit": "jour",
        "label": "Pose cuisine avec îlot central"
      },
      "pose_cuisine_americaine": {
        "price": 650,
        "unit": "jour",
        "label": "Pose cuisine américaine ouverte"
      },
      "pose_meuble_bas_standard": {
        "price": 50,
        "unit": "unité",
        "label": "Pose meuble bas standard"
      },
      "pose_meuble_bas_evier": {
        "price": 80,
        "unit": "unité",
        "label": "Pose meuble bas évier"
      },
      "pose_meuble_haut": {
        "price": 60,
        "unit": "unité",
        "label": "Pose meuble haut"
      },
      "pose_meuble_angle": {
        "price": 100,
        "unit": "unité",
        "label": "Pose meuble d'angle"
      },
      "pose_colonne_standard": {
        "price": 80,
        "unit": "unité",
        "label": "Pose colonne standard"
      },
      "pose_colonne_four": {
        "price": 120,
        "unit": "unité",
        "label": "Pose colonne four/frigo"
      },
      "pose_ilot_central": {
        "price": 200,
        "unit": "unité",
        "label": "Pose îlot central"
      },
      "pose_bar_american": {
        "price": 150,
        "unit": "ml",
        "label": "Pose bar américain"
      },
      "pose_fileur_joue": {
        "price": 30,
        "unit": "unité",
        "label": "Pose fileur/joue"
      },
      "pose_plan_travail_droit_stratifie": {
        "price": 150,
        "unit": "ml",
        "label": "Plan de travail stratifié droit"
      },
      "pose_plan_travail_angle_stratifie": {
        "price": 200,
        "unit": "ml",
        "label": "Plan de travail stratifié angle"
      },
      "pose_plan_travail_quartz": {
        "price": 350,
        "unit": "ml",
        "label": "Plan de travail quartz"
      },
      "pose_plan_travail_granit": {
        "price": 400,
        "unit": "ml",
        "label": "Plan de travail granit"
      },
      "pose_plan_travail_bois": {
        "price": 250,
        "unit": "ml",
        "label": "Plan de travail bois massif"
      },
      "pose_plan_travail_inox": {
        "price": 300,
        "unit": "ml",
        "label": "Plan de travail inox"
      },
      "decoupe_plan_travail": {
        "price": 50,
        "unit": "découpe",
        "label": "Découpe plan de travail"
      },
      "pose_credence_carrelage": {
        "price": 50,
        "unit": "m²",
        "label": "Crédence carrelage"
      },
      "pose_credence_verre": {
        "price": 70,
        "unit": "m²",
        "label": "Crédence verre trempé"
      },
      "pose_credence_inox": {
        "price": 80,
        "unit": "m²",
        "label": "Crédence inox"
      },
      "pose_credence_composite": {
        "price": 65,
        "unit": "m²",
        "label": "Crédence composite"
      },
      "pose_evier_1_bac": {
        "price": 150,
        "unit": "unité",
        "label": "Pose évier 1 bac"
      },
      "pose_evier_2_bacs": {
        "price": 200,
        "unit": "unité",
        "label": "Pose évier 2 bacs"
      },
      "pose_evier_sous_plan": {
        "price": 250,
        "unit": "unité",
        "label": "Pose évier sous plan"
      },
      "pose_evier_granit": {
        "price": 300,
        "unit": "unité",
        "label": "Pose évier granit/résine"
      },
      "pose_robinet_cuisine_standard": {
        "price": 80,
        "unit": "unité",
        "label": "Robinet cuisine standard"
      },
      "pose_mitigeur_douchette": {
        "price": 100,
        "unit": "unité",
        "label": "Mitigeur avec douchette"
      },
      "pose_robinet_3_voies": {
        "price": 150,
        "unit": "unité",
        "label": "Robinet 3 voies (eau filtrée)"
      },
      "pose_plaque_cuisson_gaz": {
        "price": 80,
        "unit": "unité",
        "label": "Plaque cuisson gaz"
      },
      "pose_plaque_cuisson_electrique": {
        "price": 80,
        "unit": "unité",
        "label": "Plaque cuisson électrique"
      },
      "pose_plaque_induction": {
        "price": 100,
        "unit": "unité",
        "label": "Plaque induction"
      },
      "pose_four_encastrable": {
        "price": 80,
        "unit": "unité",
        "label": "Four encastrable"
      },
      "pose_four_vapeur": {
        "price": 120,
        "unit": "unité",
        "label": "Four vapeur"
      },
      "pose_micro_ondes_encastrable": {
        "price": 60,
        "unit": "unité",
        "label": "Micro-ondes encastrable"
      },
      "pose_lave_vaisselle": {
        "price": 80,
        "unit": "unité",
        "label": "Lave-vaisselle encastrable"
      },
      "pose_lave_linge_encastrable": {
        "price": 100,
        "unit": "unité",
        "label": "Lave-linge encastrable"
      },
      "pose_refrigerateur_encastrable": {
        "price": 100,
        "unit": "unité",
        "label": "Réfrigérateur encastrable"
      },
      "pose_cave_vin": {
        "price": 120,
        "unit": "unité",
        "label": "Cave à vin encastrable"
      },
      "pose_hotte_standard": {
        "price": 150,
        "unit": "unité",
        "label": "Hotte aspirante standard"
      },
      "pose_hotte_decorative": {
        "price": 200,
        "unit": "unité",
        "label": "Hotte décorative"
      },
      "pose_hotte_plafond": {
        "price": 250,
        "unit": "unité",
        "label": "Hotte plafond"
      },
      "pose_hotte_integree": {
        "price": 180,
        "unit": "unité",
        "label": "Hotte intégrée meuble"
      },
      "raccordement_gaz_cuisine": {
        "price": 150,
        "unit": "unité",
        "label": "Raccordement gaz cuisine"
      },
      "evacuation_hotte": {
        "price": 120,
        "unit": "forfait",
        "label": "Évacuation hotte extérieure"
      },
      "eclairage_sous_meuble": {
        "price": 80,
        "unit": "ml",
        "label": "Éclairage LED sous meuble"
      }
    }
  },
  "menuiserie": {
    "title": "🚪 Menuiseries",
    "services": {
      "pose_porte_interieure_standard": {
        "price": 150,
        "unit": "unité",
        "label": "Porte intérieure standard"
      },
      "pose_porte_postformee": {
        "price": 180,
        "unit": "unité",
        "label": "Porte postformée"
      },
      "pose_porte_bois_massif": {
        "price": 250,
        "unit": "unité",
        "label": "Porte bois massif"
      },
      "pose_porte_vitre": {
        "price": 200,
        "unit": "unité",
        "label": "Porte avec vitrage"
      },
      "pose_porte_coulissante_standard": {
        "price": 225,
        "unit": "unité",
        "label": "Porte coulissante standard"
      },
      "pose_porte_coulissante_galandage": {
        "price": 350,
        "unit": "unité",
        "label": "Porte coulissante galandage"
      },
      "pose_porte_coulissante_suspendue": {
        "price": 300,
        "unit": "unité",
        "label": "Porte coulissante suspendue"
      },
      "pose_porte_pliante": {
        "price": 200,
        "unit": "unité",
        "label": "Porte pliante/accordéon"
      },
      "pose_porte_blindee": {
        "price": 450,
        "unit": "unité",
        "label": "Porte blindée"
      },
      "pose_porte_coupe_feu": {
        "price": 350,
        "unit": "unité",
        "label": "Porte coupe-feu"
      },
      "pose_porte_entree_pvc": {
        "price": 450,
        "unit": "unité",
        "label": "Porte d'entrée PVC"
      },
      "pose_porte_entree_alu": {
        "price": 500,
        "unit": "unité",
        "label": "Porte d'entrée aluminium"
      },
      "pose_porte_entree_bois": {
        "price": 400,
        "unit": "unité",
        "label": "Porte d'entrée bois"
      },
      "pose_porte_entree_acier": {
        "price": 380,
        "unit": "unité",
        "label": "Porte d'entrée acier"
      },
      "pose_porte_garage_sectionnelle": {
        "price": 600,
        "unit": "unité",
        "label": "Porte garage sectionnelle"
      },
      "pose_porte_garage_basculante": {
        "price": 500,
        "unit": "unité",
        "label": "Porte garage basculante"
      },
      "pose_porte_garage_enroulable": {
        "price": 700,
        "unit": "unité",
        "label": "Porte garage enroulable"
      },
      "pose_porte_garage_battante": {
        "price": 550,
        "unit": "unité",
        "label": "Porte garage battante"
      },
      "motorisation_porte_garage": {
        "price": 300,
        "unit": "unité",
        "label": "Motorisation porte garage"
      },
      "pose_fenetre_1_vantail_pvc": {
        "price": 225,
        "unit": "unité",
        "label": "Fenêtre PVC 1 vantail"
      },
      "pose_fenetre_2_vantaux_pvc": {
        "price": 275,
        "unit": "unité",
        "label": "Fenêtre PVC 2 vantaux"
      },
      "pose_fenetre_1_vantail_alu": {
        "price": 300,
        "unit": "unité",
        "label": "Fenêtre alu 1 vantail"
      },
      "pose_fenetre_2_vantaux_alu": {
        "price": 350,
        "unit": "unité",
        "label": "Fenêtre alu 2 vantaux"
      },
      "pose_fenetre_bois": {
        "price": 280,
        "unit": "unité",
        "label": "Fenêtre bois"
      },
      "pose_fenetre_mixte": {
        "price": 320,
        "unit": "unité",
        "label": "Fenêtre mixte bois/alu"
      },
      "pose_porte_fenetre_pvc": {
        "price": 400,
        "unit": "unité",
        "label": "Porte-fenêtre PVC"
      },
      "pose_porte_fenetre_alu": {
        "price": 450,
        "unit": "unité",
        "label": "Porte-fenêtre alu"
      },
      "pose_baie_vitree_coulissante": {
        "price": 550,
        "unit": "unité",
        "label": "Baie vitrée coulissante"
      },
      "pose_baie_vitree_galandage": {
        "price": 800,
        "unit": "unité",
        "label": "Baie vitrée galandage"
      },
      "pose_fenetre_toit_standard": {
        "price": 550,
        "unit": "unité",
        "label": "Fenêtre de toit standard"
      },
      "pose_fenetre_toit_motorisee": {
        "price": 750,
        "unit": "unité",
        "label": "Fenêtre de toit motorisée"
      },
      "pose_puits_lumiere": {
        "price": 700,
        "unit": "unité",
        "label": "Puits de lumière"
      },
      "pose_verriere_interieure": {
        "price": 400,
        "unit": "m²",
        "label": "Verrière intérieure"
      },
      "pose_verriere_exterieure": {
        "price": 500,
        "unit": "m²",
        "label": "Verrière extérieure"
      },
      "pose_volet_battant_bois": {
        "price": 150,
        "unit": "unité",
        "label": "Volet battant bois"
      },
      "pose_volet_battant_pvc": {
        "price": 120,
        "unit": "unité",
        "label": "Volet battant PVC"
      },
      "pose_volet_battant_alu": {
        "price": 200,
        "unit": "unité",
        "label": "Volet battant alu"
      },
      "pose_volet_roulant_manuel": {
        "price": 300,
        "unit": "unité",
        "label": "Volet roulant manuel"
      },
      "pose_volet_roulant_electrique": {
        "price": 400,
        "unit": "unité",
        "label": "Volet roulant électrique"
      },
      "pose_volet_roulant_solaire": {
        "price": 500,
        "unit": "unité",
        "label": "Volet roulant solaire"
      },
      "pose_store_interieur": {
        "price": 115,
        "unit": "unité",
        "label": "Store intérieur"
      },
      "pose_store_venitien": {
        "price": 130,
        "unit": "unité",
        "label": "Store vénitien"
      },
      "pose_store_banne_manuel": {
        "price": 500,
        "unit": "unité",
        "label": "Store banne manuel"
      },
      "pose_store_banne_motorise": {
        "price": 750,
        "unit": "unité",
        "label": "Store banne motorisé"
      },
      "pose_pergola_bois": {
        "price": 150,
        "unit": "m²",
        "label": "Pergola bois"
      },
      "pose_pergola_alu": {
        "price": 200,
        "unit": "m²",
        "label": "Pergola aluminium"
      },
      "pose_pergola_bioclimatique": {
        "price": 350,
        "unit": "m²",
        "label": "Pergola bioclimatique"
      }
    }
  },
  "chauffage": {
    "title": "🔥 Chauffage/Climatisation",
    "services": {
      "pose_radiateur_electrique_convecteur": {
        "price": 150,
        "unit": "unité",
        "label": "Radiateur électrique convecteur"
      },
      "pose_radiateur_electrique_rayonnant": {
        "price": 180,
        "unit": "unité",
        "label": "Radiateur électrique rayonnant"
      },
      "pose_radiateur_inertie": {
        "price": 250,
        "unit": "unité",
        "label": "Radiateur à inertie"
      },
      "pose_radiateur_eau_chaude_fonte": {
        "price": 250,
        "unit": "unité",
        "label": "Radiateur eau chaude fonte"
      },
      "pose_radiateur_eau_chaude_acier": {
        "price": 200,
        "unit": "unité",
        "label": "Radiateur eau chaude acier"
      },
      "pose_radiateur_design": {
        "price": 300,
        "unit": "unité",
        "label": "Radiateur design/décoratif"
      },
      "pose_seche_serviettes_eau": {
        "price": 200,
        "unit": "unité",
        "label": "Sèche-serviettes eau chaude"
      },
      "pose_seche_serviettes_electrique": {
        "price": 150,
        "unit": "unité",
        "label": "Sèche-serviettes électrique"
      },
      "pose_seche_serviettes_mixte": {
        "price": 250,
        "unit": "unité",
        "label": "Sèche-serviettes mixte"
      },
      "pose_plancher_chauffant_electrique": {
        "price": 75,
        "unit": "m²",
        "label": "Plancher chauffant électrique"
      },
      "pose_plancher_chauffant_eau": {
        "price": 85,
        "unit": "m²",
        "label": "Plancher chauffant eau chaude"
      },
      "pose_plancher_rafraichissant": {
        "price": 95,
        "unit": "m²",
        "label": "Plancher rafraîchissant"
      },
      "pose_plafond_chauffant": {
        "price": 80,
        "unit": "m²",
        "label": "Plafond chauffant rayonnant"
      },
      "pose_poele_bois_standard": {
        "price": 800,
        "unit": "unité",
        "label": "Poêle à bois standard"
      },
      "pose_poele_bois_etanche": {
        "price": 1000,
        "unit": "unité",
        "label": "Poêle à bois étanche"
      },
      "pose_poele_granules_standard": {
        "price": 1200,
        "unit": "unité",
        "label": "Poêle à granulés standard"
      },
      "pose_poele_granules_etanche": {
        "price": 1400,
        "unit": "unité",
        "label": "Poêle à granulés étanche"
      },
      "pose_poele_mixte": {
        "price": 1500,
        "unit": "unité",
        "label": "Poêle mixte bois/granulés"
      },
      "pose_cuisiniere_bois": {
        "price": 1200,
        "unit": "unité",
        "label": "Cuisinière à bois"
      },
      "pose_insert_cheminee": {
        "price": 800,
        "unit": "unité",
        "label": "Insert cheminée"
      },
      "pose_foyer_ferme": {
        "price": 1000,
        "unit": "unité",
        "label": "Foyer fermé"
      },
      "pose_chaudiere_gaz_murale": {
        "price": 1500,
        "unit": "unité",
        "label": "Chaudière gaz murale"
      },
      "pose_chaudiere_gaz_sol": {
        "price": 2000,
        "unit": "unité",
        "label": "Chaudière gaz sol"
      },
      "pose_chaudiere_condensation": {
        "price": 2500,
        "unit": "unité",
        "label": "Chaudière à condensation"
      },
      "pose_chaudiere_fioul": {
        "price": 2200,
        "unit": "unité",
        "label": "Chaudière fioul"
      },
      "pose_chaudiere_electrique": {
        "price": 1800,
        "unit": "unité",
        "label": "Chaudière électrique"
      },
      "pose_chaudiere_bois": {
        "price": 3000,
        "unit": "unité",
        "label": "Chaudière bois"
      },
      "pose_chaudiere_granules": {
        "price": 3500,
        "unit": "unité",
        "label": "Chaudière granulés"
      },
      "entretien_chaudiere_gaz": {
        "price": 120,
        "unit": "intervention",
        "label": "Entretien chaudière gaz"
      },
      "entretien_chaudiere_fioul": {
        "price": 150,
        "unit": "intervention",
        "label": "Entretien chaudière fioul"
      },
      "entretien_poele_bois": {
        "price": 80,
        "unit": "intervention",
        "label": "Entretien poêle à bois"
      },
      "entretien_poele_granules": {
        "price": 100,
        "unit": "intervention",
        "label": "Entretien poêle granulés"
      },
      "ramonage_conduit": {
        "price": 70,
        "unit": "intervention",
        "label": "Ramonage conduit"
      },
      "tubage_conduit": {
        "price": 150,
        "unit": "ml",
        "label": "Tubage conduit cheminée"
      },
      "pose_conduit_exterieur": {
        "price": 200,
        "unit": "ml",
        "label": "Conduit extérieur isolé"
      },
      "controle_etancheite_gaz": {
        "price": 85,
        "unit": "intervention",
        "label": "Contrôle étanchéité gaz"
      },
      "desembouage_circuit": {
        "price": 400,
        "unit": "intervention",
        "label": "Désembouage circuit"
      },
      "purge_radiateurs": {
        "price": 60,
        "unit": "intervention",
        "label": "Purge radiateurs"
      },
      "reglage_chaudiere": {
        "price": 90,
        "unit": "intervention",
        "label": "Réglage chaudière"
      },
      "pose_thermostat_ambiance": {
        "price": 150,
        "unit": "unité",
        "label": "Thermostat d'ambiance"
      },
      "pose_thermostat_connecte": {
        "price": 200,
        "unit": "unité",
        "label": "Thermostat connecté"
      },
      "pose_robinet_thermostatique": {
        "price": 80,
        "unit": "unité",
        "label": "Robinet thermostatique"
      },
      "pose_climatiseur_monosplit": {
        "price": 650,
        "unit": "unité",
        "label": "Climatiseur monosplit"
      },
      "pose_climatiseur_bisplit": {
        "price": 1200,
        "unit": "unité",
        "label": "Climatiseur bisplit"
      },
      "pose_climatiseur_multisplit": {
        "price": 1500,
        "unit": "unité",
        "label": "Climatiseur multisplit"
      },
      "pose_climatiseur_gainable": {
        "price": 2000,
        "unit": "unité",
        "label": "Climatiseur gainable"
      },
      "pose_pompe_chaleur_air_air": {
        "price": 2250,
        "unit": "unité",
        "label": "Pompe à chaleur air/air"
      },
      "pose_pompe_chaleur_air_eau": {
        "price": 3500,
        "unit": "unité",
        "label": "Pompe à chaleur air/eau"
      },
      "pose_pompe_chaleur_geothermie": {
        "price": 8000,
        "unit": "unité",
        "label": "Pompe à chaleur géothermie"
      },
      "mise_en_service_climatisation": {
        "price": 225,
        "unit": "intervention",
        "label": "Mise en service climatisation"
      },
      "entretien_annuel_climatisation": {
        "price": 150,
        "unit": "intervention",
        "label": "Entretien annuel climatisation"
      },
      "nettoyage_filtres_clim": {
        "price": 80,
        "unit": "intervention",
        "label": "Nettoyage filtres climatisation"
      },
      "recharge_gaz_clim": {
        "price": 200,
        "unit": "intervention",
        "label": "Recharge gaz climatisation"
      },
      "controle_pression_clim": {
        "price": 60,
        "unit": "intervention",
        "label": "Contrôle pression climatisation"
      },
      "desinfection_circuit_clim": {
        "price": 120,
        "unit": "intervention",
        "label": "Désinfection circuit climatisation"
      }
    }
  },
  "electricite": {
    "title": "⚡ Électricité",
    "services": {
      "pose_prise_electrique_standard": {
        "price": 65,
        "unit": "unité",
        "label": "Prise électrique 16A standard"
      },
      "pose_prise_electrique_cuisine": {
        "price": 75,
        "unit": "unité",
        "label": "Prise électrique 20A cuisine"
      },
      "pose_prise_etanche": {
        "price": 85,
        "unit": "unité",
        "label": "Prise étanche IP44/IP55"
      },
      "pose_prise_usb": {
        "price": 80,
        "unit": "unité",
        "label": "Prise USB intégrée"
      },
      "pose_prise_rj45": {
        "price": 70,
        "unit": "unité",
        "label": "Prise RJ45 informatique"
      },
      "pose_prise_telephone": {
        "price": 70,
        "unit": "unité",
        "label": "Prise téléphone"
      },
      "pose_prise_tv_coaxiale": {
        "price": 70,
        "unit": "unité",
        "label": "Prise TV coaxiale"
      },
      "pose_interrupteur_simple": {
        "price": 65,
        "unit": "unité",
        "label": "Interrupteur simple"
      },
      "pose_interrupteur_double": {
        "price": 75,
        "unit": "unité",
        "label": "Interrupteur double"
      },
      "pose_interrupteur_variateur": {
        "price": 85,
        "unit": "unité",
        "label": "Interrupteur variateur"
      },
      "pose_interrupteur_tactile": {
        "price": 120,
        "unit": "unité",
        "label": "Interrupteur tactile"
      },
      "pose_interrupteur_connecte": {
        "price": 150,
        "unit": "unité",
        "label": "Interrupteur connecté"
      },
      "pose_va_et_vient": {
        "price": 95,
        "unit": "unité",
        "label": "Va-et-vient"
      },
      "pose_telerupteur": {
        "price": 120,
        "unit": "unité",
        "label": "Télérupteur"
      },
      "pose_minuterie": {
        "price": 100,
        "unit": "unité",
        "label": "Minuterie d'éclairage"
      },
      "pose_detecteur_mouvement": {
        "price": 100,
        "unit": "unité",
        "label": "Détecteur de mouvement"
      },
      "pose_detecteur_crepusculaire": {
        "price": 90,
        "unit": "unité",
        "label": "Détecteur crépusculaire"
      },
      "pose_spot_encastre_fixe": {
        "price": 50,
        "unit": "unité",
        "label": "Spot encastré fixe"
      },
      "pose_spot_encastre_orientable": {
        "price": 60,
        "unit": "unité",
        "label": "Spot encastré orientable"
      },
      "pose_spot_led_dimmable": {
        "price": 70,
        "unit": "unité",
        "label": "Spot LED dimmable"
      },
      "pose_luminaire_plafonnier": {
        "price": 60,
        "unit": "unité",
        "label": "Luminaire plafonnier"
      },
      "pose_luminaire_suspendu": {
        "price": 80,
        "unit": "unité",
        "label": "Luminaire suspendu"
      },
      "pose_lustre": {
        "price": 100,
        "unit": "unité",
        "label": "Lustre"
      },
      "pose_applique_murale": {
        "price": 70,
        "unit": "unité",
        "label": "Applique murale"
      },
      "pose_applique_led_design": {
        "price": 90,
        "unit": "unité",
        "label": "Applique LED design"
      },
      "pose_ruban_led_transfo": {
        "price": 40,
        "unit": "ml",
        "label": "Ruban LED + transformateur"
      },
      "pose_neon_led": {
        "price": 80,
        "unit": "unité",
        "label": "Néon LED"
      },
      "pose_hublot_exterieur": {
        "price": 90,
        "unit": "unité",
        "label": "Hublot extérieur"
      },
      "pose_projecteur_led": {
        "price": 120,
        "unit": "unité",
        "label": "Projecteur LED extérieur"
      },
      "pose_tableau_electrique_1_rangee": {
        "price": 400,
        "unit": "unité",
        "label": "Tableau électrique 1 rangée"
      },
      "pose_tableau_electrique_2_rangees": {
        "price": 600,
        "unit": "unité",
        "label": "Tableau électrique 2 rangées"
      },
      "pose_tableau_electrique_3_rangees": {
        "price": 800,
        "unit": "unité",
        "label": "Tableau électrique 3 rangées"
      },
      "pose_tableau_electrique_4_rangees": {
        "price": 1000,
        "unit": "unité",
        "label": "Tableau électrique 4 rangées"
      },
      "pose_disjoncteur_differentiel": {
        "price": 150,
        "unit": "unité",
        "label": "Disjoncteur différentiel"
      },
      "pose_interrupteur_differentiel": {
        "price": 80,
        "unit": "unité",
        "label": "Interrupteur différentiel"
      },
      "pose_parafoudre": {
        "price": 200,
        "unit": "unité",
        "label": "Parafoudre"
      },
      "pose_compteur_divisionnaire": {
        "price": 250,
        "unit": "unité",
        "label": "Compteur divisionnaire"
      },
      "pose_contacteur_jour_nuit": {
        "price": 120,
        "unit": "unité",
        "label": "Contacteur jour/nuit"
      },
      "pose_delesteur": {
        "price": 180,
        "unit": "unité",
        "label": "Délesteur"
      },
      "pose_borne_recharge_ve_standard": {
        "price": 800,
        "unit": "unité",
        "label": "Borne recharge VE 3,7kW"
      },
      "pose_borne_recharge_ve_rapide": {
        "price": 1200,
        "unit": "unité",
        "label": "Borne recharge VE 7,4kW"
      },
      "pose_borne_recharge_ve_tri": {
        "price": 1500,
        "unit": "unité",
        "label": "Borne recharge VE 11kW triphasée"
      },
      "pose_antenne_tv": {
        "price": 300,
        "unit": "unité",
        "label": "Pose antenne TV"
      },
      "pose_parabole": {
        "price": 350,
        "unit": "unité",
        "label": "Pose parabole satellite"
      },
      "pose_amplificateur_tv": {
        "price": 150,
        "unit": "unité",
        "label": "Amplificateur TV"
      },
      "pose_alarme_filaire": {
        "price": 800,
        "unit": "unité",
        "label": "Alarme filaire complète"
      },
      "pose_alarme_sans_fil": {
        "price": 1000,
        "unit": "unité",
        "label": "Alarme sans fil complète"
      },
      "pose_camera_surveillance": {
        "price": 200,
        "unit": "unité",
        "label": "Caméra surveillance"
      },
      "pose_videophone": {
        "price": 400,
        "unit": "unité",
        "label": "Visiophone"
      },
      "pose_portier_video": {
        "price": 300,
        "unit": "unité",
        "label": "Portier vidéo"
      },
      "pose_domotique_eclairage": {
        "price": 200,
        "unit": "point",
        "label": "Module domotique éclairage"
      },
      "pose_domotique_volets": {
        "price": 250,
        "unit": "point",
        "label": "Module domotique volets"
      },
      "pose_domotique_chauffage": {
        "price": 300,
        "unit": "zone",
        "label": "Module domotique chauffage"
      },
      "diagnostic_electrique_complet": {
        "price": 150,
        "unit": "intervention",
        "label": "Diagnostic électrique complet"
      },
      "controle_installation_electrique": {
        "price": 120,
        "unit": "intervention",
        "label": "Contrôle installation électrique"
      },
      "verification_mise_terre": {
        "price": 80,
        "unit": "intervention",
        "label": "Vérification mise à la terre"
      },
      "test_disjoncteurs_differentiel": {
        "price": 60,
        "unit": "intervention",
        "label": "Test disjoncteurs différentiel"
      },
      "mesure_isolement": {
        "price": 90,
        "unit": "intervention",
        "label": "Mesure isolement"
      },
      "controle_prise_terre": {
        "price": 70,
        "unit": "intervention",
        "label": "Contrôle prise de terre"
      },
      "verification_tableau_electrique": {
        "price": 100,
        "unit": "intervention",
        "label": "Vérification tableau électrique"
      },
      "recherche_defaut_electrique": {
        "price": 130,
        "unit": "intervention",
        "label": "Recherche défaut électrique"
      },
      "controle_conformite_nfc15100": {
        "price": 180,
        "unit": "intervention",
        "label": "Contrôle conformité NFC 15-100"
      },
      "remise_aux_normes_tableau": {
        "price": 300,
        "unit": "intervention",
        "label": "Remise aux normes tableau"
      },
      "mise_conformite_salle_bain": {
        "price": 200,
        "unit": "intervention",
        "label": "Mise conformité salle de bain"
      },
      "ajout_protection_differentielle": {
        "price": 120,
        "unit": "intervention",
        "label": "Ajout protection différentielle"
      },
      "mise_terre_installation": {
        "price": 250,
        "unit": "intervention",
        "label": "Mise à la terre installation"
      },
      "creation_point_lumineux": {
        "price": 80,
        "unit": "unité",
        "label": "Création point lumineux"
      },
      "deplacement_point_lumineux": {
        "price": 100,
        "unit": "unité",
        "label": "Déplacement point lumineux"
      }
    }
  },
  "plomberie": {
    "title": "🔧 Plomberie",
    "services": {
      "remplacement_robinet_simple": {
        "price": 150,
        "unit": "unité",
        "label": "Remplacement robinet simple"
      },
      "remplacement_mitigeur_lavabo": {
        "price": 180,
        "unit": "unité",
        "label": "Remplacement mitigeur lavabo"
      },
      "remplacement_mitigeur_douche": {
        "price": 200,
        "unit": "unité",
        "label": "Remplacement mitigeur douche"
      },
      "remplacement_mitigeur_cuisine": {
        "price": 220,
        "unit": "unité",
        "label": "Remplacement mitigeur cuisine"
      },
      "remplacement_groupe_securite": {
        "price": 150,
        "unit": "unité",
        "label": "Remplacement groupe sécurité"
      },
      "remplacement_siphon_lavabo": {
        "price": 80,
        "unit": "unité",
        "label": "Remplacement siphon lavabo"
      },
      "remplacement_siphon_evier": {
        "price": 90,
        "unit": "unité",
        "label": "Remplacement siphon évier"
      },
      "remplacement_flexible_wc": {
        "price": 60,
        "unit": "unité",
        "label": "Remplacement flexible WC"
      },
      "remplacement_flexible_douche": {
        "price": 50,
        "unit": "unité",
        "label": "Remplacement flexible douche"
      },
      "remplacement_vase_expansion": {
        "price": 200,
        "unit": "unité",
        "label": "Remplacement vase expansion"
      },
      "remplacement_flotteur_wc": {
        "price": 90,
        "unit": "unité",
        "label": "Remplacement flotteur WC"
      },
      "remplacement_mecanisme_chasse": {
        "price": 120,
        "unit": "unité",
        "label": "Remplacement mécanisme chasse"
      },
      "remplacement_joint_chasse": {
        "price": 40,
        "unit": "unité",
        "label": "Remplacement joint chasse eau"
      },
      "pose_vanne_arret": {
        "price": 100,
        "unit": "unité",
        "label": "Pose vanne d'arrêt"
      },
      "pose_reducteur_pression": {
        "price": 150,
        "unit": "unité",
        "label": "Pose réducteur pression"
      },
      "pose_clapet_anti_retour": {
        "price": 120,
        "unit": "unité",
        "label": "Pose clapet anti-retour"
      },
      "pose_disconnecteur": {
        "price": 180,
        "unit": "unité",
        "label": "Pose disconnecteur"
      },
      "pose_detendeur_gaz": {
        "price": 80,
        "unit": "unité",
        "label": "Pose détendeur gaz"
      },
      "creation_point_eau": {
        "price": 250,
        "unit": "unité",
        "label": "Création point d'eau"
      },
      "deplacement_point_eau": {
        "price": 300,
        "unit": "unité",
        "label": "Déplacement point d'eau"
      },
      "pose_nourrice_plomberie": {
        "price": 200,
        "unit": "unité",
        "label": "Pose nourrice plomberie"
      },
      "pose_compteur_eau": {
        "price": 150,
        "unit": "unité",
        "label": "Pose compteur d'eau"
      },
      "pose_collecteur_chauffage": {
        "price": 180,
        "unit": "unité",
        "label": "Pose collecteur chauffage"
      },
      "installation_adoucisseur": {
        "price": 500,
        "unit": "unité",
        "label": "Installation adoucisseur eau"
      },
      "installation_osmoseur": {
        "price": 300,
        "unit": "unité",
        "label": "Installation osmoseur"
      },
      "installation_filtre_eau": {
        "price": 200,
        "unit": "unité",
        "label": "Installation filtre eau"
      },
      "pose_chauffe_eau_100l": {
        "price": 400,
        "unit": "unité",
        "label": "Chauffe-eau électrique 100L"
      },
      "pose_chauffe_eau_200l": {
        "price": 450,
        "unit": "unité",
        "label": "Chauffe-eau électrique 200L"
      },
      "pose_chauffe_eau_300l": {
        "price": 500,
        "unit": "unité",
        "label": "Chauffe-eau électrique 300L"
      },
      "pose_chauffe_eau_thermodynamique": {
        "price": 1000,
        "unit": "unité",
        "label": "Chauffe-eau thermodynamique"
      },
      "pose_chauffe_eau_gaz": {
        "price": 600,
        "unit": "unité",
        "label": "Chauffe-eau gaz"
      },
      "pose_chauffe_eau_solaire": {
        "price": 2000,
        "unit": "unité",
        "label": "Chauffe-eau solaire"
      },
      "debouchage_simple": {
        "price": 225,
        "unit": "intervention",
        "label": "Débouchage simple"
      },
      "debouchage_haute_pression": {
        "price": 350,
        "unit": "intervention",
        "label": "Débouchage haute pression"
      },
      "debouchage_wc": {
        "price": 180,
        "unit": "intervention",
        "label": "Débouchage WC"
      },
      "debouchage_douche": {
        "price": 200,
        "unit": "intervention",
        "label": "Débouchage douche/baignoire"
      },
      "detection_fuite": {
        "price": 300,
        "unit": "intervention",
        "label": "Détection fuite"
      },
      "detection_fuite_camera": {
        "price": 450,
        "unit": "intervention",
        "label": "Détection fuite caméra"
      },
      "reparation_fuite": {
        "price": 250,
        "unit": "intervention",
        "label": "Réparation fuite"
      },
      "recherche_fuite_enterree": {
        "price": 400,
        "unit": "intervention",
        "label": "Recherche fuite enterrée"
      },
      "colmatage_fuite_urgence": {
        "price": 180,
        "unit": "intervention",
        "label": "Colmatage fuite urgence"
      },
      "detartrage_circuit_eau_chaude": {
        "price": 200,
        "unit": "intervention",
        "label": "Détartrage circuit eau chaude"
      },
      "rincage_circuit_chauffage": {
        "price": 180,
        "unit": "intervention",
        "label": "Rinçage circuit chauffage"
      },
      "controle_pression_circuit": {
        "price": 80,
        "unit": "intervention",
        "label": "Contrôle pression circuit"
      },
      "test_etancheite_reseau": {
        "price": 120,
        "unit": "intervention",
        "label": "Test étanchéité réseau"
      },
      "nettoyage_bac_graisse": {
        "price": 150,
        "unit": "intervention",
        "label": "Nettoyage bac à graisse"
      },
      "curage_evacuation": {
        "price": 200,
        "unit": "intervention",
        "label": "Curage évacuation"
      },
      "inspection_camera_canalisation": {
        "price": 250,
        "unit": "intervention",
        "label": "Inspection caméra canalisation"
      },
      "hydrocurage_canalisation": {
        "price": 300,
        "unit": "intervention",
        "label": "Hydrocurage canalisation"
      },
      "traitement_anti_calcaire": {
        "price": 160,
        "unit": "intervention",
        "label": "Traitement anti-calcaire"
      },
      "vidange_chauffe_eau": {
        "price": 150,
        "unit": "intervention",
        "label": "Vidange chauffe-eau"
      },
      "detartrage_chauffe_eau": {
        "price": 180,
        "unit": "intervention",
        "label": "Détartrage chauffe-eau"
      },
      "controle_groupe_securite": {
        "price": 70,
        "unit": "intervention",
        "label": "Contrôle groupe sécurité"
      },
      "controle_anode_magnesium": {
        "price": 90,
        "unit": "intervention",
        "label": "Contrôle anode magnésium"
      },
      "entretien_adoucisseur": {
        "price": 120,
        "unit": "intervention",
        "label": "Entretien adoucisseur eau"
      },
      "regeneration_adoucisseur": {
        "price": 80,
        "unit": "intervention",
        "label": "Régénération adoucisseur"
      },
      "changement_cartouche_osmoseur": {
        "price": 60,
        "unit": "intervention",
        "label": "Changement cartouche osmoseur"
      }
    }
  },
  "peinture": {
    "title": "🎨 Peinture/Décoration",
    "services": {
      "peinture_murs_standard": {
        "price": 32,
        "unit": "m²",
        "label": "Peinture murs standard"
      },
      "peinture_murs_lessivable": {
        "price": 38,
        "unit": "m²",
        "label": "Peinture murs lessivable"
      },
      "peinture_murs_anti_tache": {
        "price": 45,
        "unit": "m²",
        "label": "Peinture murs anti-tâche"
      },
      "peinture_plafond_standard": {
        "price": 38,
        "unit": "m²",
        "label": "Peinture plafond standard"
      },
      "peinture_plafond_mat": {
        "price": 35,
        "unit": "m²",
        "label": "Peinture plafond mat"
      },
      "peinture_plafond_anti_condensation": {
        "price": 48,
        "unit": "m²",
        "label": "Peinture plafond anti-condensation"
      },
      "peinture_boiseries_lasure": {
        "price": 45,
        "unit": "ml",
        "label": "Peinture/lasure boiseries"
      },
      "peinture_portes_interieures": {
        "price": 80,
        "unit": "unité",
        "label": "Peinture portes intérieures"
      },
      "peinture_radiateur": {
        "price": 80,
        "unit": "unité",
        "label": "Peinture radiateur"
      },
      "peinture_facade_exterieure": {
        "price": 55,
        "unit": "m²",
        "label": "Peinture façade extérieure"
      },
      "peinture_volets_bois": {
        "price": 120,
        "unit": "unité",
        "label": "Peinture volets bois"
      },
      "pose_papier_peint_standard": {
        "price": 28,
        "unit": "m²",
        "label": "Pose papier peint standard"
      },
      "pose_papier_peint_intisse": {
        "price": 35,
        "unit": "m²",
        "label": "Pose papier peint intissé"
      },
      "pose_papier_peint_vinyle": {
        "price": 40,
        "unit": "m²",
        "label": "Pose papier peint vinyle"
      },
      "depose_papier_peint": {
        "price": 12,
        "unit": "m²",
        "label": "Dépose papier peint"
      },
      "decollage_papier_peint": {
        "price": 15,
        "unit": "m²",
        "label": "Décollage papier peint ancien"
      },
      "enduit_lissage": {
        "price": 18,
        "unit": "m²",
        "label": "Enduit lissage"
      },
      "enduit_decoratif": {
        "price": 35,
        "unit": "m²",
        "label": "Enduit décoratif"
      },
      "enduit_chaux": {
        "price": 45,
        "unit": "m²",
        "label": "Enduit à la chaux"
      },
      "enduit_tadelakt": {
        "price": 85,
        "unit": "m²",
        "label": "Enduit tadelakt"
      },
      "pose_toile_verre": {
        "price": 22,
        "unit": "m²",
        "label": "Pose toile de verre"
      },
      "pose_fibre_verre": {
        "price": 25,
        "unit": "m²",
        "label": "Pose fibre de verre"
      },
      "pose_plaquettes_parement": {
        "price": 55,
        "unit": "m²",
        "label": "Pose plaquettes parement"
      },
      "pose_lambris_pvc": {
        "price": 35,
        "unit": "m²",
        "label": "Pose lambris PVC"
      },
      "pose_lambris_bois": {
        "price": 45,
        "unit": "m²",
        "label": "Pose lambris bois"
      },
      "pose_frise_decorative": {
        "price": 15,
        "unit": "ml",
        "label": "Pose frise décorative"
      },
      "pose_beton_cire_murs": {
        "price": 115,
        "unit": "m²",
        "label": "Pose béton ciré murs"
      },
      "pose_beton_cire_sol": {
        "price": 95,
        "unit": "m²",
        "label": "Pose béton ciré sol"
      },
      "pose_moulure_plafond": {
        "price": 20,
        "unit": "ml",
        "label": "Pose moulure plafond"
      },
      "pose_corniche_polyurethane": {
        "price": 18,
        "unit": "ml",
        "label": "Pose corniche polyuréthane"
      },
      "pose_rosace": {
        "price": 50,
        "unit": "unité",
        "label": "Pose rosace plafond"
      },
      "patine_meuble": {
        "price": 150,
        "unit": "unité",
        "label": "Patine meuble"
      },
      "lasure_protection_bois": {
        "price": 40,
        "unit": "m²",
        "label": "Lasure protection bois"
      },
      "vitrificateur_parquet": {
        "price": 25,
        "unit": "m²",
        "label": "Vitrificateur parquet"
      },
      "preparation_support": {
        "price": 15,
        "unit": "m²",
        "label": "Préparation support"
      },
      "lessivage_murs": {
        "price": 8,
        "unit": "m²",
        "label": "Lessivage murs"
      },
      "rebouchage_fissures": {
        "price": 12,
        "unit": "ml",
        "label": "Rebouchage fissures"
      }
    }
  },
  "isolation": {
    "title": "🏠 Isolation/Cloisons",
    "services": {
      "isolation_combles_perdus_laine": {
        "price": 30,
        "unit": "m²",
        "label": "Isolation combles perdus laine"
      },
      "isolation_combles_perdus_ouate": {
        "price": 35,
        "unit": "m²",
        "label": "Isolation combles perdus ouate"
      },
      "isolation_combles_amenageables": {
        "price": 45,
        "unit": "m²",
        "label": "Isolation combles aménageables"
      },
      "isolation_murs_interieurs_laine": {
        "price": 55,
        "unit": "m²",
        "label": "Isolation murs intérieurs laine"
      },
      "isolation_murs_interieurs_polystyrene": {
        "price": 45,
        "unit": "m²",
        "label": "Isolation murs intérieurs polystyrène"
      },
      "isolation_murs_exterieurs_ite": {
        "price": 120,
        "unit": "m²",
        "label": "Isolation murs extérieurs ITE"
      },
      "isolation_sol_polyurethane": {
        "price": 35,
        "unit": "m²",
        "label": "Isolation sol polyuréthane"
      },
      "isolation_sol_polystyrene": {
        "price": 30,
        "unit": "m²",
        "label": "Isolation sol polystyrène"
      },
      "isolation_phonique_cloison": {
        "price": 50,
        "unit": "m²",
        "label": "Isolation phonique cloison"
      },
      "isolation_phonique_plafond": {
        "price": 55,
        "unit": "m²",
        "label": "Isolation phonique plafond"
      },
      "pose_cloison_placo_ba13": {
        "price": 40,
        "unit": "m²",
        "label": "Cloison placo BA13 standard"
      },
      "pose_cloison_ba13_phonique": {
        "price": 55,
        "unit": "m²",
        "label": "Cloison BA13 phonique"
      },
      "pose_cloison_hydrofuge": {
        "price": 45,
        "unit": "m²",
        "label": "Cloison hydrofuge"
      },
      "pose_cloison_coupe_feu": {
        "price": 65,
        "unit": "m²",
        "label": "Cloison coupe-feu"
      },
      "pose_cloison_demontable": {
        "price": 75,
        "unit": "m²",
        "label": "Cloison démontable bureau"
      },
      "pose_faux_plafond_ba13": {
        "price": 55,
        "unit": "m²",
        "label": "Faux plafond BA13"
      },
      "pose_faux_plafond_suspendu": {
        "price": 65,
        "unit": "m²",
        "label": "Faux plafond suspendu"
      },
      "pose_faux_plafond_dalles": {
        "price": 45,
        "unit": "m²",
        "label": "Faux plafond dalles"
      },
      "creation_ouverture_cloison": {
        "price": 200,
        "unit": "unité",
        "label": "Création ouverture cloison"
      },
      "rebouchage_ouverture": {
        "price": 150,
        "unit": "unité",
        "label": "Rebouchage ouverture"
      },
      "pose_porte_cloison": {
        "price": 150,
        "unit": "unité",
        "label": "Pose porte cloison"
      },
      "pose_trappe_acces": {
        "price": 120,
        "unit": "unité",
        "label": "Pose trappe d'accès"
      },
      "doublage_mur_polystyrene": {
        "price": 35,
        "unit": "m²",
        "label": "Doublage mur polystyrène"
      },
      "doublage_mur_laine": {
        "price": 40,
        "unit": "m²",
        "label": "Doublage mur laine minérale"
      },
      "membrane_etanche": {
        "price": 25,
        "unit": "m²",
        "label": "Pose membrane étanche"
      },
      "pare_vapeur": {
        "price": 8,
        "unit": "m²",
        "label": "Pose pare-vapeur"
      }
    }
  },
  "exterieur": {
    "title": "🌳 Aménagement Extérieur",
    "services": {
      "pose_terrasse_bois_exotique": {
        "price": 120,
        "unit": "m²",
        "label": "Terrasse bois exotique"
      },
      "pose_terrasse_bois_autoclave": {
        "price": 90,
        "unit": "m²",
        "label": "Terrasse bois autoclavé"
      },
      "pose_terrasse_composite_standard": {
        "price": 115,
        "unit": "m²",
        "label": "Terrasse composite standard"
      },
      "pose_terrasse_composite_haut_gamme": {
        "price": 145,
        "unit": "m²",
        "label": "Terrasse composite haut de gamme"
      },
      "pose_structure_terrasse": {
        "price": 35,
        "unit": "m²",
        "label": "Structure terrasse lambourdes"
      },
      "pose_carrelage_exterieur_standard": {
        "price": 72,
        "unit": "m²",
        "label": "Carrelage extérieur standard"
      },
      "pose_carrelage_exterieur_2cm": {
        "price": 85,
        "unit": "m²",
        "label": "Carrelage extérieur 2cm"
      },
      "pose_dalle_pierre_naturelle": {
        "price": 95,
        "unit": "m²",
        "label": "Dalle pierre naturelle"
      },
      "pose_dalle_beton": {
        "price": 45,
        "unit": "m²",
        "label": "Dalle béton"
      },
      "pose_dalle_plot": {
        "price": 65,
        "unit": "m²",
        "label": "Dalle sur plot"
      },
      "pose_pave_beton": {
        "price": 65,
        "unit": "m²",
        "label": "Pavé béton"
      },
      "pose_pave_pierre": {
        "price": 95,
        "unit": "m²",
        "label": "Pavé pierre"
      },
      "pose_pave_autobloquant": {
        "price": 55,
        "unit": "m²",
        "label": "Pavé autobloquant"
      },
      "pose_beton_desactive": {
        "price": 85,
        "unit": "m²",
        "label": "Béton désactivé"
      },
      "pose_beton_imprime": {
        "price": 95,
        "unit": "m²",
        "label": "Béton imprimé"
      },
      "pose_enrobe": {
        "price": 45,
        "unit": "m²",
        "label": "Enrobé"
      },
      "pose_gravier_decoratif": {
        "price": 25,
        "unit": "m²",
        "label": "Gravier décoratif"
      },
      "pose_gravier_stabilise": {
        "price": 35,
        "unit": "m²",
        "label": "Gravier stabilisé"
      },
      "pose_gazon_synthetique": {
        "price": 45,
        "unit": "m²",
        "label": "Gazon synthétique"
      },
      "preparation_terrain": {
        "price": 15,
        "unit": "m²",
        "label": "Préparation terrain"
      },
      "pose_bordure_beton": {
        "price": 25,
        "unit": "ml",
        "label": "Bordure béton"
      },
      "pose_bordure_pierre": {
        "price": 35,
        "unit": "ml",
        "label": "Bordure pierre"
      },
      "pose_bordure_metal": {
        "price": 30,
        "unit": "ml",
        "label": "Bordure métal"
      },
      "pose_cloture_rigide_standard": {
        "price": 85,
        "unit": "ml",
        "label": "Clôture rigide standard"
      },
      "pose_cloture_rigide_haute": {
        "price": 120,
        "unit": "ml",
        "label": "Clôture rigide haute sécurité"
      },
      "pose_cloture_souple": {
        "price": 40,
        "unit": "ml",
        "label": "Clôture souple"
      },
      "pose_grillage_simple": {
        "price": 35,
        "unit": "ml",
        "label": "Grillage simple torsion"
      },
      "pose_grillage_soudé": {
        "price": 45,
        "unit": "ml",
        "label": "Grillage soudé"
      },
      "pose_brise_vue_pvc": {
        "price": 25,
        "unit": "ml",
        "label": "Brise-vue PVC"
      },
      "pose_brise_vue_naturel": {
        "price": 35,
        "unit": "ml",
        "label": "Brise-vue naturel"
      },
      "pose_claustra_bois": {
        "price": 80,
        "unit": "ml",
        "label": "Claustra bois"
      },
      "pose_claustra_composite": {
        "price": 95,
        "unit": "ml",
        "label": "Claustra composite"
      },
      "pose_claustra_alu": {
        "price": 120,
        "unit": "ml",
        "label": "Claustra aluminium"
      },
      "pose_portail_battant_alu": {
        "price": 600,
        "unit": "unité",
        "label": "Portail battant alu"
      },
      "pose_portail_battant_fer": {
        "price": 550,
        "unit": "unité",
        "label": "Portail battant fer forgé"
      },
      "pose_portail_coulissant_alu": {
        "price": 800,
        "unit": "unité",
        "label": "Portail coulissant alu"
      },
      "pose_portail_coulissant_fer": {
        "price": 750,
        "unit": "unité",
        "label": "Portail coulissant fer"
      },
      "motorisation_portail_battant": {
        "price": 600,
        "unit": "unité",
        "label": "Motorisation portail battant"
      },
      "motorisation_portail_coulissant": {
        "price": 800,
        "unit": "unité",
        "label": "Motorisation portail coulissant"
      },
      "pose_portillon_alu": {
        "price": 250,
        "unit": "unité",
        "label": "Portillon alu"
      },
      "pose_portillon_fer": {
        "price": 300,
        "unit": "unité",
        "label": "Portillon fer forgé"
      },
      "pose_pilier_beton": {
        "price": 150,
        "unit": "unité",
        "label": "Pilier béton"
      },
      "pose_pilier_pierre": {
        "price": 250,
        "unit": "unité",
        "label": "Pilier pierre"
      },
      "installation_arrosage_automatique": {
        "price": 45,
        "unit": "m²",
        "label": "Arrosage automatique"
      },
      "pose_recuperateur_eau_300l": {
        "price": 150,
        "unit": "unité",
        "label": "Récupérateur eau 300L"
      },
      "pose_recuperateur_eau_1000l": {
        "price": 300,
        "unit": "unité",
        "label": "Récupérateur eau 1000L"
      },
      "montage_abri_jardin_5m2": {
        "price": 400,
        "unit": "unité",
        "label": "Abri jardin <5m²"
      },
      "montage_abri_jardin_10m2": {
        "price": 550,
        "unit": "unité",
        "label": "Abri jardin 5-10m²"
      },
      "montage_abri_jardin_20m2": {
        "price": 850,
        "unit": "unité",
        "label": "Abri jardin 10-20m²"
      },
      "montage_carport_simple": {
        "price": 600,
        "unit": "unité",
        "label": "Carport simple"
      },
      "montage_carport_double": {
        "price": 1000,
        "unit": "unité",
        "label": "Carport double"
      },
      "montage_serre_jardin": {
        "price": 400,
        "unit": "unité",
        "label": "Serre jardin"
      },
      "installation_robot_tondeuse": {
        "price": 400,
        "unit": "unité",
        "label": "Installation robot tondeuse"
      },
      "pose_eclairage_jardin_spot": {
        "price": 80,
        "unit": "point",
        "label": "Éclairage jardin spot"
      },
      "pose_eclairage_jardin_borne": {
        "price": 120,
        "unit": "point",
        "label": "Éclairage jardin borne"
      },
      "creation_massif_fleurs": {
        "price": 45,
        "unit": "m²",
        "label": "Création massif fleurs"
      },
      "plantation_haie": {
        "price": 25,
        "unit": "ml",
        "label": "Plantation haie"
      },
      "elagage_arbre": {
        "price": 300,
        "unit": "unité",
        "label": "Élagage arbre"
      },
      "abattage_arbre": {
        "price": 500,
        "unit": "unité",
        "label": "Abattage arbre"
      },
      "pose_liner_piscine": {
        "price": 65,
        "unit": "m²",
        "label": "Pose liner piscine"
      },
      "pose_margelle_piscine": {
        "price": 85,
        "unit": "ml",
        "label": "Pose margelle piscine"
      },
      "pose_pompe_piscine": {
        "price": 600,
        "unit": "unité",
        "label": "Pose pompe piscine"
      },
      "pose_filtre_piscine": {
        "price": 400,
        "unit": "unité",
        "label": "Pose filtre piscine"
      },
      "pose_pompe_chaleur_piscine": {
        "price": 800,
        "unit": "unité",
        "label": "Pose pompe chaleur piscine"
      },
      "pose_robot_piscine": {
        "price": 150,
        "unit": "unité",
        "label": "Installation robot piscine"
      },
      "pose_couverture_piscine_barres": {
        "price": 150,
        "unit": "m²",
        "label": "Couverture piscine barres"
      },
      "pose_bache_piscine": {
        "price": 80,
        "unit": "m²",
        "label": "Bâche piscine"
      },
      "pose_volet_roulant_piscine": {
        "price": 250,
        "unit": "m²",
        "label": "Volet roulant piscine"
      },
      "pose_alarme_piscine": {
        "price": 300,
        "unit": "unité",
        "label": "Alarme piscine"
      },
      "hivernage_piscine": {
        "price": 400,
        "unit": "intervention",
        "label": "Hivernage piscine"
      },
      "remise_en_route_piscine": {
        "price": 350,
        "unit": "intervention",
        "label": "Remise en route piscine"
      },
      "nettoyage_piscine": {
        "price": 80,
        "unit": "intervention",
        "label": "Nettoyage piscine"
      }
    }
  },
  "ventilation": {
    "title": "💨 Ventilation",
    "services": {
      "pose_vmc_simple_flux": {
        "price": 600,
        "unit": "unité",
        "label": "VMC simple flux"
      },
      "pose_vmc_double_flux": {
        "price": 1500,
        "unit": "unité",
        "label": "VMC double flux"
      },
      "pose_vmc_hygroreglable_a": {
        "price": 700,
        "unit": "unité",
        "label": "VMC hygro A"
      },
      "pose_vmc_hygroreglable_b": {
        "price": 800,
        "unit": "unité",
        "label": "VMC hygro B"
      },
      "pose_vmc_thermodynamique": {
        "price": 2000,
        "unit": "unité",
        "label": "VMC thermodynamique"
      },
      "pose_extracteur_sdb": {
        "price": 150,
        "unit": "unité",
        "label": "Extracteur salle de bain"
      },
      "pose_extracteur_wc": {
        "price": 120,
        "unit": "unité",
        "label": "Extracteur WC"
      },
      "pose_extracteur_cuisine": {
        "price": 180,
        "unit": "unité",
        "label": "Extracteur cuisine"
      },
      "pose_bouche_vmc_extraction": {
        "price": 50,
        "unit": "unité",
        "label": "Bouche VMC extraction"
      },
      "pose_bouche_vmc_insufflation": {
        "price": 55,
        "unit": "unité",
        "label": "Bouche VMC insufflation"
      },
      "pose_bouche_hygro": {
        "price": 65,
        "unit": "unité",
        "label": "Bouche hygroréglable"
      },
      "pose_gaine_vmc_isolee": {
        "price": 35,
        "unit": "ml",
        "label": "Gaine VMC isolée"
      },
      "pose_gaine_vmc_standard": {
        "price": 30,
        "unit": "ml",
        "label": "Gaine VMC standard"
      },
      "pose_silencieux_vmc": {
        "price": 120,
        "unit": "unité",
        "label": "Silencieux VMC"
      },
      "pose_aerateur_fenetre": {
        "price": 80,
        "unit": "unité",
        "label": "Aérateur fenêtre"
      },
      "pose_grille_ventilation": {
        "price": 40,
        "unit": "unité",
        "label": "Grille ventilation"
      },
      "nettoyage_vmc_complet": {
        "price": 180,
        "unit": "intervention",
        "label": "Nettoyage VMC complet"
      },
      "nettoyage_bouches_vmc": {
        "price": 80,
        "unit": "intervention",
        "label": "Nettoyage bouches VMC"
      },
      "nettoyage_gaines_vmc": {
        "price": 120,
        "unit": "intervention",
        "label": "Nettoyage gaines VMC"
      },
      "controle_debit_vmc": {
        "price": 90,
        "unit": "intervention",
        "label": "Contrôle débit VMC"
      },
      "changement_filtres_vmc": {
        "price": 60,
        "unit": "intervention",
        "label": "Changement filtres VMC"
      },
      "reglage_vmc": {
        "price": 70,
        "unit": "intervention",
        "label": "Réglage VMC"
      },
      "controle_moteur_vmc": {
        "price": 85,
        "unit": "intervention",
        "label": "Contrôle moteur VMC"
      },
      "entretien_annuel_vmc": {
        "price": 150,
        "unit": "intervention",
        "label": "Entretien annuel VMC"
      }
    }
  },
  "depannage": {
    "title": "🚨 Dépannage/Urgence",
    "services": {
      "deplacement_jour": {
        "price": 60,
        "unit": "intervention",
        "label": "Déplacement jour"
      },
      "deplacement_soir_weekend": {
        "price": 90,
        "unit": "intervention",
        "label": "Déplacement soir/weekend"
      },
      "deplacement_nuit_ferie": {
        "price": 120,
        "unit": "intervention",
        "label": "Déplacement nuit/férié"
      },
      "main_oeuvre_plomberie": {
        "price": 75,
        "unit": "heure",
        "label": "Main d'œuvre plomberie"
      },
      "main_oeuvre_electricite": {
        "price": 75,
        "unit": "heure",
        "label": "Main d'œuvre électricité"
      },
      "main_oeuvre_chauffage": {
        "price": 85,
        "unit": "heure",
        "label": "Main d'œuvre chauffage"
      },
      "main_oeuvre_climatisation": {
        "price": 85,
        "unit": "heure",
        "label": "Main d'œuvre climatisation"
      },
      "main_oeuvre_serrurerie": {
        "price": 100,
        "unit": "heure",
        "label": "Main d'œuvre serrurerie"
      },
      "main_oeuvre_vitrerie": {
        "price": 85,
        "unit": "heure",
        "label": "Main d'œuvre vitrerie"
      },
      "main_oeuvre_electromenager": {
        "price": 70,
        "unit": "heure",
        "label": "Main d'œuvre électroménager"
      },
      "main_oeuvre_jardin": {
        "price": 60,
        "unit": "heure",
        "label": "Main d'œuvre jardin"
      },
      "diagnostic_panne": {
        "price": 80,
        "unit": "intervention",
        "label": "Diagnostic panne"
      },
      "devis_reparation": {
        "price": 0,
        "unit": "gratuit",
        "label": "Devis réparation gratuit"
      },
      "urgence_24h": {
        "price": 150,
        "unit": "majoration",
        "label": "Majoration urgence 24h"
      },
      "intervention_dimanche": {
        "price": 100,
        "unit": "majoration",
        "label": "Majoration dimanche"
      },
      "intervention_ferie": {
        "price": 120,
        "unit": "majoration",
        "label": "Majoration jour férié"
      }
    }
  }
};
  window.CATALOGUE = window.SERVICES;
  // Hook: if functions exist in template, refresh dropdowns/UI
  function __refreshCatalogueUI__() {
    try {
      if (typeof updateServiceOptions === 'function') {
        const catSel = document.getElementById('serviceCategory');
        if (catSel && catSel.options.length <= 1) {
          // Populate categories if empty
          catSel.innerHTML = '<option value="">Sélectionnez une catégorie</option>' + 
            Object.keys(window.CATALOGUE).map(k => 
              `<option value="${k}">${window.CATALOGUE[k].title || k}</option>`
            ).join('');
        }
        updateServiceOptions();
      }
    } catch(e) {}
  }
  document.addEventListener('DOMContentLoaded', __refreshCatalogueUI__);
</script>


<script>
  // Définir l'API si non présent
  window.API_BASE = window.API_BASE || "https://api.mj-service-pro.fr";
  const totalTTC = window.currentQuoteTotalTTC || 0;

  async function ensureQuote(total){
    if (window.currentQuoteId) return window.currentQuoteId;
    const r = await fetch(window.API_BASE + "/api/quotes", {
      method: "POST",
      headers: { "Content-Type": "application/json" },
      body: JSON.stringify({ totalTTC: total, depositPercent: 30 })
    });
    const q = await r.json();
    window.currentQuoteId = q.id || "QUOTE";
    window.currentQuoteTotalTTC = total;
    return window.currentQuoteId;
  }

  paypal.Buttons({
    style: { layout: 'vertical', color: 'gold', shape: 'rect', label: 'pay' },
    createOrder: async () => {
      const qid = await ensureQuote(totalTTC);
      const r = await fetch(window.API_BASE + "/api/paypal/create-order", {
        method: "POST",
        headers: { "Content-Type": "application/json" },
        body: JSON.stringify({
          quoteId: qid,
          totalTTC: totalTTC
        })
      });
      const data = await r.json();
      if(!data.id) throw new Error("Create order failed");
      return data.id;
    },
    onApprove: async (data) => {
      const r = await fetch(window.API_BASE + "/api/paypal/capture-order", {
        method: "POST",
        headers: { "Content-Type": "application/json" },
        body: JSON.stringify({ orderId: data.orderID })
      });
      const capture = await r.json();
      alert("Acompte payé ✅ — Merci !");
      // TODO: redirection ou mise à jour d'UI
    },
    onCancel: () => alert("Paiement annulé"),
    onError: (err) => { console.error(err); alert("Erreur PayPal"); }
  }).render("#paypal-buttons");
</script>

<script src="https://www.paypal.com/sdk/js?client-id=AdKynU2D6sTxRkvlUeS5NnUEyd8xuCH1SIrT30icRZKjvoeyl6WimLiGzXgbQQfyDzOEm6fhxxC4CX1z&currency=EUR&intent=capture&locale=fr_FR"></script>

<script>
(function(){
  const acomptePct = 30;
  const killers = [
    (el) => /Stripe/i.test(el.textContent||""),
    (el) => /Informations de carte/i.test(el.textContent||""),
    (el) => el.querySelector && (el.querySelector(".StripeElement") || el.querySelector("[data-stripe]"))
  ];
  Array.from(document.querySelectorAll("section,div")).forEach(el => {
    if (killers.some(k => k(el))) { el.style.display = "none"; }
  });

  function parseEUR(text){
    if(!text) return 0;
    const cleaned = text.replace(/[^0-9,.\s]/g,"").replace(/\s+/g,"").replace(",", ".");
    const num = parseFloat(cleaned);
    return isFinite(num) ? Math.round(num*100)/100 : 0;
  }
  function detectTotalTTC(){
    if (window.currentQuoteTotalTTC && window.currentQuoteTotalTTC>0) return window.currentQuoteTotalTTC;
    const attr = document.querySelector("[data-total-ttc]");
    if (attr) return parseFloat(attr.getAttribute("data-total-ttc"))||0;
    const sel = document.querySelector(".total-ttc, #total-ttc");
    if (sel) return parseEUR(sel.textContent);
    let best = 0;
    document.querySelectorAll("body *").forEach(el => {
      const t = el.textContent||"";
      if (/TTC/i.test(t) && /\d/.test(t)) {
        const m = t.match(/(\d[\d\s]*[,.]\d{2}|\d[\d\s]*)\s*€/g);
        if (m) m.forEach(n => { const val = parseEUR(n); if(val>best) best = val; });
      }
    });
    return best;
  }

  const totalTTC = detectTotalTTC();
  const info = document.getElementById("acompte-info");
  if (info) {
    info.textContent = totalTTC > 0
      ? `Total TTC détecté: ~ ${ (totalTTC).toFixed(2) } € • Acompte (${ acomptePct }%) estimé: ~ ${ (totalTTC*acomptePct/100).toFixed(2) } €`
      : "Total TTC non détecté automatiquement — le montant sera calculé côté serveur.";
  }

  async function ensureQuote(total){
    if (window.currentQuoteId) return window.currentQuoteId;
    try {
      const r = await fetch(window.API_BASE + "/api/quotes", {
        method: "POST",
        headers: { "Content-Type": "application/json" },
        body: JSON.stringify({ totalTTC: total||0, depositPercent: acomptePct })
      });
      const q = await r.json();
      window.currentQuoteId = q.id || "QUOTE";
      window.currentQuoteTotalTTC = total || 0;
      return window.currentQuoteId;
    } catch(e) {
      console.warn("Création de devis échouée (fallback QUOTE):", e);
      window.currentQuoteId = "QUOTE";
      return window.currentQuoteId;
    }
  }

  if (window.paypal && paypal.Buttons) {
    paypal.Buttons({
      style: { layout: 'vertical', color: 'gold', shape: 'rect', label: 'pay' },
      createOrder: async () => {
        const qid = await ensureQuote(totalTTC);
        const r = await fetch(window.API_BASE + "/api/paypal/create-order", {
          method: "POST",
          headers: { "Content-Type": "application/json" },
          body: JSON.stringify({ quoteId: qid, totalTTC: totalTTC || 0 })
        });
        const data = await r.json();
        if(!data.id) throw new Error("Create order failed");
        return data.id;
      },
      onApprove: async (data) => {
        const r = await fetch(window.API_BASE + "/api/paypal/capture-order", {
          method: "POST",
          headers: { "Content-Type": "application/json" },
          body: JSON.stringify({ orderId: data.orderID })
        });
        const capture = await r.json();
        alert("Acompte payé ✅ — Merci !");
      },
      onCancel: () => alert("Paiement annulé"),
      onError: (err) => { console.error(err); alert("Erreur PayPal"); }
    }).render("#paypal-buttons");
  } else {
    console.error("PayPal SDK non chargé");
  }
})();
</script>


<script>
(function(){
  const fmt = new Intl.NumberFormat('fr-FR', {style:'currency',currency:'EUR'});
  const depositPct = 30, depositFloor = 50;

  function el(tag, attrs={}, html=""){ const e=document.createElement(tag); Object.assign(e,attrs); e.innerHTML=html; return e; }
  function €(n){ return fmt.format((+n||0)); }

  async function loadCatalog(){
    const r = await fetch('/data/services-catalog.json',{cache:'no-store'});
    if(!r.ok) throw new Error('catalogue introuvable');
    return r.json();
  }

  function computeTravelFee(km, bands){ km=+km||0; if(!bands) return 0; for(const b of bands){ if(km<=b.maxKm) return b.feeEUR; } return 0; }

  function renderGrid(all){ 
    const grid = document.getElementById('grid');
    grid.replaceChildren();
    const frag = document.createDocumentFragment();
    all.slice(0, 200).forEach(s=>{ // rendu initial 200, filtrage ensuite
      const card = el('div',{className:'svc-card',style:'border:1px solid #e5e7eb;border-radius:10px;padding:10px;background:#fff'});
      card.append(el('div',{style:'font-weight:600;margin-bottom:4px'}, s.name));
      card.append(el('div',{style:'color:#374151'}, `${€(s.basePriceHT)} HT / ${s.unit}`));
      card.append(el('div',{style:'color:#6b7280;font-size:12px;margin:6px 0 8px 0'}, s.categoryLabel));
      const qty = el('input',{type:'number',min:1,value:1,style:'width:80px;padding:6px;border:1px solid #ddd;border-radius:8px'});
      const btn = el('button',{style:'margin-left:8px;padding:6px 8px;border:1px solid #10b981;background:#10b981;color:#fff;border-radius:8px;cursor:pointer'}, 'Ajouter');
      btn.onclick = () => addToCart(s, +qty.value||1);
      const row = el('div',{style:'display:flex;align-items:center;'}, '');
      row.append(qty); row.append(btn);
      card.append(row);
      frag.append(card);
    });
    grid.append(frag);
  }

  const cart = new Map(); // id -> {item, qty}
  function addToCart(item, qty){ 
    const cur = cart.get(item.id)||{item, qty:0}; cur.qty += qty; cart.set(item.id, cur); renderCart();
  }
  function removeFromCart(id){ cart.delete(id); renderCart(); }

  function renderCart(){
    const cartDiv = document.getElementById('cart');
    const totauxDiv = document.getElementById('totaux');
    const distance = +document.getElementById('distanceKm').value||0;
    cartDiv.replaceChildren();
    let totalHT=0, totalTVA=0;
    for(const {item, qty} of cart.values()){ 
      const lineHT = (item.basePriceHT*qty);
      const lineTVA = lineHT*(item.vatRate/100);
      totalHT += lineHT; totalTVA += lineTVA;
      const row = el('div',{style:'display:flex;gap:8px;align-items:center;border-bottom:1px dashed #e5e7eb;padding:6px 0;'});
      row.append(el('div',{style:'flex:1;'}, `${item.name} × ${qty}`));
      row.append(el('div',{style:'width:120px;text-align:right;'}, €(lineHT+lineTVA)));
      const rm = el('button',{style:'padding:4px 8px;border:1px solid #ef4444;background:#ef4444;color:#fff;border-radius:8px;cursor:pointer'}, 'Retirer');
      rm.onclick = ()=> removeFromCart(item.id);
      row.append(rm);
      cartDiv.append(row);
    }
    const travel = computeTravelFee(distance, window.catalogTravelBands);
    const totalTTC = totalHT + totalTVA + travel;
    totauxDiv.innerHTML = `Sous-total HT: ${€(totalHT)} • TVA: ${€(totalTVA)} • Déplacement: ${€(travel)}`;
    document.getElementById('total-ttc').textContent = fmt.format(totalTTC);
    // expose au module PayPal
    window.currentQuoteTotalTTC = +totalTTC.toFixed(2);
    window.currentQuoteId = window.currentQuoteId || null;
    const acompte = Math.max(Math.round(window.currentQuoteTotalTTC * depositPct) / 100, depositFloor);
    document.getElementById('acompte-info').textContent = `Acompte estimé ~ ${fmt.format(Math.max(window.currentQuoteTotalTTC*depositPct/100, depositFloor))}`;
  }

  function bindFiltering(all){
    const search = document.getElementById('search');
    const selCat = document.getElementById('category');
    function apply(){
      const q = (search.value||'').toLowerCase().trim();
      const c = selCat.value||'';
      const filtered = all.filter(s=> (!c||s.category===c) && (!q || (s.name.toLowerCase().includes(q) || s.categoryLabel.toLowerCase().includes(q))));
      renderGrid(filtered);
    }
    search.oninput = apply;
    selCat.onchange = apply;
  }

  function bindCartActions(){
    document.getElementById('distanceKm').oninput = renderCart;
    document.getElementById('vider').onclick = ()=>{ cart.clear(); renderCart(); };
  }

  loadCatalog().then(cfg=>{
    // options
    const categories = cfg.categories||[];
    const sel = document.getElementById('category');
    categories.forEach(c=> sel.append(new Option(c.label, c.id)));
    // travel bands
    window.catalogTravelBands = (cfg.travel && cfg.travel.bandsKm) || [];
    // flatten
    const all = categories.flatMap(c=> (c.services||[]).map(s=> ({...s, categoryLabel: c.label})));
    renderGrid(all);
    bindFiltering(all);
    bindCartActions();
  }).catch(e=> console.error(e));

})();
</script>

<!-- PayPal SDK -->
<script src="https://www.paypal.com/sdk/js?client-id=AdKynU2D6sTxRkvlUeS5NnUEyd8xuCH1SIrT30icRZKjvoeyl6WimLiGzXgbQQfyDzOEm6fhxxC4CX1z&currency=EUR&intent=capture&locale=fr_FR"></script>
<script>
(function(){
  async function ensureQuote(total){
    if (window.currentQuoteId) return window.currentQuoteId;
    try {
      const r = await fetch(window.API_BASE + "/api/quotes", {
        method: "POST",
        headers: { "Content-Type": "application/json" },
        body: JSON.stringify({ totalTTC: total||0, depositPercent: 30 })
      });
      const q = await r.json();
      window.currentQuoteId = q.id || "QUOTE";
      return window.currentQuoteId;
    } catch(e) { console.warn(e); window.currentQuoteId = "QUOTE"; return "QUOTE"; }
  }
  if (window.paypal && paypal.Buttons) {
    paypal.Buttons({
      style: { layout: 'vertical', color: 'gold', shape: 'rect', label: 'pay' },
      createOrder: async () => {
        const total = window.currentQuoteTotalTTC||0;
        const qid = await ensureQuote(total);
        const r = await fetch(window.API_BASE + "/api/paypal/create-order", {
          method: "POST",
          headers: { "Content-Type": "application/json" },
          body: JSON.stringify({ quoteId: qid, totalTTC: total })
        });
        const data = await r.json();
        if(!data.id) throw new Error("Create order failed");
        return data.id;
      },
      onApprove: async (data) => {
        const r = await fetch(window.API_BASE + "/api/paypal/capture-order", {
          method: "POST",
          headers: { "Content-Type": "application/json" },
          body: JSON.stringify({ orderId: data.orderID })
        });
        const capture = await r.json();
        alert("Acompte payé ✅ — Merci !");
      },
      onCancel: () => alert("Paiement annulé"),
      onError: (err) => { console.error(err); alert("Erreur PayPal"); }
    }).render("#paypal-buttons");
  } else {
    console.error("PayPal SDK non chargé");
  }
})();
</script>

<!-- === MJ CRÉATIONS — PayPal (in-card placement) === -->
<div id="paypal-root" style="display:none"></div>
<script>window.API_BASE = window.API_BASE || "https://api.mj-service-pro.fr";</script>
<script id="paypal-sdk" src="https://www.paypal.com/sdk/js?client-id=AdKynU2D6sTxRkvlUeS5NnUEyd8xuCH1SIrT30icRZKjvoeyl6WimLiGzXgbQQfyDzOEm6fhxxC4CX1z&currency=EUR&intent=capture&locale=fr_FR"></script>
<script>
(function(){
  const isLocal = location.protocol==='file:';
  function err(m){ console.warn("[PayPal]", m); }
  function parseEUR(t){ const c=(t||"").replace(/[^0-9,.,\s]/g,"").replace(/\s+/g,"").replace(",","."); const n=parseFloat(c); return isFinite(n)?Math.round(n*100)/100:0; }
  function detectTotal(){
    if (window.currentQuoteTotalTTC) return window.currentQuoteTotalTTC;
    const k = document.querySelector('.total-ttc, #total-ttc'); if(k) return parseEUR(k.textContent);
    let best=0;
    document.querySelectorAll('body *').forEach(el=>{ const t=el.textContent||''; if(/TTC/i.test(t)&&/\d/.test(t)){ const mm=t.match(/(\d[\d\s]*[,.]\d{2}|\d[\d\s]*)\s*€/g); if(mm) mm.forEach(x=>{ const v=parseEUR(x); if(v>best) best=v; }); } });
    return best;
  }
  function findDevisCard(){
    // Choose the *smallest* container that contains "Devis Sélectionné"
    const nodes = Array.from(document.querySelectorAll('section,div,article,aside'));
    let pick=null, bestLen=1e12;
    nodes.forEach(n=>{
      const txt=(n.textContent||'').replace(/\s+/g,' ').trim();
      if(/Devis\s+S[ée]lectionn[ée]/i.test(txt)){ if(txt.length<bestLen){ pick=n; bestLen=txt.length; } }
    });
    return pick;
  }
  function ensureSlot(container){
    let slot = container.querySelector('#paypal-one-inline');
    if(!slot){
      slot = document.createElement('div');
      slot.id = 'paypal-one-inline';
      slot.style.marginTop = '10px';
      slot.style.paddingTop = '8px';
      slot.style.borderTop = '1px dashed #e5e7eb';
      container.appendChild(slot);
    }
    return slot;
  }
  function render(){
    const card = findDevisCard();
    if(!card) return err("Carte 'Devis Sélectionné' introuvable.");
    const slot = ensureSlot(card);
    if (!(window.paypal && paypal.Buttons)) { return err("SDK PayPal non chargé (bloqueur ?)"); }
    const total = detectTotal()||0; window.currentQuoteTotalTTC = total;
    paypal.Buttons({
      style: { layout:'vertical', color:'gold', shape:'rect', label:'pay' },
      createOrder: async () => {
        if (isLocal) throw new Error("Mode fichier local — API indisponible");
        const r = await fetch(window.API_BASE + "/api/paypal/create-order", {
          method:'POST', headers:{'Content-Type':'application/json'},
          body: JSON.stringify({ quoteId: window.currentQuoteId||"QUOTE", totalTTC: total })
        });
        if(!r.ok) throw new Error("API create-order indisponible");
        const d = await r.json(); if(!d.id) throw new Error("Réponse invalide"); return d.id;
      },
      onApprove: async (data) => {
        if (isLocal) throw new Error("Mode fichier local — API indisponible");
        const r = await fetch(window.API_BASE + "/api/paypal/capture-order", {
          method:'POST', headers:{'Content-Type':'application/json'},
          body: JSON.stringify({ orderId: data.orderID })
        });
        if(!r.ok) throw new Error("API capture-order indisponible");
        alert("Acompte payé ✅ — Merci !");
      },
      onError: (e) => err(e && e.message ? e.message : String(e))
    }).render(slot);
  }
  if (document.getElementById('paypal-sdk').complete) render(); else window.addEventListener('load', render);
})();
</script>

<!-- === MJC LOCAL PHOTO MANAGER (offline, no server) === -->
<style>
#localAssetsBtn{
  position:fixed; right:18px; bottom:18px; z-index:9999;
  background:#111827; color:#fff; border:none; border-radius:999px;
  padding:10px 14px; box-shadow:0 8px 30px rgba(0,0,0,.22); cursor:pointer;
}
#localAssetsPanel{
  position:fixed; right:18px; bottom:70px; width:380px; max-height:70vh; overflow:auto;
  background:#ffffff; border:1px solid #e5e7eb; border-radius:16px; padding:14px;
  box-shadow:0 20px 50px rgba(0,0,0,.18); z-index:9999; display:none;
  font-family: system-ui, Segoe UI, Roboto, Helvetica, Arial, sans-serif;
}
#localAssetsPanel h3{ margin:0 0 6px 0; font-size:16px; }
#assetsList{ display:grid; grid-template-columns: 1fr 1fr; gap:8px; }
.assetCard{ border:1px solid #e5e7eb; border-radius:10px; padding:6px; }
.assetCard img{ width:100%; height:88px; object-fit:cover; border-radius:8px; }
.assetCard code{ display:block; font-size:11px; color:#6b7280; margin-top:4px; word-break:break-all; }
.dropzone{
  border:2px dashed #93c5fd; background:#eff6ff; padding:10px; border-radius:12px;
  text-align:center; color:#1f2937; font-size:13px; margin-bottom:8px;
}
.dropzone.drag{ background:#dbeafe; border-color:#60a5fa; }
.small{ color:#6b7280; font-size:12px; }
</style>
<button id="localAssetsBtn" title="Photos locales (CTRL+I)">🖼️</button>
<div id="localAssetsPanel" role="dialog" aria-label="Gestion photos locales">
  <h3>Photos locales (hors-ligne)</h3>
  <div class="small">Glissez vos images ici. Elles seront stockées dans votre navigateur et utilisées automatiquement.</div>
  <div id="dz" class="dropzone">Déposez des images (jpg/png/webp)…</div>
  <div class="small">Nom du fichier = <b>slug</b>. Exemple: <code>salle-de-bain-moderne.jpg</code></div>
  <div id="assetsList"></div>
</div>
<script>
(function(){
  const btn = document.getElementById('localAssetsBtn');
  const panel = document.getElementById('localAssetsPanel');
  const dz = document.getElementById('dz');
  const list = document.getElementById('assetsList');
  const dbName = 'mjc_local_photos_v1';

  function slugify(t){
    return (t||'').toLowerCase()
      .normalize('NFD').replace(/[\\u0300-\\u036f]/g,'')
      .replace(/[^a-z0-9\\s-]/g,'').trim().replace(/\\s+/g,'-').replace(/-+/g,'-').slice(0,120);
  }

  // IndexedDB helpers
  function idbOpen(){
    return new Promise((resolve,reject)=>{
      const r = indexedDB.open(dbName, 1);
      r.onupgradeneeded = ev => {
        const db = ev.target.result;
        if(!db.objectStoreNames.contains('assets')) db.createObjectStore('assets');
      };
      r.onsuccess = ()=>resolve(r.result);
      r.onerror = ()=>reject(r.error);
    });
  }
  async function idbGetAll(){
    const db = await idbOpen();
    return new Promise((resolve,reject)=>{
      const tx = db.transaction('assets','readonly');
      const store = tx.objectStore('assets');
      const req = store.getAll();
      req.onsuccess = ()=> resolve(req.result || []);
      req.onerror = ()=> reject(req.error);
    });
  }
  async function idbSet(key, val){
    const db = await idbOpen();
    return new Promise((resolve,reject)=>{
      const tx = db.transaction('assets','readwrite');
      const store = tx.objectStore('assets');
      const req = store.put(val, key);
      req.onsuccess = ()=> resolve(true);
      req.onerror = ()=> reject(req.error);
    });
  }
  async function idbKeys(){
    const db = await idbOpen();
    return new Promise((resolve,reject)=>{
      const tx = db.transaction('assets','readonly');
      const store = tx.objectStore('assets');
      const req = store.getAllKeys();
      req.onsuccess = ()=> resolve(req.result || []);
      req.onerror = ()=> reject(req.error);
    });
  }
  async function idbGet(key){
    const db = await idbOpen();
    return new Promise((resolve,reject)=>{
      const tx = db.transaction('assets','readonly');
      const store = tx.objectStore('assets');
      const req = store.get(key);
      req.onsuccess = ()=> resolve(req.result || null);
      req.onerror = ()=> reject(req.error);
    });
  }

  // UI
  function toggle(){ panel.style.display = (panel.style.display==='none'||!panel.style.display) ? 'block' : 'none'; }
  btn.addEventListener('click', toggle);
  window.addEventListener('keydown', e=>{ if(e.ctrlKey && e.key.toLowerCase()==='i'){ e.preventDefault(); toggle(); } });

  // Dropzone
  ;['dragenter','dragover'].forEach(ev=>dz.addEventListener(ev, e=>{ e.preventDefault(); dz.classList.add('drag'); }));
  ;['dragleave','drop'].forEach(ev=>dz.addEventListener(ev, e=>{ e.preventDefault(); dz.classList.remove('drag'); }));
  dz.addEventListener('drop', async e=>{
    const files = Array.from(e.dataTransfer.files || []).filter(f=>/image\\/(png|jpe?g|webp)/i.test(f.type));
    for(const f of files){
      const base64 = await fileToDataURL(f);
      const key = slugify(f.name.replace(/\\.(png|jpe?g|webp)$/i,''));
      await idbSet(key, { key, base64, type: f.type, size: f.size, name: f.name });
    }
    await renderList();
    await applyAll();
  });

  async function renderList(){
    const keys = await idbKeys();
    list.innerHTML = '';
    for(const k of keys){
      const rec = await idbGet(k);
      const card = document.createElement('div');
      card.className = 'assetCard';
      card.innerHTML = `<img src="${rec.base64}" alt=""><code>${rec.key}</code>`;
      list.appendChild(card);
    }
  }

  function fileToDataURL(f){
    return new Promise((resolve,reject)=>{
      const r = new FileReader();
      r.onload = ()=> resolve(r.result);
      r.onerror = ()=> reject(r.error);
      r.readAsDataURL(f);
    });
  }

  // Apply assets to images (match by ALT slug or data-key)
  async function applyAll(){
    const keys = await idbKeys();
    const map = {};
    for(const k of keys){ const r = await idbGet(k); map[k]=r.base64; }

    function pick(img){
      const dataKey = img.getAttribute('data-key');
      const alt = img.getAttribute('alt') || '';
      const slug = dataKey ? dataKey : slugify(alt);
      return map[slug] || null;
    }

    document.querySelectorAll('img').forEach(img=>{
      const hit = pick(img);
      if(hit){
        img.src = hit;
        img.setAttribute('loading','lazy');
        img.setAttribute('decoding','async');
        img.style.objectFit = 'cover';
      }
    });
  }

  document.addEventListener('DOMContentLoaded', ()=>{ renderList().then(applyAll); });
  const mo = new MutationObserver(()=>applyAll());
  mo.observe(document.documentElement, { childList:true, subtree:true });
})();
</script>

<!-- MJC PATCH: Vitrine dynamic calendar, prospect save, and deposit (Stripe-ready) -->
<script>
(function(){
  const frMonths = ['janvier','février','mars','avril','mai','juin','juillet','août','septembre','octobre','novembre','décembre'];
  const frWeek = ['Lun','Mar','Mer','Jeu','Ven','Sam','Dim'];

  function startOfMonth(d){ const x = new Date(d.getFullYear(), d.getMonth(), 1); x.setHours(0,0,0,0); return x; }
  function endOfMonth(d){ return new Date(d.getFullYear(), d.getMonth()+1, 0); }
  function ymd(d){ return d.toISOString().slice(0,10); }

  const appointRoot = document.querySelector('.appointment-section .calendar-container');
  const appointMonthEl = appointRoot ? appointRoot.querySelector('.calendar-month') : null;
  const appointGridEl = appointRoot ? appointRoot.querySelector('.calendar-grid') : null;
  const navBtns = appointRoot ? appointRoot.querySelectorAll('.calendar-nav-btn') : [];

  let current = new Date();
  current.setDate(1);

  async function fetchUnavailableDays(first, last){
    const unavailable = new Set();
    try {
      if (!window.MJ_db) return unavailable;
      const firstId = ymd(first);
      const lastId = ymd(last);
      const q = await window.MJ_db.collection('planning')
        .where(firebase.firestore.FieldPath.documentId(), '>=', firstId)
        .where(firebase.firestore.FieldPath.documentId(), '<=', lastId)
        .get();
      q.forEach(doc => {
        const d = doc.id;
        const data = doc.data() || {};
        const rdv = Array.isArray(data.rendezVous) ? data.rendezVous.length : 0;
        if (rdv >= (data.capacite || 8)) unavailable.add(d);
      });
    } catch(e){ console.warn('[MJC] planning fetch failed', e); }
    return unavailable;
  }

  async function renderCalendar(refDate){
    if (!appointMonthEl || !appointGridEl) return;
    const first = startOfMonth(refDate);
    const last = endOfMonth(refDate);
    appointMonthEl.textContent = frMonths[refDate.getMonth()] + ' ' + refDate.getFullYear();

    appointGridEl.innerHTML = '';
    frWeek.forEach(w => {
      const hd = document.createElement('div');
      hd.className = 'calendar-weekday';
      hd.textContent = w;
      appointGridEl.appendChild(hd);
    });

    const startDay = (first.getDay() + 6) % 7;
    for (let i=0; i<startDay; i++){
      const pad = document.createElement('div');
      appointGridEl.appendChild(pad);
    }

    const unavailable = await fetchUnavailableDays(first, last);
    const todayYMD = ymd(new Date());

    for (let day=1; day<=last.getDate(); day++){
      const d = new Date(refDate.getFullYear(), refDate.getMonth(), day);
      const cell = document.createElement('div');
      cell.className = 'calendar-day';
      cell.textContent = String(day);
      const thisYMD = ymd(d);

      if (thisYMD === todayYMD) cell.classList.add('today');
      if (unavailable.has(thisYMD)) cell.classList.add('unavailable');

      cell.addEventListener('click', () => {
        if (cell.classList.contains('unavailable')) return;
        appointRoot.querySelectorAll('.calendar-day.selected').forEach(el => el.classList.remove('selected'));
        cell.classList.add('selected');
        const ts = document.querySelector('.appointment-section .time-slots');
        if (ts) ts.scrollIntoView({behavior:'smooth', block:'start'});
      });

      appointGridEl.appendChild(cell);
    }
  }

  if (appointRoot) {
    renderCalendar(current);
    (navBtns||[]).forEach(btn => {
      btn.addEventListener('click', () => {
        const dir = btn.dataset.dir || (btn.textContent.includes('‹') ? 'prev' : 'next');
        if (dir === 'prev') current = new Date(current.getFullYear(), current.getMonth()-1, 1);
        else current = new Date(current.getFullYear(), current.getMonth()+1, 1);
        renderCalendar(current);
      });
    });
  }

  // -------- Prospect save --------
  function getQuoteContext(){
    const totalEl = document.querySelector('.quote-total');
    const lines = [...document.querySelectorAll('.quote-line')].map(el => el.textContent.trim()).slice(0, 15);
    const categoryEl = document.querySelector('[data-selected-category], #service-category, select[name=service], .service-title');
    const category = categoryEl ? (categoryEl.value || categoryEl.textContent || '').trim() : '';
    return {
      totalLabel: totalEl ? totalEl.textContent.trim() : '',
      totalCents: totalEl ? Math.round((parseFloat(totalEl.textContent.replace(/[^0-9.,]/g,'').replace(',','.'))||0) * 100) : 0,
      lines,
      category
    };
  }

  function ensureProspectMiniForm(container){
    if (document.getElementById('mjc-prospect-form')) return;
    const form = document.createElement('div');
    form.id = 'mjc-prospect-form';
    form.style.cssText = 'background:#f3f4f6;border:2px solid #e5e7eb;border-radius:12px;padding:16px;max-width:860px;margin:14px auto;';
    form.innerHTML = `
      <div style="display:grid;grid-template-columns:repeat(auto-fit,minmax(220px,1fr));gap:12px;">
        <label>Nom<input id="mjc_nom" class="form-input" placeholder="Nom et prénom"/></label>
        <label>Email<input id="mjc_email" class="form-input" placeholder="email@exemple.com"/></label>
        <label>Téléphone<input id="mjc_tel" class="form-input" placeholder="06 00 00 00 00"/></label>
        <label>Adresse chantier<input id="mjc_addr" class="form-input" placeholder="Adresse complète"/></label>
        <label>Code postal<input id="mjc_cp" class="form-input" placeholder="29000"/></label>
        <label>Ville<input id="mjc_ville" class="form-input" placeholder="Quimper"/></label>
      </div>
      <label style="display:block;margin-top:12px;">Description du projet<textarea id="mjc_desc" class="form-textarea" placeholder="Détaillez votre besoin…" rows="3"></textarea></label>
    `;
    container.parentNode.insertBefore(form, container.nextSibling);
  }

  function validateEmail(v){ return /^[^\s@]+@[^\s@]+\.[^\s@]+$/.test(v||''); }
  function validatePhone(v){ return /^(?:(?:\+|00)33|0)\s*[1-9](?:[\s.-]*\d{2}){4}$/.test(v||''); }
  function ensureQuoteButtons(){
    const actions = document.querySelector('.quote-actions');
    if (!actions) return;
    if (actions.querySelector('#mjc_save_devis')) return;
    const saveBtn = document.createElement('button');
    saveBtn.id = 'mjc_save_devis';
    saveBtn.className = 'btn btn-primary';
    saveBtn.textContent = '💾 Enregistrer le devis';
    const rdvBtn = document.createElement('button');
    rdvBtn.id = 'mjc_rdv_btn';
    rdvBtn.className = 'btn btn-success';
    rdvBtn.textContent = '📩 Demander un RDV';

    actions.appendChild(saveBtn);
    actions.appendChild(rdvBtn);

    [saveBtn, rdvBtn].forEach(btn => btn.addEventListener('click', async () => {
      ensureProspectMiniForm(actions);
      const ctx = getQuoteContext();
      const email = document.getElementById('mjc_email')?.value||'';
      const tel = document.getElementById('mjc_tel')?.value||'';
      if (email && !validateEmail(email)) { alert('Email invalide'); return; }
      if (tel && !validatePhone(tel)) { alert('Téléphone invalide'); return; }

      if (!window.MJ_db){ alert('Base de données indisponible (Firebase non configuré).'); return; }
      try {
        const payload = {
          demande: {
            service: ctx.category || 'N/A',
            description: document.getElementById('mjc_desc')?.value||'',
            localisation: {
              adresse: document.getElementById('mjc_addr')?.value||'',
              cp: document.getElementById('mjc_cp')?.value||'',
              ville: document.getElementById('mjc_ville')?.value||''
            },
            contact: {
              nom: document.getElementById('mjc_nom')?.value||'',
              email: email || '',
              tel: tel || ''
            },
            date: new Date().toISOString()
          },
          estimation: {
            lignes: ctx.lines,
            totalCents: ctx.totalCents,
            libelleTotal: ctx.totalLabel
          },
          statut: 'nouveau',
          source: 'vitrine',
          createdAt: firebase.firestore.FieldValue.serverTimestamp()
        };
        await window.MJ_db.collection('prospects').add(payload);
        alert('✅ Devis enregistré, nous vous recontactons rapidement.');
      } catch(e){
        console.error(e);
        alert('Erreur lors de la sauvegarde du devis.');
      }
    }));
  }

  document.addEventListener('DOMContentLoaded', function(){
    ensureQuoteButtons();
  });

  // ------- Stripe deposit (optional) -------
  async function setupStripeDeposit(){
    try {
      if (!window.Stripe || !window.MJ_STRIPE_PUBLISHABLE || !window.MJ_API_BASE) return;
      const stripe = window.Stripe(window.MJ_STRIPE_PUBLISHABLE);
      const actions = document.querySelector('.quote-actions');
      if (!actions) return;

      let card, elements;
      const payBtn = document.createElement('button');
      payBtn.id = 'mjc_pay_deposit';
      payBtn.className = 'btn btn-outline';
      payBtn.textContent = '💳 Payer l’acompte 30%';
      actions.appendChild(payBtn);

      const holder = document.createElement('div');
      holder.id = 'mjc_card_holder';
      holder.style.cssText = 'max-width:420px;margin:8px auto;display:none;background:#f8fafc;border:1px dashed #cbd5e1;border-radius:10px;padding:10px;';
      holder.innerHTML = '<div id="mjc_card" style="padding:8px;"></div><button id="mjc_pay_now" class="btn btn-primary" style="margin-top:8px;width:100%;">Payer maintenant</button>';
      actions.parentNode.insertBefore(holder, actions.nextSibling);

      payBtn.addEventListener('click', async () => {
        holder.style.display = 'block';
        elements = stripe.elements();
        card = elements.create('card');
        card.mount('#mjc_card');
      });

      document.getElementById('mjc_pay_now').addEventListener('click', async () => {
        const ctx = getQuoteContext();
        if (!ctx.totalCents){ alert('Montant invalide'); return; }
        const amount = Math.round(ctx.totalCents * 0.30);
        const res = await fetch((window.MJ_API_BASE || '') + '/create-payment-intent', {
          method: 'POST',
          headers: { 'Content-Type': 'application/json' },
          body: JSON.stringify({ amount, currency: 'eur', meta: { source: 'vitrine', category: ctx.category } })
        }).then(r=>r.json());

        if (!res || !res.clientSecret) { alert('Paiement indisponible.'); return; }
        const {paymentIntent, error} = await stripe.confirmCardPayment(res.clientSecret, {
          payment_method: { card }
        });
        if (error) { alert(error.message || 'Erreur paiement'); return; }
        if (paymentIntent && paymentIntent.status === 'succeeded') {
          alert('✅ Acompte réglé. Merci !');
        }
      });
    } catch(e){ console.warn('Stripe deposit not enabled', e); }
  }
  document.addEventListener('DOMContentLoaded', setupStripeDeposit);
})();
</script>

</body>
</html>